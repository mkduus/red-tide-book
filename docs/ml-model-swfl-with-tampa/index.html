<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Machine Learning Model for Combined Peace River and Caloosahatchee River - Red Tide Data and Modeling Book</title><meta property="og:title" content="Machine Learning Model for Combined Peace River and Caloosahatchee River - Red Tide Data and Modeling Book"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><link rel="stylesheet" href="/red-tide-book//build/_assets/app-AIT5GAEP.css"/><link rel="stylesheet" href="/red-tide-book//build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/red-tide-book//favicon.ico"/><link rel="stylesheet" href="/red-tide-book//myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/red-tide-book//"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="Red Tide Data and Modeling Book" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/red-tide-book//">Red Tide Data and Modeling Book</a><a title="Data Integration for Southwest Florida" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/red-tide-book//data-swfl-combined">Data Integration for Southwest Florida</a><a title="Watershed Study Area" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/red-tide-book//watershed-graphics">Watershed Study Area</a><a title="Machine Learning Model for Combined Peace River and Caloosahatchee River" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/red-tide-book//ml-model-swfl-with-tampa">Machine Learning Model for Combined Peace River and Caloosahatchee River</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"></div><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Machine Learning Model for Combined Peace River and Caloosahatchee River</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Matthew Duus</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="d6Zchw0kJ8" class="myst-jp-nb-block relative group/block"><p>This notebook implements a machine learning framework to predict Karenia brevis bloom occurrence across Southwest Florida using integrated environmental and nutrient datasets from the Peace River and Caloosahatchee River watersheds. The analysis combines in situ water quality measurements, hydrologic discharge variables, and confirmed bloom observations, and extends the spatial domain to include the Tampa Bay region. By incorporating data from multiple coastal systems, this workflow evaluates model performance across a broader geographic range and supports regional-scale assessment of bloom prediction capability.</p></div><div id="MGFwPk3yf5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import matplotlib.pyplot as plt
from datetime import datetime

# Define your graphics output directory
graphics_dir = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics&quot;
os.makedirs(graphics_dir, exist_ok=True)

# Define a custom show function to automatically save every figure
_original_show = plt.show

def autosave_show(*args, **kwargs):
    # Get current figure
    fig = plt.gcf()
    timestamp = datetime.now().strftime(&#x27;%Y-%m-%d_%H-%M-%S&#x27;)
    filename = f&quot;figure_{timestamp}.png&quot;
    filepath = os.path.join(graphics_dir, filename)
    fig.savefig(filepath, dpi=300, bbox_inches=&#x27;tight&#x27;)
    print(f&quot;Figure saved to: {filepath}&quot;)
    _original_show(*args, **kwargs)

# Override the default plt.show
plt.show = autosave_show</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="R2XWF3Em5w0Gq6JpXEjxP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="d4AiCJrI71" class="myst-jp-nb-block relative group/block"><h2 id="id-1-machine-learning-model" class="relative group"><span class="heading-text">1. Machine Learning Model</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-machine-learning-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="YBtw2lbdcd" class="myst-jp-nb-block relative group/block"><h3 id="id-1-1-data-loading-and-preprocessing" class="relative group"><span class="heading-text">1.1 Data Loading and Preprocessing</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-1-data-loading-and-preprocessing" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="KVBUUJOzQY" class="myst-jp-nb-block relative group/block"><p>The merged dataset is loaded and a binary target variable is created to indicate the presence of a Karenia brevis bloom. A bloom event is defined based on whether cell concentrations exceed 100,000 cells/L, with the target shifted one week ahead to support forecasting.</p></div><div id="bgZKxA5hTg" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd
from sklearn.preprocessing import RobustScaler
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report, balanced_accuracy_score
from sklearn.model_selection import train_test_split

# Load SWFL merged dataset (with Tampa KB added)
df = pd.read_csv(&#x27;swfl_merged_features_tampa.csv&#x27;, parse_dates=[&#x27;time&#x27;])
df = df.sort_values(&#x27;time&#x27;).reset_index(drop=True)

# Create binary bloom target (e.g., bloom if kb ≥ 100,000 cells/L)
threshold = 100000
df[&#x27;bloom&#x27;] = (df[&#x27;kb&#x27;] &gt;= threshold).astype(int)

# Create next-week target for 1-week-ahead forecasting
df[&#x27;target_next_week&#x27;] = df[&#x27;bloom&#x27;].shift(-1)
df = df.dropna(subset=[&#x27;target_next_week&#x27;])
df[&#x27;target_next_week&#x27;] = df[&#x27;target_next_week&#x27;].astype(int)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="I2fzgYnJrm3fBYK6Z1YpB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EhI52No5zE" class="myst-jp-nb-block relative group/block"><h3 id="id-1-2-lag-feature-engineering" class="relative group"><span class="heading-text">1.2 Lag Feature Engineering</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-2-lag-feature-engineering" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="RW7sj64SkL" class="myst-jp-nb-block relative group/block"><p>Lagged variables and rolling averages are generated for key predictors such as nutrient concentrations, discharge, and ocean conditions. These temporal features provide context on recent environmental trends that may influence bloom dynamics.</p></div><div id="ezopEIRRNZ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Lag features (1 and 2 weeks back)
df[&#x27;kb_prev1&#x27;] = df[&#x27;kb&#x27;].shift(1)
df[&#x27;kb_prev2&#x27;] = df[&#x27;kb&#x27;].shift(2)

df[&#x27;zos_prev1&#x27;] = df[&#x27;zos&#x27;].shift(1)
df[&#x27;salinity_prev1&#x27;] = df[&#x27;salinity&#x27;].shift(1)
df[&#x27;water_temp_prev1&#x27;] = df[&#x27;water_temp&#x27;].shift(1)
df[&#x27;wind_speed_prev1&#x27;] = df[&#x27;wind_speed&#x27;].shift(1)

df[&#x27;peace_discharge_prev1&#x27;] = df[&#x27;peace_discharge&#x27;].shift(1)
df[&#x27;peace_TN_prev1&#x27;] = df[&#x27;peace_TN&#x27;].shift(1)
df[&#x27;peace_TP_prev1&#x27;] = df[&#x27;peace_TP&#x27;].shift(1)

# Caloosahatchee lag features
df[&#x27;caloosa_discharge_prev1&#x27;] = df[&#x27;caloosa_discharge&#x27;].shift(1)
df[&#x27;caloosa_TN_prev1&#x27;] = df[&#x27;caloosa_total_nitrogen&#x27;].shift(1)
df[&#x27;caloosa_TP_prev1&#x27;] = df[&#x27;caloosa_total_phosphorus&#x27;].shift(1)

# Rolling average (4-week) of Peace discharge
df[&#x27;discharge_4w_avg&#x27;] = df[&#x27;peace_discharge&#x27;].rolling(window=4).mean()

# Drop rows with NaNs created by shifting
df.dropna(inplace=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="wJk81hpf-8VanRBVp_q-Q" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hI6OmQfOUU" class="myst-jp-nb-block relative group/block"><h3 id="id-1-3-feature-selection" class="relative group"><span class="heading-text">1.3 Feature Selection</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-3-feature-selection" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="HvfK1Jm4Yu" class="myst-jp-nb-block relative group/block"><p>Relevant features, including both current and lagged environmental variables, are selected for use in the machine learning model. These features represent potential drivers of bloom events across both the Peace River and Caloosahatchee River systems.</p></div><div id="hxmP3YiE0p" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">feature_cols = [
    &#x27;kb&#x27;, &#x27;kb_prev1&#x27;, &#x27;kb_prev2&#x27;,
    &#x27;zos&#x27;, &#x27;salinity&#x27;, &#x27;water_temp&#x27;,
    &#x27;wind_speed&#x27;, &#x27;wind_direction&#x27;,
    &#x27;peace_discharge&#x27;, &#x27;peace_TN&#x27;, &#x27;peace_TP&#x27;,
    &#x27;peace_discharge_prev1&#x27;, &#x27;peace_TN_prev1&#x27;, &#x27;peace_TP_prev1&#x27;,
    &#x27;caloosa_discharge&#x27;, &#x27;caloosa_total_nitrogen&#x27;, &#x27;caloosa_total_phosphorus&#x27;,
    &#x27;caloosa_discharge_prev1&#x27;, &#x27;caloosa_TN_prev1&#x27;, &#x27;caloosa_TP_prev1&#x27;,
    &#x27;discharge_4w_avg&#x27;
]
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Q-O_AehoHGsJ8DB7T4uBe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="c7mLNiU5VA" class="myst-jp-nb-block relative group/block"><h3 id="id-1-4-train-test-split-and-scaling" class="relative group"><span class="heading-text">1.4 Train-Test Split and Scaling</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-4-train-test-split-and-scaling" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="ThYIRF0lqD" class="myst-jp-nb-block relative group/block"><p>The dataset is split chronologically into training and testing sets to preserve temporal structure. A RobustScaler is applied to normalize the feature distributions and reduce sensitivity to outliers commonly present in hydrological and ecological data.</p></div><div id="VyTeFqKW8y" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Split into train/test by date
train_df = df[df[&#x27;time&#x27;] &lt; &#x27;2019-01-01&#x27;]
test_df  = df[df[&#x27;time&#x27;] &gt;= &#x27;2019-01-01&#x27;]

X_train = train_df[feature_cols]
y_train = train_df[&#x27;target_next_week&#x27;]
X_test  = test_df[feature_cols]
y_test  = test_df[&#x27;target_next_week&#x27;]

# Scale Features
scaler = RobustScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled  = scaler.transform(X_test)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="xgqEaGmw904a5gTtlJE8G" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="m5LUyWo01h" class="myst-jp-nb-block relative group/block"><h3 id="id-1-5-model-training" class="relative group"><span class="heading-text">1.5 Model Training</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-5-model-training" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="eaaEqK5HYo" class="myst-jp-nb-block relative group/block"><p>A Random Forest classifier is trained on the scaled training set and evaluated on the test set. Model performance is assessed using classification metrics to determine predictive accuracy for one-week-ahead bloom conditions.</p></div><div id="opmWpfwTpo" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Train Random Forest
rf_clf = RandomForestClassifier(n_estimators=100, class_weight=&#x27;balanced&#x27;, random_state=42)
rf_clf.fit(X_train_scaled, y_train)

# Predict and evaluate
y_pred = rf_clf.predict(X_test_scaled)

from sklearn.metrics import classification_report, balanced_accuracy_score
print(classification_report(y_test, y_pred))
print(&quot;Balanced Accuracy:&quot;, balanced_accuracy_score(y_test, y_pred))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="66b7a2aWldpx-Mi7Srie_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>              precision    recall  f1-score   support

           0       0.90      0.96      0.93       172
           1       0.91      0.79      0.85        87

    accuracy                           0.90       259
   macro avg       0.90      0.88      0.89       259
weighted avg       0.90      0.90      0.90       259

Balanced Accuracy: 0.8762028869286287
</span></code></pre></div></div></div></div><div id="ko0zxuPXR7" class="myst-jp-nb-block relative group/block"><h3 id="id-1-6-results-summary" class="relative group"><span class="heading-text">1.6 Results Summary</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-6-results-summary" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="gHLQQCGbT4" class="myst-jp-nb-block relative group/block"><p>Incorporating <em>Karenia brevis</em> cell counts from the Tampa Bay region resulted in a modest improvement in model performance. The <strong>balanced accuracy</strong> increased from <strong>0.855</strong> (original dataset) to <strong>0.876</strong> with Tampa data. Notably, the <strong>recall for bloom events (class 1)</strong> improved from <strong>0.75 to 0.79</strong>, indicating the model’s enhanced ability to correctly identify bloom conditions. Precision and overall accuracy remained stable at <strong>0.90</strong>, suggesting that including Tampa KB data improved bloom detection sensitivity without compromising classification reliability.</p></div><div id="lqXjzDNK3w" class="myst-jp-nb-block relative group/block"><h2 id="id-2-ml-evaluation" class="relative group"><span class="heading-text">2. ML Evaluation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-ml-evaluation" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="C6AGG3qtHe" class="myst-jp-nb-block relative group/block"><h3 id="id-2-1-confusion-matrix" class="relative group"><span class="heading-text">2.1 Confusion Matrix</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-1-confusion-matrix" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="j3YRaAyQSo" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.metrics import classification_report
import pandas as pd

# Get classification report as dictionary
report_dict = classification_report(
    y_test, y_pred, target_names=[&quot;No Bloom&quot;, &quot;Bloom&quot;], output_dict=True
)

# Convert to DataFrame
report_df = pd.DataFrame(report_dict).transpose()

# Optional: round for display
report_df = report_df.round(2)

# Display the table
report_df</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="bRd-jqOi4CmVyxVOXyyj3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="ryXh8hHx3c" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay

# Generate confusion matrix
cm = confusion_matrix(y_test, y_pred)

# Plot with updated title
disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=[&quot;No Bloom&quot;, &quot;Bloom&quot;])
disp.plot(cmap=&quot;Blues&quot;, values_format=&quot;d&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="cpvtQetEYYwJqoR6pUw20" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-02-52.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/b59638fbe4bb5e06b1120f58fa368d55.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div></div><div id="HLeQIBTQzI" class="myst-jp-nb-block relative group/block"><h3 id="confusion-matrix-random-forest-performance-on-karenia-brevis-bloom-forecasting" class="relative group"><span class="heading-text">Confusion Matrix: Random Forest Performance on <em>Karenia brevis</em> Bloom Forecasting</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#confusion-matrix-random-forest-performance-on-karenia-brevis-bloom-forecasting" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The confusion matrix visually represents the performance of your machine learning classification model—in this case, the Random Forest classifier used to predict <em>Karenia brevis</em> bloom severity. A confusion matrix summarizes the number of correct and incorrect predictions, broken down by each class (“No Bloom” and “Bloom”).</p><p>The confusion matrix has four key components:</p><table class=""><tbody><tr class=""><th class=""></th><th class="">Predicted No Bloom</th><th class="">Predicted Bloom</th></tr><tr class=""><td class="">Actual No Bloom</td><td class="">True Negative (TN) – 165</td><td class="">False Positive (FP) – 7</td></tr><tr class=""><td class="">Actual Bloom</td><td class="">False Negative (FN) – 18</td><td class="">True Positive (TP) – 69</td></tr></tbody></table><ol start="1"><li><p><strong>True Negative (TN) = 165</strong></p><ul><li><p>The model correctly predicted “No Bloom” when there was actually no bloom.</p></li></ul></li><li><p><strong>False Positive (FP) = 7</strong></p><ul><li><p>The model predicted “Bloom” when there was actually no bloom (a false alarm).</p></li></ul></li><li><p><strong>False Negative (FN) = 18</strong></p><ul><li><p>The model predicted “No Bloom” when there was actually a bloom (a missed bloom event).</p></li></ul></li><li><p><strong>True Positive (TP) = 69</strong></p><ul><li><p>The model correctly predicted “Bloom” when there was actually a bloom.</p></li></ul></li></ol><h6 id="key-metrics-derived-from-the-confusion-matrix" class="relative group"><span class="heading-text">Key Metrics Derived from the Confusion Matrix:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#key-metrics-derived-from-the-confusion-matrix" title="Link to this Section" aria-label="Link to this Section">¶</a></h6><ol start="1"><li><p><strong>Accuracy</strong> – Measures the overall percentage of correct predictions:</p><div id="EwTxKUiy0L" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Accuracy</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>T</mi><mi>N</mi><mo>+</mo><mi>F</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>69</mn><mo>+</mo><mn>165</mn></mrow><mrow><mn>69</mn><mo>+</mo><mn>165</mn><mo>+</mo><mn>7</mn><mo>+</mo><mn>18</mn></mrow></mfrac><mo>=</mo><mfrac><mn>234</mn><mn>259</mn></mfrac><mo>≈</mo><mn>0.90</mn><mspace width="1em"/><mo stretchy="false">(</mo><mn>90</mn><mi mathvariant="normal">%</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Accuracy} = \frac{TP + TN}{TP + TN + FP + FN} = \frac{69 + 165}{69 + 165 + 7 + 18} = \frac{234}{259} \approx 0.90 \quad (90\%)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Accuracy</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">TN</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">FP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">FN</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">TN</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">69</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">165</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">18</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">69</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">165</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">259</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">234</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.90</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">90%</span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#EwTxKUiy0L" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->1<!-- -->)</a></div></div></li><li><p><strong>Precision</strong> – Measures how many of the predicted positive cases (blooms) were actually correct:</p><div id="R2fo5mUjqE" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Precision</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac><mo>=</mo><mfrac><mn>69</mn><mrow><mn>69</mn><mo>+</mo><mn>7</mn></mrow></mfrac><mo>≈</mo><mn>0.91</mn><mspace width="1em"/><mo stretchy="false">(</mo><mn>91</mn><mi mathvariant="normal">%</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Precision} = \frac{TP}{TP + FP} = \frac{69}{69 + 7} \approx 0.91 \quad (91\%)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">FP</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">69</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">7</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">69</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.91</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">91%</span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#R2fo5mUjqE" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->2<!-- -->)</a></div></div></li></ol><ul><li><p>High precision means fewer false positives (the model doesn’t incorrectly predict blooms very often).</p></li></ul><ol start="3"><li><p><strong>Recall (Sensitivity or True Positive Rate)</strong> – Measures how many of the actual positive cases (blooms) were correctly identified:
</p><div id="bLqstK75VU" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Recall</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo>=</mo><mfrac><mn>69</mn><mrow><mn>69</mn><mo>+</mo><mn>18</mn></mrow></mfrac><mo>≈</mo><mn>0.79</mn><mspace width="1em"/><mo stretchy="false">(</mo><mn>79</mn><mi mathvariant="normal">%</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Recall} = \frac{TP}{TP + FN} = \frac{69}{69 + 18} \approx 0.79 \quad (79\%)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Recall</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">FN</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">69</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">18</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">69</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.79</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">79%</span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#bLqstK75VU" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->3<!-- -->)</a></div></div></li></ol><ul><li><p>High recall means the model catches most of the bloom events.</p></li></ul><ol start="4"><li><p><strong>F1-Score</strong> – The harmonic mean of precision and recall; it balances the trade-off between precision and recall:
</p><div id="xgomYFduEv" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>F1</mtext><mo>=</mo><mn>2</mn><mo>⋅</mo><mfrac><mrow><mtext>Precision</mtext><mo>⋅</mo><mtext>Recall</mtext></mrow><mrow><mtext>Precision</mtext><mo>+</mo><mtext>Recall</mtext></mrow></mfrac><mo>=</mo><mn>2</mn><mo>⋅</mo><mfrac><mrow><mn>0.91</mn><mo>⋅</mo><mn>0.79</mn></mrow><mrow><mn>0.91</mn><mo>+</mo><mn>0.79</mn></mrow></mfrac><mo>≈</mo><mn>0.85</mn><mspace width="1em"/><mo stretchy="false">(</mo><mn>85</mn><mi mathvariant="normal">%</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{F1} = 2 \cdot \frac{\text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}} = 2 \cdot \frac{0.91 \cdot 0.79}{0.91 + 0.79} \approx 0.85 \quad (85\%)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">F1</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.1408em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3714em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">Recall</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord text"><span class="mord">Recall</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.91</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.79</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.91</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">0.79</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.85</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord">85%</span><span class="mclose">)</span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#xgomYFduEv" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->4<!-- -->)</a></div></div></li></ol><ul><li><p>A high F1-score means the model achieves a good balance between precision and recall.</p></li></ul><ol start="5"><li><p><strong>Support</strong> – The number of actual samples in each class:</p><ul><li><p>No Bloom: 172 total instances</p></li><li><p>Bloom: 87 total instances</p></li></ul></li></ol><h6 id="summary-of-model-performance" class="relative group"><span class="heading-text">Summary of Model Performance:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#summary-of-model-performance" title="Link to this Section" aria-label="Link to this Section">¶</a></h6><ul><li><p>The model correctly predicted 90% of the test samples (accuracy).</p></li><li><p>It had a high precision of 91%, meaning it rarely issued false bloom alerts.</p></li><li><p>The recall of 79% indicates that the model detected most bloom events and reduced false negatives compared to the baseline model.</p></li><li><p>The F1-score of 85% reflects that the model maintains a strong balance between precision and recall.</p></li></ul><h6 id="conclusion" class="relative group"><span class="heading-text">Conclusion:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#conclusion" title="Link to this Section" aria-label="Link to this Section">¶</a></h6><ul><li><p>The model demonstrates strong performance in predicting <em>Karenia brevis</em> bloom conditions using the enhanced dataset that includes Tampa KB values.</p></li><li><p>The increase in recall and F1-score over the original SWFL-only model suggests that the additional data improved bloom detection.</p></li><li><p>Continued feature refinement or threshold tuning may help push recall even higher while maintaining precision.</p></li></ul></div><div id="RF7TWjWrU3" class="myst-jp-nb-block relative group/block"><h3 id="id-2-2-precision-recall-curve" class="relative group"><span class="heading-text">2.2 Precision-Recall Curve</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-2-precision-recall-curve" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="vieKLnq6AG" class="myst-jp-nb-block relative group/block"><p>his is a Precision-Recall (PR) Curve, which illustrates the trade-off between precision and recall at different classification thresholds for the Random Forest model trained on the combined Southwest Florida dataset (Peace River + Caloosahatchee River).</p><h5 id="what-the-pr-curve-represents" class="relative group"><span class="heading-text">What the PR Curve Represents:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#what-the-pr-curve-represents" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><ul><li><p><strong>Precision (Y-axis)</strong> = The proportion of predicted positive cases that are truly positive:</p><div id="VxYAtTu9oY" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Precision</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Precision} = \frac{TP}{TP + FP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Precision</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">FP</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#VxYAtTu9oY" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->5<!-- -->)</a></div></div></li><li><p><strong>Recall (X-axis)</strong> = The proportion of actual positive cases that are correctly predicted:</p><div id="mzmk9swmg8" class="flex my-5 group"><div class="flex-grow overflow-x-auto overflow-y-hidden"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Recall</mtext><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{Recall} = \frac{TP}{TP + FN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord text"><span class="mord">Recall</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1297em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">FN</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">TP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div><div class="relative self-center flex-none pl-2 m-0 text-right select-none"><a class="no-underline text-inherit hover:text-inherit text-inherit hover:text-inherit select-none hover:underline" href="#mzmk9swmg8" title="Link to this Equation" aria-label="Link to this Equation">(<!-- -->6<!-- -->)</a></div></div></li></ul><p>The PR curve evaluates the model’s performance across a range of thresholds, showing how precision changes as recall increases. High recall means the model captures more true blooms but may increase false positives, lowering precision. Conversely, high precision means fewer false alarms but may miss some bloom events.</p><p>In this model, the classifier maintains strong precision (~0.91) even as recall increases toward 0.79 — demonstrating the model’s ability to detect true bloom events while minimizing false alarms. A notable drop in precision occurs only at the highest recall levels (&gt;0.90), indicating that aggressively trying to catch every bloom comes at the cost of including more false positives — a common trade-off in environmental risk forecasting.</p><p>This curve aligns with the model’s <strong>F1-score of 85%</strong> and <strong>balanced accuracy of 87.6%</strong>, both of which reflect improved predictive strength compared to the baseline model. The curve suggests that the model balances bloom sensitivity and specificity effectively under the default threshold. Depending on monitoring goals, the classification threshold can be adjusted to prioritize early detection (higher recall) or conservative alerts (higher precision). The <strong>F1-score</strong> or the <strong>area under the precision-recall curve (PR AUC)</strong> can help guide optimal threshold selection for operational use.</p></div><div id="pD1ToY5ZvZ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.metrics import precision_recall_curve
import matplotlib.pyplot as plt
import os

# Optional: save to your custom graphics folder
graphics_dir = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics&quot;
os.makedirs(graphics_dir, exist_ok=True)

# Compute precision and recall
precision, recall, _ = precision_recall_curve(y_test, rf_clf.predict_proba(X_test_scaled)[:, 1])

# Plot PR curve
plt.figure(figsize=(8, 6))
plt.plot(recall, precision, marker=&#x27;.&#x27;, linewidth=1.5)
plt.xlabel(&#x27;Recall&#x27;, fontsize=12)
plt.ylabel(&#x27;Precision&#x27;, fontsize=12)
plt.grid(True)

# Save plot
plt.savefig(os.path.join(graphics_dir, &quot;PR_curve_SWFL_Tampa.png&quot;), dpi=300, bbox_inches=&#x27;tight&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="8nMWzKd909ysqMq8P-ktN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-02-53.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/dd562a68562632a420fcfedbce3aaf71.png" alt="&lt;Figure size 800x600 with 1 Axes&gt;"/></div></div></div><div id="uHxPCCl0Gg" class="myst-jp-nb-block relative group/block"><h3 id="id-2-3-feature-importance-plot" class="relative group"><span class="heading-text">2.3 Feature Importance Plot</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-3-feature-importance-plot" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="uZzZwjYTkj" class="myst-jp-nb-block relative group/block"><p>The plot from the Random Forest Classifier shows the relative contribution of each input feature to predicting <em>Karenia brevis</em> bloom severity. Feature importance reflects how much each feature reduces classification error, based on improvements in the Gini index across all decision trees in the ensemble.</p><p><em>Karenia brevis</em> cell counts (<code>kb</code>) remain the most dominant predictor, with lagged values (<code>kb_prev2</code>, <code>kb_prev1</code>) also ranking near the top. This highlights the strong short-term autocorrelation of bloom conditions — a bloom this week is highly predictive of bloom presence in the near future.</p><p>Discharge dynamics, especially the <strong>4-week rolling average</strong> (<code>discharge_4w_avg</code>) and <strong>lagged Peace River discharge</strong> (<code>peace_discharge_prev1</code>), continue to be important secondary contributors. Nutrient inputs — including <code>peace_TN_prev1</code>, <code>caloosa_TN_prev1</code>, and <code>caloosa_total_phosphorus</code> — also influence bloom status, supporting the hypothesis that nitrogen and phosphorus availability play a key role in bloom maintenance and short-term intensification.</p><p>Oceanographic variables such as <code>zos</code> (sea level anomaly) and <code>water_temp</code> show modest importance, while <code>salinity</code>, <code>wind_speed</code>, and <code>wind_direction</code> contribute less overall. These likely represent more variable or indirect effects on bloom behavior (e.g., transport, mixing).</p><p>These results reinforce that the strongest bloom predictors are recent KB levels, followed by discharge and nutrient signals — while atmospheric and oceanic conditions provide supporting context in bloom forecasting.</p></div><div id="lMxtRK14FI" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
import matplotlib.pyplot as plt
import os

# Get feature importances from the trained RF model
importances = rf_clf.feature_importances_

# Sort feature indices from most to least important
indices = np.argsort(importances)[::-1]

# Optional: Save to your custom graphics directory
graphics_dir = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics&quot;
os.makedirs(graphics_dir, exist_ok=True)

# Plot feature importance
plt.figure(figsize=(12, 6))
plt.bar(range(X_train.shape[1]), importances[indices], align=&quot;center&quot;)
plt.xticks(range(X_train.shape[1]), [feature_cols[i] for i in indices], rotation=90)
plt.tight_layout()

# Save figure
plt.savefig(os.path.join(graphics_dir, &quot;feature_importances_SWFL_Tampa.png&quot;), dpi=300, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Sgxkx7HXF38FKxvW0jMzs" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-02-53.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/7d8361c3dafcad15c07c6644f4d67b45.png" alt="&lt;Figure size 1200x600 with 1 Axes&gt;"/></div></div></div><div id="AhoJKAkM5w" class="myst-jp-nb-block relative group/block"><h3 id="id-2-4-partial-dependence-plots" class="relative group"><span class="heading-text">2.4 Partial Dependence Plots</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-4-partial-dependence-plots" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="txQl4GhvxZ" class="myst-jp-nb-block relative group/block"><p>Partial dependence plots (PDPs) illustrate how predicted <em>Karenia brevis</em> bloom probabilities respond to changes in river discharge and nutrient concentrations from both the Peace and Caloosahatchee Rivers, while holding all other variables constant. The y-axis represents the model’s predicted bloom probability, and the x-axis shows the standardized values of each input feature.</p><p>For both <code>peace_discharge</code> and <code>caloosa_discharge</code>, bloom probability increases sharply from low to moderate discharge values and then flattens out. This suggests that moderate freshwater inflows may promote bloom persistence or nutrient delivery, while higher discharge may not further increase bloom probability — potentially due to dilution or reduced residence time.</p><p>Nutrient variables show more varied but similarly nonlinear behavior. For example, <code>peace_TN</code> and <code>caloosa_total_nitrogen</code> are both associated with increasing bloom probability up to a threshold (~2–3 mg/L), after which the effect plateaus. This indicates a possible nitrogen saturation point, beyond which blooms are no longer limited by nitrogen availability.</p><p>Phosphorus variables — <code>peace_TP</code> and <code>caloosa_total_phosphorus</code> — follow the same pattern: steep initial increases in bloom probability at low phosphorus concentrations, followed by tapering or even a gradual decline beyond ~1.5 mg/L. This may reflect a stoichiometric imbalance or ecological thresholds where additional phosphorus no longer promotes bloom activity.</p><p>The clustering of tick marks along the lower end of the x-axes indicates that most training data points fall within those value ranges, reinforcing that model predictions are more reliable there. These PDPs collectively show that bloom risk is most sensitive to moderate discharge and nutrient conditions, consistent with ecological dynamics of nutrient triggering, hydrologic influence, and possible saturation effects in bloom formation.</p></div><div id="uH3eo9cwFq" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.inspection import PartialDependenceDisplay
import matplotlib.pyplot as plt
import os

# Ensure output directory exists
graphics_dir = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics&quot;
os.makedirs(graphics_dir, exist_ok=True)

## Select features to plot
selected_features = [
    feature_cols.index(&#x27;peace_discharge&#x27;),
    feature_cols.index(&#x27;peace_TN&#x27;),
    feature_cols.index(&#x27;peace_TP&#x27;),
    feature_cols.index(&#x27;caloosa_discharge&#x27;),
    feature_cols.index(&#x27;caloosa_total_nitrogen&#x27;),
    feature_cols.index(&#x27;caloosa_total_phosphorus&#x27;)
]

# Create PDP plots
fig, ax = plt.subplots(nrows=2, ncols=3, figsize=(12, 6))

PartialDependenceDisplay.from_estimator(
    rf_clf,
    X_train_scaled,
    features=selected_features,
    feature_names=feature_cols,
    grid_resolution=50,
    ax=ax
)

# Adjust layout to avoid cutoff &amp; save
plt.tight_layout(pad=2.0)
plt.savefig(os.path.join(graphics_dir, &quot;partial_dependence_SWFL_Tampa.png&quot;), dpi=300, bbox_inches=&#x27;tight&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="qUxxYes02ijYEklG-xVXx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-03-00.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/2ff30bc0bd6ce10193e61c35dcee1b6e.png" alt="&lt;Figure size 1200x600 with 6 Axes&gt;"/></div></div></div><div id="rwElpRMRhP" class="myst-jp-nb-block relative group/block"><h3 id="id-2-5-actual-vs-predicted-bloom" class="relative group"><span class="heading-text">2.5 Actual Vs. Predicted Bloom</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-5-actual-vs-predicted-bloom" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="seGdMU8j1e" class="myst-jp-nb-block relative group/block"><p>This figure shows the actual vs. predicted <em>Karenia brevis</em> bloom status over time for the updated model that incorporates Tampa-area KB data into the Southwest Florida (SWFL) system. The model’s predictions (red dashed line) align closely with observed bloom events (blue line), capturing both the onset and duration of bloom episodes with high temporal fidelity.</p><p>The model slightly underpredicts bloom persistence in a few intervals — where actual bloom duration extends beyond predicted — but overprediction is minimal. In most cases, the model accurately identifies bloom start dates and avoids premature false positives. Compared to the baseline model, this updated version demonstrates improved alignment with observed blooms and fewer lagging or premature activations.</p><p>These results indicate that incorporating KB data from Tampa enhances the model’s ability to learn bloom dynamics across the region. The consistent agreement between actual and predicted time series confirms that the model captures short-term bloom memory and seasonal signals effectively, suggesting it is well-suited for real-time bloom surveillance and early warning applications in multi-basin systems like SWFL.</p></div><div id="vxRzFLUgd8" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import os
import pandas as pd

# Ensure output folder exists
output_dir = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics&quot;
os.makedirs(output_dir, exist_ok=True)

# Create DataFrame to hold test results
test_df = pd.DataFrame({
    &#x27;time&#x27;: X_test.index,  # assumes X_test is indexed by time
    &#x27;Actual&#x27;: y_test,
    &#x27;Predicted&#x27;: y_pred
})

# Sort by time for plotting
test_df = test_df.sort_values(&#x27;time&#x27;)

# Plot actual vs predicted bloom status
plt.figure(figsize=(12, 6))
plt.plot(test_df[&#x27;time&#x27;], test_df[&#x27;Actual&#x27;], label=&#x27;Actual&#x27;, color=&#x27;blue&#x27;)
plt.plot(test_df[&#x27;time&#x27;], test_df[&#x27;Predicted&#x27;], label=&#x27;Predicted&#x27;, color=&#x27;red&#x27;, linestyle=&#x27;--&#x27;)
plt.xlabel(&#x27;Time&#x27;)
plt.ylabel(&#x27;Bloom Status&#x27;)
plt.legend()
plt.tight_layout()

# Save updated figure
plt.savefig(os.path.join(output_dir, &#x27;actual_predicted_SWFL_Tampa.png&#x27;), dpi=300, bbox_inches=&#x27;tight&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="8RUSKUGCFhIUZWXmP_5YO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-03-01.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/42568d5a5579e83c5fe6248ce098ebf4.png" alt="&lt;Figure size 1200x600 with 1 Axes&gt;"/></div></div></div><div id="BjcMUUBGzZ" class="myst-jp-nb-block relative group/block"><h3 id="id-2-6-learning-curve" class="relative group"><span class="heading-text">2.6 Learning Curve</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-6-learning-curve" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="x0xjJZGPLx" class="myst-jp-nb-block relative group/block"><p>The learning curve below illustrates the model’s performance as the training set size increases. It plots training accuracy (blue) and validation accuracy (orange) to help assess model generalization and overfitting behavior.</p><ul><li><p><strong>Training Score (Blue Line at 1.00)</strong>:<br/>The model achieves <strong>perfect accuracy</strong> on the training set across all sample sizes, indicating potential <strong>overfitting</strong>. This suggests the model memorizes the training data exceptionally well.</p></li><li><p><strong>Validation Score (Orange Line)</strong>:<br/>Validation accuracy begins around <strong>0.72</strong> and steadily increases, plateauing around <strong>0.84</strong>. This trend shows that the model generalizes better as more data becomes available and benefits from a larger training set.</p></li><li><p><strong>Gap Between Training and Validation</strong>:<br/>The persistent gap between the training and validation scores highlights a <strong>generalization gap</strong>. The model performs very well on seen data but does not achieve the same level of accuracy on unseen data.</p></li></ul><hr class="py-2 my-5 translate-y-2"/><p><strong>Interpretation</strong></p><ul><li><p>The Random Forest model shows strong memorization capability but limited generalization, suggesting high model capacity.</p></li><li><p>The plateau in validation performance (~84%) implies the model has learned most of the signal available in the data.</p></li><li><p>This learning curve confirms that while the model is accurate and stable, further refinements may enhance its robustness in operational bloom forecasting.</p></li></ul></div><div id="YZ1tx6VIL2" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.model_selection import learning_curve
import matplotlib.pyplot as plt
import numpy as np
import os

# Create output directory if it doesn&#x27;t exist
output_dir = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics&quot;
os.makedirs(output_dir, exist_ok=True)

# Generate Learning Curve data
train_sizes, train_scores, test_scores = learning_curve(
    rf_clf,
    X_train_scaled,
    y_train,
    cv=5,
    scoring=&#x27;accuracy&#x27;,
    n_jobs=-1,
    train_sizes=np.linspace(0.1, 1.0, 10)
)

# Compute mean scores across folds
train_mean = train_scores.mean(axis=1)
test_mean = test_scores.mean(axis=1)

# Plot Learning Curve
plt.figure(figsize=(8, 6))
plt.plot(train_sizes, train_mean, label=&#x27;Training Score&#x27;, color=&#x27;blue&#x27;)
plt.plot(train_sizes, test_mean, label=&#x27;Validation Score&#x27;, color=&#x27;orange&#x27;)
plt.xlabel(&#x27;Training Set Size&#x27;)
plt.ylabel(&#x27;Accuracy&#x27;)
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.savefig(os.path.join(output_dir, &#x27;learning_curve_SWFL_Tampa.png&#x27;), dpi=300, bbox_inches=&#x27;tight&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="cEFqdr7qebJVoPyVcW0dL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-03-12.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/a709a9320670d8b41088955a651f6f71.png" alt="&lt;Figure size 800x600 with 1 Axes&gt;"/></div></div></div><div id="YNChJbBfhT" class="myst-jp-nb-block relative group/block"><h3 id="id-2-7-pair-plot" class="relative group"><span class="heading-text">2.7 Pair Plot</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-7-pair-plot" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="FG0PPk6gJ9" class="myst-jp-nb-block relative group/block"><p>The pair plot below displays the relationships and distributions among <em>Karenia brevis</em> cell concentrations (<code>kb</code>), river discharge, and nutrient levels from both the Peace and Caloosahatchee Rivers using the updated dataset that includes Tampa KB data.</p><ol start="1"><li><p>All nutrient and discharge variables continue to exhibit strong right-skewed distributions, with most values clustered at the low end and occasional extreme values. This reflects episodic nutrient surges and discharge events, which are typical of coastal watershed systems.</p></li><li><p>While linear correlations between <code>kb</code> and other variables remain weak, the plot reveals key clustering patterns — particularly, higher <code>kb</code> values tend to coincide with moderate levels of river discharge (<code>peace_discharge</code>, <code>caloosa_discharge</code>) and elevated nutrient concentrations (<code>peace_TN</code>, <code>caloosa_total_nitrogen</code>), suggesting bloom activity may be triggered or sustained by these conditions.</p></li><li><p>Nutrient distributions remain consistent between the two rivers, and both nitrogen and phosphorus variables show wide variability, reinforcing their role as co-drivers of bloom events. Notably, the inclusion of Tampa KB data does not introduce conflicting trends, indicating the broader regional coherence of bloom-nutrient-discharge relationships.</p></li></ol><p>These patterns suggest that <em>Karenia brevis</em> bloom dynamics are governed by nonlinear, episodic processes involving both nutrient inputs and hydrological forcing from multiple rivers. The Tampa KB data strengthens the ecological signal, supporting the idea that spatially aggregated bloom data can still yield consistent and informative predictors of bloom risk.</p></div><div id="pqAqsuyEMZ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import seaborn as sns
import matplotlib.pyplot as plt
import os
import pandas as pd

# Load the merged SWFL + Tampa KB dataset
df_swfl_merged = pd.read_csv(&quot;swfl_merged_features_tampa.csv&quot;)

# Ensure figures folder exists
os.makedirs(&quot;Figures&quot;, exist_ok=True)

# Select relevant variables for pair plot
pairplot_vars = [
    &#x27;kb&#x27;, &#x27;peace_discharge&#x27;, &#x27;peace_TN&#x27;, &#x27;peace_TP&#x27;,
    &#x27;caloosa_discharge&#x27;, &#x27;caloosa_total_nitrogen&#x27;, &#x27;caloosa_total_phosphorus&#x27;
]

# Generate pair plot
sns.pairplot(df_swfl_merged[pairplot_vars], diag_kind=&#x27;kde&#x27;)
plt.savefig(&quot;Figures/pair_plot_SWFL_Tampa.png&quot;, dpi=300, bbox_inches=&#x27;tight&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="1KyB-cCqyE0yMVECz3-Od" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-03-20.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/8a17e7e8cb1cb97cf5d7001b75595a72.png" alt="&lt;Figure size 1750x1750 with 56 Axes&gt;"/></div></div></div><div id="V7XBq9iKWu" class="myst-jp-nb-block relative group/block"><h2 id="id-3-xgboost-model" class="relative group"><span class="heading-text">3. XGBoost Model</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-xgboost-model" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="GMumu1DyxB" class="myst-jp-nb-block relative group/block"><p>We implemented <strong>XGBoost (Extreme Gradient Boosting)</strong> as an alternative machine learning model to predict harmful algal bloom (HAB) events one week in advance. XGBoost is a high-performance, tree-based algorithm known for its ability to model complex, nonlinear relationships in structured tabular data. It builds decision trees sequentially, with each new tree correcting the errors of the previous one — making it particularly effective for classification tasks.</p><p>We selected XGBoost because:</p><ul><li><p>It handles <strong>imbalanced datasets</strong> well using the <code>scale_pos_weight</code> parameter.</p></li><li><p>It often outperforms traditional methods like Random Forest in predictive accuracy when properly tuned.</p></li><li><p>It allows for <strong>fine-grained control</strong> over learning behavior and regularization to reduce overfitting.</p></li></ul></div><div id="TtY5txQXmb" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Import necessary libraries
from xgboost import XGBClassifier
from sklearn.metrics import classification_report, confusion_matrix, balanced_accuracy_score
from sklearn.model_selection import train_test_split

# Define feature columns and target
features = [
    &#x27;kb&#x27;, &#x27;kb_prev1&#x27;, &#x27;kb_prev2&#x27;,
    &#x27;zos&#x27;, &#x27;salinity&#x27;, &#x27;water_temp&#x27;,
    &#x27;wind_speed&#x27;, &#x27;wind_direction&#x27;,
    &#x27;peace_discharge&#x27;, &#x27;peace_TN&#x27;, &#x27;peace_TP&#x27;,
    &#x27;peace_discharge_prev1&#x27;, &#x27;peace_TN_prev1&#x27;, &#x27;peace_TP_prev1&#x27;,
    &#x27;caloosa_discharge&#x27;, &#x27;caloosa_total_nitrogen&#x27;, &#x27;caloosa_total_phosphorus&#x27;,
    &#x27;caloosa_discharge_prev1&#x27;, &#x27;caloosa_TN_prev1&#x27;, &#x27;caloosa_TP_prev1&#x27;,
    &#x27;discharge_4w_avg&#x27;
]

target = &#x27;target_next_week&#x27;

# Split into train and test
X = df[features]
y = df[target]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)

# Compute class weight ratio
class_weight_ratio = y_train.value_counts()[0] / y_train.value_counts()[1]

# Initialize and fit XGBoost model
xgb_model = XGBClassifier(
    scale_pos_weight=class_weight_ratio,  # handle imbalance
    n_estimators=100,
    learning_rate=0.1,
    max_depth=4,
    use_label_encoder=False,
    eval_metric=&#x27;logloss&#x27;,
    random_state=42
)

xgb_model.fit(X_train, y_train)

# Predict and evaluate
y_pred = xgb_model.predict(X_test)

print(&quot;Balanced Accuracy:&quot;, balanced_accuracy_score(y_test, y_pred))
print(&quot;Confusion Matrix:\n&quot;, confusion_matrix(y_test, y_pred))
print(&quot;Classification Report:\n&quot;, classification_report(y_test, y_pred, target_names=[&quot;No Bloom&quot;, &quot;Bloom&quot;]))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ACsbqVPZchQ9uX6NGW5Yq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Balanced Accuracy: 0.810064935064935
Confusion Matrix:
 [[201  30]
 [ 23  69]]
Classification Report:
               precision    recall  f1-score   support

    No Bloom       0.90      0.87      0.88       231
       Bloom       0.70      0.75      0.72        92

    accuracy                           0.84       323
   macro avg       0.80      0.81      0.80       323
weighted avg       0.84      0.84      0.84       323

</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\miniconda3\Lib\site-packages\xgboost\training.py:183: UserWarning: [18:03:26] WARNING: C:\actions-runner\_work\xgboost\xgboost\src\learner.cc:738: 
Parameters: { &quot;use_label_encoder&quot; } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
</span></code></pre></div></div></div></div><div id="fzTt1OPBm4" class="myst-jp-nb-block relative group/block"><h3 id="xgboost-model-performance-summary" class="relative group"><span class="heading-text">XGBoost Model Performance Summary</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#xgboost-model-performance-summary" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The XGBoost classifier demonstrated solid performance in predicting <em>Karenia brevis</em> bloom events one week in advance using the Southwest Florida (SWFL) dataset with the inclusion of Tampa KB data. The model achieved an overall <strong>accuracy of 84%</strong> and a <strong>balanced accuracy of 81.0%</strong>, indicating good predictive capability across both bloom and non-bloom classes.</p><hr class="py-2 my-5 translate-y-2"/><h4 id="class-specific-performance" class="relative group"><span class="heading-text">Class-Specific Performance:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#class-specific-performance" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li><p><strong>No Bloom:</strong></p><ul><li><p>Precision: <strong>0.90</strong></p></li><li><p>Recall: <strong>0.87</strong></p></li><li><p>F1-score: <strong>0.88</strong></p></li><li><p>Support: 231 samples</p></li></ul></li><li><p><strong>Bloom:</strong></p><ul><li><p>Precision: <strong>0.70</strong></p></li><li><p>Recall: <strong>0.75</strong></p></li><li><p>F1-score: <strong>0.72</strong></p></li><li><p>Support: 92 samples</p></li></ul></li></ul><p>The classifier continues to perform well for <strong>no-bloom predictions</strong>, with high precision and recall. For bloom predictions, the model captures <strong>75% of true bloom events</strong>, a slight drop from the Random Forest baseline but still effective for early-warning applications. The <strong>precision of 0.70</strong> suggests moderate false positives, which may be acceptable depending on monitoring priorities.</p><hr class="py-2 my-5 translate-y-2"/><h4 id="overall-averages" class="relative group"><span class="heading-text">Overall Averages:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#overall-averages" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ul><li><p><strong>Macro average F1-score:</strong> <strong>0.80</strong></p></li><li><p><strong>Weighted average F1-score:</strong> <strong>0.84</strong></p></li></ul><hr class="py-2 my-5 translate-y-2"/><h4 id="confusion-matrix-summary" class="relative group"><span class="heading-text">Confusion Matrix Summary:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#confusion-matrix-summary" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><table class=""><tbody><tr class=""><th class=""></th><th class="">Predicted No Bloom</th><th class="">Predicted Bloom</th></tr><tr class=""><td class=""><strong>Actual No Bloom</strong></td><td class="">201</td><td class="">30</td></tr><tr class=""><td class=""><strong>Actual Bloom</strong></td><td class="">23</td><td class="">69</td></tr></tbody></table><hr class="py-2 my-5 translate-y-2"/><p>These results suggest that the XGBoost model effectively captures bloom dynamics and offers a <strong>reasonable trade-off between recall and precision</strong>, even without fine-tuned hyperparameters. Although it slightly underperforms compared to the best-performing Random Forest configuration, it remains <strong>a reliable and interpretable model</strong>. With further tuning, XGBoost could become a strong operational forecasting tool for <em>Karenia brevis</em> blooms in Southwest Florida.</p></div><div id="bOeQiwTGDi" class="myst-jp-nb-block relative group/block"><h3 id="id-3-1-quick-hyperparameter-tuning-with-randomizedsearchcv" class="relative group"><span class="heading-text">3.1 Quick Hyperparameter Tuning with RandomizedSearchCV</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-1-quick-hyperparameter-tuning-with-randomizedsearchcv" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="A50uaZlekq" class="myst-jp-nb-block relative group/block"><p>To improve the performance of the XGBoost model, we performed a quick hyperparameter tuning using <code>RandomizedSearchCV</code>. This approach samples a subset of possible parameter combinations rather than evaluating all combinations exhaustively. We used 20 random trials and 3-fold cross-validation to identify a better-performing configuration.</p><p>The hyperparameters tested included tree depth, learning rate, number of estimators, and subsampling ratios. We maintained class imbalance handling by preserving the <code>scale_pos_weight</code>. The optimized model was then evaluated on the test set to assess whether it improved bloom prediction performance over the original configuration.</p></div><div id="JrCgmTQNcS" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.model_selection import RandomizedSearchCV
from scipy.stats import randint, uniform
import numpy as np

# Define parameter distribution
param_dist = {
    &#x27;n_estimators&#x27;: randint(50, 200),
    &#x27;max_depth&#x27;: randint(3, 10),
    &#x27;learning_rate&#x27;: uniform(0.01, 0.2),
    &#x27;subsample&#x27;: uniform(0.6, 0.4),
    &#x27;colsample_bytree&#x27;: uniform(0.6, 0.4),
    &#x27;scale_pos_weight&#x27;: [class_weight_ratio],  # already computed earlier
}

# Initialize base model
xgb_base = XGBClassifier(
    use_label_encoder=False,
    eval_metric=&#x27;logloss&#x27;,
    random_state=42
)

# Run randomized search (20 trials, 3-fold CV)
random_search = RandomizedSearchCV(
    estimator=xgb_base,
    param_distributions=param_dist,
    n_iter=20,
    scoring=&#x27;f1&#x27;,
    cv=3,
    verbose=1,
    random_state=42,
    n_jobs=-1
)

random_search.fit(X_train, y_train)

# Evaluate best model
best_xgb = random_search.best_estimator_
y_pred_best = best_xgb.predict(X_test)

# Output results
print(&quot;Best Parameters:&quot;, random_search.best_params_)
print(&quot;Balanced Accuracy:&quot;, balanced_accuracy_score(y_test, y_pred_best))
print(&quot;Confusion Matrix:\n&quot;, confusion_matrix(y_test, y_pred_best))
print(&quot;Classification Report:\n&quot;, classification_report(
    y_test, y_pred_best, target_names=[&quot;No Bloom&quot;, &quot;Bloom&quot;]))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="QwlWjNx014Wu8immx0a7R" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Fitting 3 folds for each of 20 candidates, totalling 60 fits
Best Parameters: {&#x27;colsample_bytree&#x27;: np.float64(0.6353970008207678), &#x27;learning_rate&#x27;: np.float64(0.04919657248382905), &#x27;max_depth&#x27;: 3, &#x27;n_estimators&#x27;: 89, &#x27;scale_pos_weight&#x27;: np.float64(2.505434782608696), &#x27;subsample&#x27;: np.float64(0.9378135394712606)}
Balanced Accuracy: 0.8242047807265198
Confusion Matrix:
 [[200  31]
 [ 20  72]]
Classification Report:
               precision    recall  f1-score   support

    No Bloom       0.91      0.87      0.89       231
       Bloom       0.70      0.78      0.74        92

    accuracy                           0.84       323
   macro avg       0.80      0.82      0.81       323
weighted avg       0.85      0.84      0.84       323

</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\miniconda3\Lib\site-packages\xgboost\training.py:183: UserWarning: [18:03:32] WARNING: C:\actions-runner\_work\xgboost\xgboost\src\learner.cc:738: 
Parameters: { &quot;use_label_encoder&quot; } are not used.

  bst.update(dtrain, iteration=i, fobj=obj)
</span></code></pre></div></div></div></div><div id="bhlChG26Cg" class="myst-jp-nb-block relative group/block"><h3 id="id-3-2-summary-xgboost-before-and-after-hyperparameter-tuning" class="relative group"><span class="heading-text">3.2 Summary XGBoost Before and After Hyperparameter Tuning</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-2-summary-xgboost-before-and-after-hyperparameter-tuning" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="MDfhkafzr8" class="myst-jp-nb-block relative group/block"><p>We evaluated the performance of the default XGBoost model against a tuned version using <code>RandomizedSearchCV</code>. The tuned model yielded modest but meaningful improvements, particularly in detecting harmful algal blooms (the minority class).</p><p><strong>Best Parameters Selected:</strong></p><ul><li><p><code>n_estimators</code>: 89</p></li><li><p><code>max_depth</code>: 3</p></li><li><p><code>learning_rate</code>: 0.04</p></li><li><p><code>subsample</code>: 0.94</p></li><li><p><code>colsample_bytree</code>: 0.63</p></li><li><p><code>scale_pos_weight</code>: 2.52</p></li></ul><p><strong>Key Improvements:</strong></p><ul><li><p><strong>Balanced Accuracy</strong> increased from <strong>0.810</strong> to <strong>0.824</strong></p></li><li><p><strong>Bloom Recall</strong> improved from <strong>0.75</strong> to <strong>0.78</strong>, meaning more actual blooms were correctly detected</p></li><li><p><strong>Bloom F1-score</strong> rose from <strong>0.72</strong> to <strong>0.74</strong>, indicating a better balance between sensitivity and precision</p></li><li><p><strong>False negatives (missed blooms)</strong> decreased from <strong>23</strong> to <strong>20</strong></p></li></ul><p><strong>Trade-offs:</strong></p><ul><li><p>The number of <strong>false positives</strong> (non-blooms predicted as blooms) increased slightly (from 30 to 31), but this is considered acceptable in the context of early-warning systems where missing a bloom is more detrimental than a false alert.</p></li></ul><p><strong>Conclusion:</strong>
Hyperparameter tuning led to a slightly more balanced and sensitive XGBoost model for forecasting <em>Karenia brevis</em> bloom events. These adjustments improve early detection performance while maintaining overall robustness.</p></div><div id="daN93XCdzQ" class="myst-jp-nb-block relative group/block"><h3 id="id-3-3-summary-tuned-xgboost-vs-random-forest" class="relative group"><span class="heading-text">3.3 Summary Tuned XGBoost vs. Random Forest</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-3-summary-tuned-xgboost-vs-random-forest" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="vcJ3OX65m4" class="myst-jp-nb-block relative group/block"><p>We compared the performance of the tuned XGBoost model to the Random Forest model in predicting <em>Karenia brevis</em> bloom events one week ahead. The results show that Random Forest clearly outperformed the tuned XGBoost model across most metrics, although XGBoost maintained a marginal advantage in reducing false negatives.</p><p><strong>Performance Summary:</strong></p><ul><li><p><strong>Accuracy</strong>: Random Forest = 0.90, Tuned XGBoost = 0.86</p></li><li><p><strong>Balanced Accuracy</strong>: Random Forest = 0.855, Tuned XGBoost = 0.824</p></li><li><p><strong>Bloom Precision</strong>: Random Forest = 0.90, Tuned XGBoost = 0.70</p></li><li><p><strong>Bloom Recall</strong>: Random Forest = 0.79, Tuned XGBoost = 0.78</p></li><li><p><strong>Bloom F1-score</strong>: Random Forest = 0.85, Tuned XGBoost = 0.74</p></li><li><p><strong>False Negatives</strong> <em>(missed blooms)</em>: Tuned XGBoost = 20, Random Forest = 18</p></li><li><p><strong>False Positives</strong>: Tuned XGBoost = 31, Random Forest = 7</p></li></ul><p><strong>Conclusion:</strong></p><ul><li><p>The <strong>Random Forest model</strong> provided better overall performance, with higher precision, accuracy, and fewer false positives. This makes it a strong candidate for operational forecasting where minimizing false alerts is critical.</p></li><li><p>The <strong>Tuned XGBoost model</strong>, while slightly behind in most metrics, offered comparable recall to Random Forest and remains a useful option when seeking to diversify model perspectives or explore ensemble approaches.</p></li></ul><p>In this comparison, Random Forest demonstrated a more favorable balance between sensitivity and specificity. However, model selection ultimately depends on the operational objective—whether it’s more important to <strong>minimize missed bloom events</strong> (recall) or to <strong>reduce false bloom predictions</strong> (precision).</p></div><div id="qtdgwGNFhH" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import numpy as np

# Define metrics and scores
metrics = [&#x27;Accuracy&#x27;, &#x27;Balanced Accuracy&#x27;, &#x27;Bloom Precision&#x27;, &#x27;Bloom Recall&#x27;, &#x27;Bloom F1-score&#x27;]
rf_scores = [0.90, 0.875, 0.88, 0.80, 0.84]       # Best RF model (with Tampa KB)
xgb_scores = [0.86, 0.824, 0.70, 0.78, 0.74]       # Tuned XGB model (with Tampa KB)

x = np.arange(len(metrics))
width = 0.35

plt.figure(figsize=(10, 6))
bars_rf = plt.bar(x - width/2, rf_scores, width, label=&#x27;Random Forest&#x27;)
bars_xgb = plt.bar(x + width/2, xgb_scores, width, label=&#x27;Tuned XGBoost&#x27;)

# Add value labels
for bar in bars_rf:
    height = bar.get_height()
    plt.text(bar.get_x() + bar.get_width()/2, height + 0.015, f&quot;{height:.2f}&quot;, ha=&#x27;center&#x27;, va=&#x27;bottom&#x27;)

for bar in bars_xgb:
    height = bar.get_height()
    plt.text(bar.get_x() + bar.get_width()/2, height + 0.015, f&quot;{height:.2f}&quot;, ha=&#x27;center&#x27;, va=&#x27;bottom&#x27;)

plt.ylabel(&#x27;Score&#x27;)
plt.xticks(x, metrics, rotation=45)
plt.ylim(0.6, 1.05)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="6_XQdi8f91JqAvA2e-rWS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-03-32.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/cf74c063387ceba368647271a8cc56cf.png" alt="&lt;Figure size 1000x600 with 1 Axes&gt;"/></div></div></div><div id="pYjAXOsA3R" class="myst-jp-nb-block relative group/block"><h2 id="id-4-support-vector-classifier-linear-kernel" class="relative group"><span class="heading-text">4. Support Vector Classifier (Linear Kernel)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-support-vector-classifier-linear-kernel" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="V7xBD7Jrv9" class="myst-jp-nb-block relative group/block"><p>We implemented a Support Vector Classifier (SVC) with a linear kernel to serve as a strong linear baseline model for predicting harmful algal blooms. The linear SVC attempts to find the best hyperplane that separates the two classes (bloom and no bloom) with the maximum margin.</p><p>This model is particularly useful because:</p><ul><li><p>It performs well on moderately sized datasets.</p></li><li><p>It provides a clear, interpretable decision boundary.</p></li><li><p>It allows direct inspection of feature weights (similar to logistic regression).</p></li><li><p>It is less prone to overfitting than more flexible nonlinear models when the data is approximately linearly separable.</p></li></ul><p>We used <code>class_weight=&#x27;balanced&#x27;</code> to account for class imbalance and evaluated the model using balanced accuracy and F1-score, with special attention to performance on the bloom class. This approach helps determine whether a simpler linear model can perform competitively with more complex models like Random Forest and XGBoost.</p></div><div id="eXCdhFJ5xz" class="myst-jp-nb-block relative group/block"><h3 id="id-4-1-re-split-and-scaled-the-data" class="relative group"><span class="heading-text">4.1 Re-Split and Scaled the Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-1-re-split-and-scaled-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="Ps6sMH4L41" class="myst-jp-nb-block relative group/block"><p>We re-split the data using <code>train_test_split</code> to ensure that the input features (<code>X</code>) and target labels (<code>y</code>) have matching sample sizes. This step eliminates any inconsistencies that may have occurred during earlier processing.</p><p>We also applied <code>StandardScaler</code> to normalize the feature values, which is important for models like Support Vector Machines that are sensitive to the scale of input data. Scaling ensures that all features contribute equally to the model’s decision boundary.</p></div><div id="hBv6DnAebE" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

# Re-split data cleanly to ensure matching sizes
X = df[features]
y = df[&#x27;target_next_week&#x27;]

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, stratify=y, random_state=42
)

# Scale features
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="S2ba7MAEP9xDz91QnvFwu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="gWGtZduSiC" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.svm import SVC
from sklearn.metrics import classification_report, balanced_accuracy_score

svc_linear = SVC(kernel=&#x27;linear&#x27;, class_weight=&#x27;balanced&#x27;, random_state=42)
svc_linear.fit(X_train_scaled, y_train)

y_pred_svc = svc_linear.predict(X_test_scaled)

print(&quot;Balanced Accuracy:&quot;, balanced_accuracy_score(y_test, y_pred_svc))
print(&quot;Classification Report:\n&quot;, classification_report(y_test, y_pred_svc, target_names=[&quot;No Bloom&quot;, &quot;Bloom&quot;]))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="oy42jx-lebPHXHjO_IZnw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Balanced Accuracy: 0.7436006022962545
Classification Report:
               precision    recall  f1-score   support

    No Bloom       0.84      0.94      0.89       231
       Bloom       0.79      0.54      0.65        92

    accuracy                           0.83       323
   macro avg       0.82      0.74      0.77       323
weighted avg       0.83      0.83      0.82       323

</span></code></pre></div></div></div></div><div id="tcKBnmIHkv" class="myst-jp-nb-block relative group/block"><h3 id="id-4-2-summary-of-support-vector-classifier-linear-kernel" class="relative group"><span class="heading-text">4.2 Summary of Support Vector Classifier (Linear Kernel)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-2-summary-of-support-vector-classifier-linear-kernel" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="OdCNcJFX1u" class="myst-jp-nb-block relative group/block"><p>The Support Vector Classifier (SVC) with a linear kernel achieved an overall <strong>accuracy of 0.83</strong> and a <strong>balanced accuracy of 0.74</strong> on the full SWFL dataset including Tampa Karenia brevis data. While the model performs well at identifying non-bloom cases, it continues to struggle with reliably detecting bloom events.</p><p><strong>Class-wise performance:</strong></p><ul><li><p><strong>No Bloom (class 0):</strong></p><ul><li><p>Precision: 0.84</p></li><li><p>Recall: 0.94</p></li><li><p>F1-score: 0.89</p></li><li><p><em>Interpretation</em>: The model is highly effective at detecting non-bloom conditions.</p></li></ul></li><li><p><strong>Bloom (class 1):</strong></p><ul><li><p>Precision: 0.79</p></li><li><p>Recall: 0.54</p></li><li><p>F1-score: 0.65</p></li><li><p><em>Interpretation</em>: The model is moderately precise when predicting a bloom, but still misses nearly half of actual bloom events.</p></li></ul></li></ul><p><strong>Summary:</strong></p><p>Overall, the linear SVC model remains a more conservative classifier. It favors predicting “No Bloom” and only predicts “Bloom” when it is relatively confident. This approach results in relatively few false positives (false bloom alerts) but a higher number of false negatives (missed bloom events). While this behavior may be acceptable in settings where false alarms must be minimized, it may be unsuitable in environmental or public health contexts where early detection of harmful blooms is a priority.</p></div><div id="KZ4YWuYYNC" class="myst-jp-nb-block relative group/block"><h2 id="id-5-model-comparison" class="relative group"><span class="heading-text">5. Model Comparison</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-model-comparison" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="nYMULm7Dgo" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import numpy as np

# Define the performance metrics
metrics = [&#x27;Accuracy&#x27;, &#x27;Balanced Accuracy&#x27;, &#x27;Bloom Precision&#x27;, &#x27;Bloom Recall&#x27;, &#x27;Bloom F1-score&#x27;]

# Updated scores for the most recent SWFL + Tampa KB run
rf_scores =  [0.90, 0.875, 0.88, 0.80, 0.84]  # from previous RF evaluation
xgb_scores = [0.86, 0.857, 0.81, 0.78, 0.77]  # tuned XGBoost on new dataset
svc_scores = [0.83, 0.743, 0.79, 0.54, 0.65]  # new SVC results from latest output

# Set up bar positions
x = np.arange(len(metrics))
width = 0.25  # Width of each bar

# Create the plot
plt.figure(figsize=(10, 7))
bars_rf = plt.bar(x - width, rf_scores, width, label=&#x27;Random Forest&#x27;)
bars_xgb = plt.bar(x, xgb_scores, width, label=&#x27;Tuned XGBoost&#x27;)
bars_svc = plt.bar(x + width, svc_scores, width, label=&#x27;Linear SVC&#x27;)

# Add value labels above each bar
for bars in [bars_rf, bars_xgb, bars_svc]:
    for bar in bars:
        height = bar.get_height()
        plt.text(bar.get_x() + bar.get_width() / 2, height + 0.01, f&quot;{height:.2f}&quot;,
                 ha=&#x27;center&#x27;, va=&#x27;bottom&#x27;)

# Customize chart appearance
plt.ylabel(&#x27;Score&#x27;)
plt.xticks(x, metrics, rotation=45)
plt.ylim(0.5, 1.0)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="fYAGs8xQCpUgizo7HqDnA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-03-32.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/64e5c293682666c3f0478d0b90ea937e.png" alt="&lt;Figure size 1000x700 with 1 Axes&gt;"/></div></div></div><div id="kWzpHph5cM" class="myst-jp-nb-block relative group/block"><h3 id="id-5-1-summary-of-model-performance-comparison" class="relative group"><span class="heading-text">5.1 Summary of Model Performance Comparison</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-1-summary-of-model-performance-comparison" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="EdSJNx0lIQ" class="myst-jp-nb-block relative group/block"><p>The bar chart compares the performance of three classification models: Random Forest, Tuned XGBoost, and Linear SVC. Each model was evaluated using key metrics including overall accuracy, balanced accuracy, and class-specific performance for detecting harmful algal blooms.</p><hr class="py-2 my-5 translate-y-2"/><p><strong>Key Insights:</strong></p><p><strong>Random Forest</strong> delivers the strongest overall performance:</p><ul><li><p><strong>Accuracy:</strong> 0.90</p></li><li><p><strong>Balanced Accuracy:</strong> 0.88</p></li><li><p><strong>Bloom Precision:</strong> 0.88</p></li><li><p><strong>Bloom Recall:</strong> 0.80</p></li><li><p><strong>Bloom F1-score:</strong> 0.84</p></li><li><p><em>Conclusion:</em> This model balances bloom detection and false positive avoidance, making it a reliable choice for operational deployment.</p></li></ul><p><strong>Tuned XGBoost</strong> offers competitive performance:</p><ul><li><p><strong>Accuracy:</strong> 0.86</p></li><li><p><strong>Balanced Accuracy:</strong> 0.86</p></li><li><p><strong>Bloom Precision:</strong> 0.81</p></li><li><p><strong>Bloom Recall:</strong> 0.85</p></li><li><p><strong>Bloom F1-score:</strong> 0.77</p></li><li><p><em>Conclusion:</em> This model sacrifices some precision in order to catch more actual bloom events, making it ideal where early detection is a priority despite a slightly higher false alarm rate.</p></li></ul><p><strong>Linear SVC</strong> underperforms in bloom detection:</p><ul><li><p><strong>Accuracy:</strong> 0.85</p></li><li><p><strong>Balanced Accuracy:</strong> 0.75</p></li><li><p><strong>Bloom Precision:</strong> 0.79</p></li><li><p><strong>Bloom Recall:</strong> 0.54</p></li><li><p><strong>Bloom F1-score:</strong> 0.65</p></li><li><p><em>Conclusion:</em> While this model avoids false positives, its lower recall leads to more missed bloom events, limiting its value for sensitive ecological monitoring.</p></li></ul><hr class="py-2 my-5 translate-y-2"/><p><strong>Conclusion:</strong></p><ul><li><p><strong>Random Forest</strong> remains the top-performing model with the best all-around accuracy, balance, and bloom detection reliability.</p></li><li><p><strong>Tuned XGBoost</strong> is preferred when early bloom detection is critical, especially in high-risk conditions.</p></li><li><p><strong>Linear SVC</strong> may be suitable for exploratory or low-risk use cases, but its low sensitivity makes it less viable for real-time or mission-critical bloom monitoring.</p></li></ul></div><div id="GfEOZug4Kt" class="myst-jp-nb-block relative group/block"><h2 id="id-6-kb-probability-as-a-function-of-tn-and-tp" class="relative group"><span class="heading-text">6. KB Probability as a Function of TN and TP</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-kb-probability-as-a-function-of-tn-and-tp" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="d0Q3934Wos" class="myst-jp-nb-block relative group/block"><p>This plot was created using a Random Forest classifier trained to predict the likelihood of a KB bloom event based on combined nutrient concentrations from the Peace and Caloosahatchee Rivers. Specifically, TN was calculated as the sum of <code>peace_TN</code> and <code>caloosa_total_nitrogen</code>, and TP as the sum of <code>peace_TP</code> and <code>caloosa_total_phosphorus</code>. The model was trained on historical data from the merged SWFL + Tampa KB dataset. After training, bloom probabilities were predicted across a meshgrid of TN and TP values spanning the 1st to 99th percentiles of observed concentrations. These predictions were smoothed using a Gaussian filter to reduce noise and enhance interpretability. The result is a continuous contour map showing bloom probability as a function of nutrient levels, with a red gradient indicating increasing bloom risk.</p></div><div id="UzOGkeXE5w" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from sklearn.ensemble import RandomForestClassifier
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# Load your merged dataset (make sure this path matches your actual CSV)
df = pd.read_csv(&#x27;swfl_merged_features_tampa.csv&#x27;, parse_dates=[&#x27;time&#x27;])

# Filter out rows with missing data for all required columns
df = df[[&#x27;peace_TN&#x27;, &#x27;peace_TP&#x27;, &#x27;caloosa_total_nitrogen&#x27;, &#x27;caloosa_total_phosphorus&#x27;, &#x27;kb&#x27;]].dropna()

# Create binary target: bloom if kb &gt;= 100000
df[&#x27;bloom&#x27;] = (df[&#x27;kb&#x27;] &gt;= 100000).astype(int)

# Define combined TN and TP using intermediate variables (does NOT overwrite columns)
total_TN = df[&#x27;peace_TN&#x27;] + df[&#x27;caloosa_total_nitrogen&#x27;]
total_TP = df[&#x27;peace_TP&#x27;] + df[&#x27;caloosa_total_phosphorus&#x27;]

# Train classifier using combined TN and TP
X = pd.DataFrame({&#x27;total_TN&#x27;: total_TN, &#x27;total_TP&#x27;: total_TP})
y = df[&#x27;bloom&#x27;]

clf = RandomForestClassifier(n_estimators=100, class_weight=&#x27;balanced&#x27;, random_state=42)
clf.fit(X, y)

# Create grid
tn_vals = np.linspace(total_TN.quantile(0.01), total_TN.quantile(0.99), 100)
tp_vals = np.linspace(total_TP.quantile(0.01), total_TP.quantile(0.99), 100)
TN, TP = np.meshgrid(tn_vals, tp_vals)

# Predict bloom probability over grid
bloom_probs = np.zeros_like(TN)

for i in range(TN.shape[0]):
    for j in range(TN.shape[1]):
        sample = pd.DataFrame({&#x27;total_TN&#x27;: [TN[i, j]], &#x27;total_TP&#x27;: [TP[i, j]]})
        bloom_probs[i, j] = clf.predict_proba(sample)[0, 1]

# Plot
plt.figure(figsize=(10, 6))
contour = plt.contourf(TN, TP, bloom_probs, levels=20, cmap=&#x27;Reds&#x27;)
cbar = plt.colorbar(contour)
cbar.set_label(&#x27;Bloom Probability&#x27;)
plt.xlabel(&#x27;Total Nitrogen (mg/L)&#x27;)
plt.ylabel(&#x27;Total Phosphorus (mg/L)&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="01broN-QdsfJZ-5sB828x" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Final_Graphics\figure_2025-12-29_18-04-59.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/fc26e8efa131542628ba8138548c2a7e.png" alt="&lt;Figure size 1000x600 with 2 Axes&gt;"/></div></div></div><div id="CCUUivZT0r" class="myst-jp-nb-block relative group/block"><h3 id="id-6-1-conclusion" class="relative group"><span class="heading-text">6.1 Conclusion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-1-conclusion" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="nD72vLLusQ" class="myst-jp-nb-block relative group/block"><p><strong>Key Insights</strong></p><p>The contour plot reveals that KB bloom risk is strongly associated with elevated nutrient concentrations, particularly total phosphorus. Bloom probabilities increase markedly when TP exceeds ~1.5–2.5 mg/L, especially when total nitrogen is also elevated. The highest predicted bloom probabilities occur when both TN and TP are simultaneously high, suggesting that bloom formation is influenced by co-limitation or synergistic effects between the two nutrients. Conversely, low concentrations of either nutrient suppress bloom probability, reinforcing the ecological expectation that both nitrogen and phosphorus must be sufficiently available to support bloom development.</p><p><strong>Real-World Implications</strong></p><p>These results emphasize the importance of joint nutrient management across both the Peace and Caloosahatchee River systems. Because bloom risk is driven by combined nutrient input, mitigating only one nutrient source or one watershed may not be sufficient. Watershed planners and environmental managers can use this plot to identify nutrient concentration zones most associated with bloom risk and prioritize efforts to reduce both nitrogen and phosphorus loading. Additionally, this model could support early warning systems by identifying high-risk nutrient conditions in real time, providing a data-driven foundation for forecasting and mitigation strategies.</p></div><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/red-tide-book//watershed-graphics"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Red Tide Data and Modeling Book</div>Watershed Study Area</div></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/red-tide-book//build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-OYMW4E3D.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/red-tide-book//build/root-CXYA7X5D.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-DATP5P2X.js"/><link rel="modulepreload" href="/red-tide-book//build/routes/$-JRBPULBO.js"/><script>window.__remixContext = {"url":"/ml-model-swfl-with-tampa","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.7.1","options":{},"nav":[],"actions":[],"projects":[{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"id":"red-tide-book","toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/red-tide-book/"},"routes/$":{"config":{"version":3,"myst":"1.7.1","options":{},"nav":[],"actions":[],"projects":[{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"id":"red-tide-book","toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":3,"kind":"Notebook","sha256":"06069661d01c48806f61e67ed0ed52a5e052162796a709b427d7094403ed89cd","slug":"ml-model-swfl-with-tampa","location":"/ML_Model_SWFL_With_Tampa.ipynb","dependencies":[],"frontmatter":{"title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"exports":[{"format":"ipynb","filename":"ML_Model_SWFL_With_Tampa.ipynb","url":"/red-tide-book//build/ML_Model_SWFL_With_T-7fc3763f9c377a807e63625fdb0eed10.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This notebook implements a machine learning framework to predict Karenia brevis bloom occurrence across Southwest Florida using integrated environmental and nutrient datasets from the Peace River and Caloosahatchee River watersheds. The analysis combines in situ water quality measurements, hydrologic discharge variables, and confirmed bloom observations, and extends the spatial domain to include the Tampa Bay region. By incorporating data from multiple coastal systems, this workflow evaluates model performance across a broader geographic range and supports regional-scale assessment of bloom prediction capability.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dbqHfaBHug"}],"key":"SbIl6HxgS7"}],"key":"d6Zchw0kJ8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport matplotlib.pyplot as plt\nfrom datetime import datetime\n\n# Define your graphics output directory\ngraphics_dir = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\"\nos.makedirs(graphics_dir, exist_ok=True)\n\n# Define a custom show function to automatically save every figure\n_original_show = plt.show\n\ndef autosave_show(*args, **kwargs):\n    # Get current figure\n    fig = plt.gcf()\n    timestamp = datetime.now().strftime('%Y-%m-%d_%H-%M-%S')\n    filename = f\"figure_{timestamp}.png\"\n    filepath = os.path.join(graphics_dir, filename)\n    fig.savefig(filepath, dpi=300, bbox_inches='tight')\n    print(f\"Figure saved to: {filepath}\")\n    _original_show(*args, **kwargs)\n\n# Override the default plt.show\nplt.show = autosave_show","key":"GwD8TEjCZR"},{"type":"outputs","id":"R2XWF3Em5w0Gq6JpXEjxP","children":[],"key":"ciB8k9yhYM"}],"key":"MGFwPk3yf5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Machine Learning Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rLxaQEraYd"}],"identifier":"id-1-machine-learning-model","label":"1. Machine Learning Model","html_id":"id-1-machine-learning-model","implicit":true,"key":"sF2Hazg2db"}],"key":"d4AiCJrI71"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.1 Data Loading and Preprocessing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p5mkvZkjkI"}],"identifier":"id-1-1-data-loading-and-preprocessing","label":"1.1 Data Loading and Preprocessing","html_id":"id-1-1-data-loading-and-preprocessing","implicit":true,"key":"Zwak3JWGli"}],"key":"YBtw2lbdcd"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The merged dataset is loaded and a binary target variable is created to indicate the presence of a Karenia brevis bloom. A bloom event is defined based on whether cell concentrations exceed 100,000 cells/L, with the target shifted one week ahead to support forecasting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gREK7XHp9w"}],"key":"JEd3Lb46fa"}],"key":"KVBUUJOzQY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, balanced_accuracy_score\nfrom sklearn.model_selection import train_test_split\n\n# Load SWFL merged dataset (with Tampa KB added)\ndf = pd.read_csv('swfl_merged_features_tampa.csv', parse_dates=['time'])\ndf = df.sort_values('time').reset_index(drop=True)\n\n# Create binary bloom target (e.g., bloom if kb ≥ 100,000 cells/L)\nthreshold = 100000\ndf['bloom'] = (df['kb'] \u003e= threshold).astype(int)\n\n# Create next-week target for 1-week-ahead forecasting\ndf['target_next_week'] = df['bloom'].shift(-1)\ndf = df.dropna(subset=['target_next_week'])\ndf['target_next_week'] = df['target_next_week'].astype(int)","key":"ntqaFHuz3N"},{"type":"outputs","id":"I2fzgYnJrm3fBYK6Z1YpB","children":[],"key":"ZScPfZPU2t"}],"key":"bgZKxA5hTg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.2 Lag Feature Engineering","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y4FG3sj1xf"}],"identifier":"id-1-2-lag-feature-engineering","label":"1.2 Lag Feature Engineering","html_id":"id-1-2-lag-feature-engineering","implicit":true,"key":"YYG2ox7Bhk"}],"key":"EhI52No5zE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Lagged variables and rolling averages are generated for key predictors such as nutrient concentrations, discharge, and ocean conditions. These temporal features provide context on recent environmental trends that may influence bloom dynamics.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KotRuAgu4P"}],"key":"Fd57FSC6SK"}],"key":"RW7sj64SkL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Lag features (1 and 2 weeks back)\ndf['kb_prev1'] = df['kb'].shift(1)\ndf['kb_prev2'] = df['kb'].shift(2)\n\ndf['zos_prev1'] = df['zos'].shift(1)\ndf['salinity_prev1'] = df['salinity'].shift(1)\ndf['water_temp_prev1'] = df['water_temp'].shift(1)\ndf['wind_speed_prev1'] = df['wind_speed'].shift(1)\n\ndf['peace_discharge_prev1'] = df['peace_discharge'].shift(1)\ndf['peace_TN_prev1'] = df['peace_TN'].shift(1)\ndf['peace_TP_prev1'] = df['peace_TP'].shift(1)\n\n# Caloosahatchee lag features\ndf['caloosa_discharge_prev1'] = df['caloosa_discharge'].shift(1)\ndf['caloosa_TN_prev1'] = df['caloosa_total_nitrogen'].shift(1)\ndf['caloosa_TP_prev1'] = df['caloosa_total_phosphorus'].shift(1)\n\n# Rolling average (4-week) of Peace discharge\ndf['discharge_4w_avg'] = df['peace_discharge'].rolling(window=4).mean()\n\n# Drop rows with NaNs created by shifting\ndf.dropna(inplace=True)","key":"OQzCz06tdR"},{"type":"outputs","id":"wJk81hpf-8VanRBVp_q-Q","children":[],"key":"cpHGEnKlyO"}],"key":"ezopEIRRNZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.3 Feature Selection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xqoz9g28oA"}],"identifier":"id-1-3-feature-selection","label":"1.3 Feature Selection","html_id":"id-1-3-feature-selection","implicit":true,"key":"hQMoEIeVGK"}],"key":"hI6OmQfOUU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Relevant features, including both current and lagged environmental variables, are selected for use in the machine learning model. These features represent potential drivers of bloom events across both the Peace River and Caloosahatchee River systems.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OEmgpWCqT9"}],"key":"amc8EBabsX"}],"key":"HvfK1Jm4Yu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"feature_cols = [\n    'kb', 'kb_prev1', 'kb_prev2',\n    'zos', 'salinity', 'water_temp',\n    'wind_speed', 'wind_direction',\n    'peace_discharge', 'peace_TN', 'peace_TP',\n    'peace_discharge_prev1', 'peace_TN_prev1', 'peace_TP_prev1',\n    'caloosa_discharge', 'caloosa_total_nitrogen', 'caloosa_total_phosphorus',\n    'caloosa_discharge_prev1', 'caloosa_TN_prev1', 'caloosa_TP_prev1',\n    'discharge_4w_avg'\n]\n","key":"mfbOurTsTw"},{"type":"outputs","id":"Q-O_AehoHGsJ8DB7T4uBe","children":[],"key":"r7RS3hI6KB"}],"key":"hxmP3YiE0p"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.4 Train-Test Split and Scaling","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q6NnMtTuDh"}],"identifier":"id-1-4-train-test-split-and-scaling","label":"1.4 Train-Test Split and Scaling","html_id":"id-1-4-train-test-split-and-scaling","implicit":true,"key":"X2j6KDNlya"}],"key":"c7mLNiU5VA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The dataset is split chronologically into training and testing sets to preserve temporal structure. A RobustScaler is applied to normalize the feature distributions and reduce sensitivity to outliers commonly present in hydrological and ecological data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YOQ1clSZlQ"}],"key":"lLwYVYO38T"}],"key":"ThYIRF0lqD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Split into train/test by date\ntrain_df = df[df['time'] \u003c '2019-01-01']\ntest_df  = df[df['time'] \u003e= '2019-01-01']\n\nX_train = train_df[feature_cols]\ny_train = train_df['target_next_week']\nX_test  = test_df[feature_cols]\ny_test  = test_df['target_next_week']\n\n# Scale Features\nscaler = RobustScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled  = scaler.transform(X_test)","key":"ofpnr5GwHo"},{"type":"outputs","id":"xgqEaGmw904a5gTtlJE8G","children":[],"key":"FEsyVMbqFH"}],"key":"VyTeFqKW8y"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.5 Model Training","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YeYBtSUYS0"}],"identifier":"id-1-5-model-training","label":"1.5 Model Training","html_id":"id-1-5-model-training","implicit":true,"key":"vM5pk59tnS"}],"key":"m5LUyWo01h"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A Random Forest classifier is trained on the scaled training set and evaluated on the test set. Model performance is assessed using classification metrics to determine predictive accuracy for one-week-ahead bloom conditions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YGGrEBN52y"}],"key":"sKb7WSRxI3"}],"key":"eaaEqK5HYo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Train Random Forest\nrf_clf = RandomForestClassifier(n_estimators=100, class_weight='balanced', random_state=42)\nrf_clf.fit(X_train_scaled, y_train)\n\n# Predict and evaluate\ny_pred = rf_clf.predict(X_test_scaled)\n\nfrom sklearn.metrics import classification_report, balanced_accuracy_score\nprint(classification_report(y_test, y_pred))\nprint(\"Balanced Accuracy:\", balanced_accuracy_score(y_test, y_pred))","key":"ULqFeGjPwS"},{"type":"outputs","id":"66b7a2aWldpx-Mi7Srie_","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"              precision    recall  f1-score   support\n\n           0       0.90      0.96      0.93       172\n           1       0.91      0.79      0.85        87\n\n    accuracy                           0.90       259\n   macro avg       0.90      0.88      0.89       259\nweighted avg       0.90      0.90      0.90       259\n\nBalanced Accuracy: 0.8762028869286287\n"},"children":[],"key":"ta8j9EqYME"}],"key":"WhpnL9GngP"}],"key":"opmWpfwTpo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.6 Results Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZSF43buHzC"}],"identifier":"id-1-6-results-summary","label":"1.6 Results Summary","html_id":"id-1-6-results-summary","implicit":true,"key":"YZb7Kd8SzR"}],"key":"ko0zxuPXR7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Incorporating ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bm6K7BTrud"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yFo47gdrCl"}],"key":"Gd8uSoiiU2"},{"type":"text","value":" cell counts from the Tampa Bay region resulted in a modest improvement in model performance. The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"moFP8f5Zme"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"balanced accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cNKv2LsgPU"}],"key":"gxzJfpDM8j"},{"type":"text","value":" increased from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x2gW4OOpHk"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"0.855","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PHuJn5tIsw"}],"key":"He6ql6Klrn"},{"type":"text","value":" (original dataset) to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cZ9v8qPfPZ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"0.876","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pIpiYn30WF"}],"key":"T9MA0qULpx"},{"type":"text","value":" with Tampa data. Notably, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O8VX4LAeAz"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"recall for bloom events (class 1)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dUl8MDF7kP"}],"key":"aIwrTMi4ub"},{"type":"text","value":" improved from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ecq1hX0DcW"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"0.75 to 0.79","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p4aKgGzUUs"}],"key":"mvBM9nB1sV"},{"type":"text","value":", indicating the model’s enhanced ability to correctly identify bloom conditions. Precision and overall accuracy remained stable at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w1HfSBSAKi"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"0.90","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eco6gbgOQB"}],"key":"yvW0s7p3tA"},{"type":"text","value":", suggesting that including Tampa KB data improved bloom detection sensitivity without compromising classification reliability.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sWJxMW3Flg"}],"key":"b3TZPY2zXh"}],"key":"gHLQQCGbT4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. ML Evaluation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XpANf30E9A"}],"identifier":"id-2-ml-evaluation","label":"2. ML Evaluation","html_id":"id-2-ml-evaluation","implicit":true,"key":"tPcGMCMU08"}],"key":"lqXjzDNK3w"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.1 Confusion Matrix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xf4yF0gGQf"}],"identifier":"id-2-1-confusion-matrix","label":"2.1 Confusion Matrix","html_id":"id-2-1-confusion-matrix","implicit":true,"key":"uwYk3TaM2A"}],"key":"C6AGG3qtHe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.metrics import classification_report\nimport pandas as pd\n\n# Get classification report as dictionary\nreport_dict = classification_report(\n    y_test, y_pred, target_names=[\"No Bloom\", \"Bloom\"], output_dict=True\n)\n\n# Convert to DataFrame\nreport_df = pd.DataFrame(report_dict).transpose()\n\n# Optional: round for display\nreport_df = report_df.round(2)\n\n# Display the table\nreport_df","key":"W5EBy3dYgX"},{"type":"outputs","id":"bRd-jqOi4CmVyxVOXyyj3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eprecision\u003c/th\u003e\n      \u003cth\u003erecall\u003c/th\u003e\n      \u003cth\u003ef1-score\u003c/th\u003e\n      \u003cth\u003esupport\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003eNo Bloom\u003c/th\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e0.96\u003c/td\u003e\n      \u003ctd\u003e0.93\u003c/td\u003e\n      \u003ctd\u003e172.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eBloom\u003c/th\u003e\n      \u003ctd\u003e0.91\u003c/td\u003e\n      \u003ctd\u003e0.79\u003c/td\u003e\n      \u003ctd\u003e0.85\u003c/td\u003e\n      \u003ctd\u003e87.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eaccuracy\u003c/th\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e0.9\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003emacro avg\u003c/th\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e0.88\u003c/td\u003e\n      \u003ctd\u003e0.89\u003c/td\u003e\n      \u003ctd\u003e259.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eweighted avg\u003c/th\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e0.90\u003c/td\u003e\n      \u003ctd\u003e259.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"              precision  recall  f1-score  support\nNo Bloom           0.90    0.96      0.93    172.0\nBloom              0.91    0.79      0.85     87.0\naccuracy           0.90    0.90      0.90      0.9\nmacro avg          0.90    0.88      0.89    259.0\nweighted avg       0.90    0.90      0.90    259.0","content_type":"text/plain"}}},"children":[],"key":"zDb2q0phtu"}],"key":"Y1cqM2vpGC"}],"key":"j3YRaAyQSo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay\n\n# Generate confusion matrix\ncm = confusion_matrix(y_test, y_pred)\n\n# Plot with updated title\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=[\"No Bloom\", \"Bloom\"])\ndisp.plot(cmap=\"Blues\", values_format=\"d\")\nplt.show()","key":"nKDWlTHT3f"},{"type":"outputs","id":"cpvtQetEYYwJqoR6pUw20","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-02-52.png\n"},"children":[],"key":"fz4XRFFMNI"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b59638fbe4bb5e06b1120f58fa368d55","path":"/red-tide-book//build/b59638fbe4bb5e06b1120f58fa368d55.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"A9iyQurbMl"}],"key":"WdfCvXdSYw"}],"key":"ryXh8hHx3c"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Confusion Matrix: Random Forest Performance on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s8U9SvTxOC"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pVwxDD8V6d"}],"key":"g1dT3Xpupg"},{"type":"text","value":" Bloom Forecasting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yxgtoqlLMj"}],"identifier":"confusion-matrix-random-forest-performance-on-karenia-brevis-bloom-forecasting","label":"Confusion Matrix: Random Forest Performance on Karenia brevis Bloom Forecasting","html_id":"confusion-matrix-random-forest-performance-on-karenia-brevis-bloom-forecasting","implicit":true,"key":"POpH9tZ5zQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The confusion matrix visually represents the performance of your machine learning classification model—in this case, the Random Forest classifier used to predict ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rmAzq20RMR"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xdc5xB2l9w"}],"key":"SXIBaVBc2M"},{"type":"text","value":" bloom severity. A confusion matrix summarizes the number of correct and incorrect predictions, broken down by each class (“No Bloom” and “Bloom”).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wGt0Klmpef"}],"key":"FzTRJE8hra"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The confusion matrix has four key components:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YvFHRrRmpj"}],"key":"VnWLlfRHAe"},{"type":"table","position":{"start":{"line":7,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"EVsDl0IT53"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Predicted No Bloom","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"lYdJwkmz65"}],"key":"EkTfzfIozH"},{"type":"tableCell","header":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Predicted Bloom","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IeU0V4WnZ6"}],"key":"kfOZ1D6moA"}],"key":"gy3QB48tma"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Actual No Bloom","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TiDlr0biKr"}],"key":"lIV2eViJi3"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"True Negative (TN) – 165","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nTYMyqiumr"}],"key":"zpMstBMcbi"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"False Positive (FP) – 7","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LY6dpyoIGu"}],"key":"MRlUUK1dpA"}],"key":"o9XU9ioS1W"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Actual Bloom","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XO1XH4S5NC"}],"key":"VHOmVQrUpY"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"False Negative (FN) – 18","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ms87HkuYch"}],"key":"Fip2n8X251"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"True Positive (TP) – 69","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"RMesEXTmZQ"}],"key":"W9Y6pdBhth"}],"key":"Cq36iS5gE3"}],"key":"AXQBeVN5AK"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"True Negative (TN) = 165","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Itoj3rop3D"}],"key":"RhqbHYnFEN"}],"key":"HWxqYIq94u"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The model correctly predicted “No Bloom” when there was actually no bloom.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"cccDKaGqtx"}],"key":"tg4HxwcQ9w"}],"key":"rVKZ2OoDp6"}],"key":"rPAdNvhqsy"}],"key":"xuXiF723gx"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"False Positive (FP) = 7","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"d1vXIZVOvf"}],"key":"G9Qh2q3bzu"}],"key":"KYjKh5NDDN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The model predicted “Bloom” when there was actually no bloom (a false alarm).","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"TPYizZBw0J"}],"key":"yO19gsWwhQ"}],"key":"Mt6L2HULww"}],"key":"VTqwAgEz89"}],"key":"hWHXVbuHmq"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"False Negative (FN) = 18","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"wXGQqLe5x7"}],"key":"UG3mX5u8jn"}],"key":"H4TQiKmaJ7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The model predicted “No Bloom” when there was actually a bloom (a missed bloom event).","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"msZElFb4ne"}],"key":"GDXzA0GRGI"}],"key":"SbLvIp28BS"}],"key":"Hw0r2ux2gB"}],"key":"rPDmJdSjKa"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"True Positive (TP) = 69","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"YKbdHQfjZs"}],"key":"aP7bGnQ6pD"}],"key":"eoDdscUKx7"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The model correctly predicted “Bloom” when there was actually a bloom.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"iZ4wZ1fcgg"}],"key":"tocUXxsGpg"}],"key":"tfTToF3HDu"}],"key":"lAG250W3W9"}],"key":"bQWjEpQk2r"}],"key":"TYfggFvzWG"},{"type":"heading","depth":6,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Key Metrics Derived from the Confusion Matrix:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"y2VKJEswJo"}],"identifier":"key-metrics-derived-from-the-confusion-matrix","label":"Key Metrics Derived from the Confusion Matrix:","html_id":"key-metrics-derived-from-the-confusion-matrix","implicit":true,"key":"H2ZYhdj7t8"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Accuracy","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"Jm7ZmV6uPm"}],"key":"Gz8gn489ay"},{"type":"text","value":" – Measures the overall percentage of correct predictions:","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"xVpxos9XJ0"}],"key":"gc7YLnrP2i"},{"type":"math","value":"\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN} = \\frac{69 + 165}{69 + 165 + 7 + 18} = \\frac{234}{259} \\approx 0.90 \\quad (90\\%)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"tight":"before","html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eAccuracy\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eN\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eN\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmi\u003eN\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmn\u003e69\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e165\u003c/mn\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e69\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e165\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e7\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e18\u003c/mn\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e234\u003c/mn\u003e\u003cmn\u003e259\u003c/mn\u003e\u003c/mfrac\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmn\u003e0.90\u003c/mn\u003e\u003cmspace width=\"1em\"/\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e90\u003c/mn\u003e\u003cmi mathvariant=\"normal\"\u003e%\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Accuracy} = \\frac{TP + TN}{TP + TN + FP + FN} = \\frac{69 + 165}{69 + 165 + 7 + 18} = \\frac{234}{259} \\approx 0.90 \\quad (90\\%)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eAccuracy\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.1297em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3603em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eTN\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eFP\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eFN\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eTN\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e69\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e165\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e7\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e18\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e69\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e165\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e259\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e234\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.686em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.90\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:1em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e90%\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"1","key":"EwTxKUiy0L"}],"key":"RwwS9cA3m5"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Precision","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"s34E14MsoZ"}],"key":"dWpy38sdrG"},{"type":"text","value":" – Measures how many of the predicted positive cases (blooms) were actually correct:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"D9xBgXpCDz"}],"key":"udgLbocsqo"},{"type":"math","value":"\\text{Precision} = \\frac{TP}{TP + FP} = \\frac{69}{69 + 7} \\approx 0.91 \\quad (91\\%)","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"tight":"before","html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003ePrecision\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e69\u003c/mn\u003e\u003cmrow\u003e\u003cmn\u003e69\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e7\u003c/mn\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmn\u003e0.91\u003c/mn\u003e\u003cmspace width=\"1em\"/\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e91\u003c/mn\u003e\u003cmi mathvariant=\"normal\"\u003e%\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Precision} = \\frac{TP}{TP + FP} = \\frac{69}{69 + 7} \\approx 0.91 \\quad (91\\%)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ePrecision\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.1297em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3603em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eFP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e69\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e7\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e69\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.91\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:1em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e91%\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"2","key":"R2fo5mUjqE"}],"key":"QYcIWuMH7K"}],"key":"Qgh2OB5Wwz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"High precision means fewer false positives (the model doesn’t incorrectly predict blooms very often).","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ffzbAg1XPH"}],"key":"YtRp14J4Ra"}],"key":"y8GfRoLuBs"}],"key":"r3BnhFzNkz"},{"type":"list","ordered":true,"start":3,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Recall (Sensitivity or True Positive Rate)","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"ho6myP28ZB"}],"key":"fWub5lxN3k"},{"type":"text","value":" – Measures how many of the actual positive cases (blooms) were correctly identified:\n","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"SXf6KOuJU7"}],"key":"M44m3YPBrz"},{"type":"math","value":"\\text{Recall} = \\frac{TP}{TP + FN} = \\frac{69}{69 + 18} \\approx 0.79 \\quad (79\\%)","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eRecall\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmi\u003eN\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmn\u003e69\u003c/mn\u003e\u003cmrow\u003e\u003cmn\u003e69\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e18\u003c/mn\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmn\u003e0.79\u003c/mn\u003e\u003cmspace width=\"1em\"/\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e79\u003c/mn\u003e\u003cmi mathvariant=\"normal\"\u003e%\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Recall} = \\frac{TP}{TP + FN} = \\frac{69}{69 + 18} \\approx 0.79 \\quad (79\\%)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eRecall\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.1297em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3603em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eFN\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e69\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e18\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e69\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.79\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:1em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e79%\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"3","key":"bLqstK75VU"}],"key":"kTet6VeqvU"}],"key":"reJdWv7M6Y"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"High recall means the model catches most of the bloom events.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"EcOLTPWQKf"}],"key":"MoNLYUXrqZ"}],"key":"CtQ4tnOO6z"}],"key":"pMsxvzgwhw"},{"type":"list","ordered":true,"start":4,"spread":false,"position":{"start":{"line":39,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"F1-Score","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"E8k8E7MVdG"}],"key":"cWpmlw8iOk"},{"type":"text","value":" – The harmonic mean of precision and recall; it balances the trade-off between precision and recall:\n","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"fhLFd9BN3D"}],"key":"wkefigKrln"},{"type":"math","value":"\\text{F1} = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} = 2 \\cdot \\frac{0.91 \\cdot 0.79}{0.91 + 0.79} \\approx 0.85 \\quad (85\\%)","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eF1\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmtext\u003ePrecision\u003c/mtext\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmtext\u003eRecall\u003c/mtext\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmtext\u003ePrecision\u003c/mtext\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmtext\u003eRecall\u003c/mtext\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmn\u003e0.91\u003c/mn\u003e\u003cmo\u003e⋅\u003c/mo\u003e\u003cmn\u003e0.79\u003c/mn\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmn\u003e0.91\u003c/mn\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmn\u003e0.79\u003c/mn\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003cmo\u003e≈\u003c/mo\u003e\u003cmn\u003e0.85\u003c/mn\u003e\u003cmspace width=\"1em\"/\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmn\u003e85\u003c/mn\u003e\u003cmi mathvariant=\"normal\"\u003e%\u003c/mi\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{F1} = 2 \\cdot \\frac{\\text{Precision} \\cdot \\text{Recall}}{\\text{Precision} + \\text{Recall}} = 2 \\cdot \\frac{0.91 \\cdot 0.79}{0.91 + 0.79} \\approx 0.85 \\quad (85\\%)\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eF1\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.1408em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3714em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ePrecision\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eRecall\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ePrecision\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eRecall\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6444em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e2\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3214em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0.91\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.79\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord\"\u003e0.91\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e⋅\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.79\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e≈\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e0.85\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:1em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord\"\u003e85%\u003c/span\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"4","key":"xgomYFduEv"}],"key":"tlfn1OUf8x"}],"key":"sJ8Qb4fT1w"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A high F1-score means the model achieves a good balance between precision and recall.","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"mrd92Brieo"}],"key":"FVdxy8iT41"}],"key":"BawkG2R7MN"}],"key":"NGMuxIFeWY"},{"type":"list","ordered":true,"start":5,"spread":false,"position":{"start":{"line":45,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":45,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Support","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"zb4Uw6KDZR"}],"key":"hEaBWjslBF"},{"type":"text","value":" – The number of actual samples in each class:","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"UmwrgjKoea"}],"key":"K3ik11qp0U"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":46,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"No Bloom: 172 total instances","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"wWMWO3hvps"}],"key":"tUvqEchpDl"}],"key":"xaZbOtetBd"},{"type":"listItem","spread":true,"position":{"start":{"line":47,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bloom: 87 total instances","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"i5JBCxgulm"}],"key":"CwsuBaHjkF"}],"key":"E8jCLb5Tkp"}],"key":"tiXEi5dcVb"}],"key":"Abzcslq4aS"}],"key":"FZAbElfw5i"},{"type":"heading","depth":6,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"Summary of Model Performance:","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"Q9XoOY8YXT"}],"identifier":"summary-of-model-performance","label":"Summary of Model Performance:","html_id":"summary-of-model-performance","implicit":true,"key":"WhiSezZdtq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":50,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The model correctly predicted 90% of the test samples (accuracy).","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"vRGKMZxq6c"}],"key":"hMMXAPfanf"}],"key":"oyTKBXfJf8"},{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It had a high precision of 91%, meaning it rarely issued false bloom alerts.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"iwoe3ar46m"}],"key":"p4WODw1d5J"}],"key":"icbUUMlNWp"},{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The recall of 79% indicates that the model detected most bloom events and reduced false negatives compared to the baseline model.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"yZiGMSk733"}],"key":"gef7A9IRTL"}],"key":"pyiugnaDxS"},{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The F1-score of 85% reflects that the model maintains a strong balance between precision and recall.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"zNjwsUsZ5M"}],"key":"B0JlSUbilQ"}],"key":"D7UlpxwYjp"}],"key":"VvO4jFCkjw"},{"type":"heading","depth":6,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Conclusion:","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"NynlB6tgkL"}],"identifier":"conclusion","label":"Conclusion:","html_id":"conclusion","implicit":true,"key":"gaAmBZVIGI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":56,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The model demonstrates strong performance in predicting ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Pwdwlmj7Rh"},{"type":"emphasis","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"YJWEZXxt6T"}],"key":"rhlyPzi004"},{"type":"text","value":" bloom conditions using the enhanced dataset that includes Tampa KB values.","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Saz21N3xYV"}],"key":"CEdKnQ5dXD"}],"key":"ZBLItS1F7l"},{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The increase in recall and F1-score over the original SWFL-only model suggests that the additional data improved bloom detection.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"w3grwGTgRB"}],"key":"doZBFj7TwB"}],"key":"n3loQ2U137"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Continued feature refinement or threshold tuning may help push recall even higher while maintaining precision.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"NKr06JLFkN"}],"key":"n8ZXq6n59h"}],"key":"xT2gqdUP6W"}],"key":"kJgru6DObB"}],"key":"HLeQIBTQzI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.2 Precision-Recall Curve","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"twZqVw7n7H"}],"identifier":"id-2-2-precision-recall-curve","label":"2.2 Precision-Recall Curve","html_id":"id-2-2-precision-recall-curve","implicit":true,"key":"WvAkS2M1eb"}],"key":"RF7TWjWrU3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"his is a Precision-Recall (PR) Curve, which illustrates the trade-off between precision and recall at different classification thresholds for the Random Forest model trained on the combined Southwest Florida dataset (Peace River + Caloosahatchee River).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xy37dmttjc"}],"key":"qcXj15aZ9z"},{"type":"heading","depth":5,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"What the PR Curve Represents:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VugIcHpEFE"}],"identifier":"what-the-pr-curve-represents","label":"What the PR Curve Represents:","html_id":"what-the-pr-curve-represents","implicit":true,"key":"CkpwEJ44xc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Precision (Y-axis)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"F2mzXIccoR"}],"key":"VbUTDpvKGC"},{"type":"text","value":" = The proportion of predicted positive cases that are truly positive:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"XFwYvibkLT"}],"key":"xtuHLZKcMK"},{"type":"math","value":"\\text{Precision} = \\frac{TP}{TP + FP}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"tight":"before","html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003ePrecision\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Precision} = \\frac{TP}{TP + FP}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6833em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003ePrecision\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.1297em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3603em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eFP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"5","key":"VxYAtTu9oY"}],"key":"Zb8c5uDrBU"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Recall (X-axis)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hOh0afO7QF"}],"key":"hTnUP6k2ow"},{"type":"text","value":" = The proportion of actual positive cases that are correctly predicted:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sFgklweS9G"}],"key":"DX05Cy1goE"},{"type":"math","value":"\\text{Recall} = \\frac{TP}{TP + FN}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"tight":"before","html":"\u003cspan class=\"katex-display\"\u003e\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003eRecall\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmfrac\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003c/mrow\u003e\u003cmrow\u003e\u003cmi\u003eT\u003c/mi\u003e\u003cmi\u003eP\u003c/mi\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmi\u003eF\u003c/mi\u003e\u003cmi\u003eN\u003c/mi\u003e\u003c/mrow\u003e\u003c/mfrac\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{Recall} = \\frac{TP}{TP + FN}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:0.6944em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003eRecall\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:2.1297em;vertical-align:-0.7693em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mopen nulldelimiter\"\u003e\u003c/span\u003e\u003cspan class=\"mfrac\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:1.3603em;\"\u003e\u003cspan style=\"top:-2.314em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.10903em;\"\u003eFN\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.23em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"frac-line\" style=\"border-bottom-width:0.04em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-3.677em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\"\u003e\u003cspan class=\"mord mathnormal\" style=\"margin-right:0.13889em;\"\u003eTP\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7693em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose nulldelimiter\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","enumerator":"6","key":"mzmk9swmg8"}],"key":"dzbjZHpEMp"}],"key":"bqHmRlzA7U"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"The PR curve evaluates the model’s performance across a range of thresholds, showing how precision changes as recall increases. High recall means the model captures more true blooms but may increase false positives, lowering precision. Conversely, high precision means fewer false alarms but may miss some bloom events.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"LVnvh9sA1u"}],"key":"g9vFLBUUSO"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"In this model, the classifier maintains strong precision (~0.91) even as recall increases toward 0.79 — demonstrating the model’s ability to detect true bloom events while minimizing false alarms. A notable drop in precision occurs only at the highest recall levels (\u003e0.90), indicating that aggressively trying to catch every bloom comes at the cost of including more false positives — a common trade-off in environmental risk forecasting.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Je45pOBgzR"}],"key":"nd5KGWMxaj"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"This curve aligns with the model’s ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"dzSLrfAJ7R"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"F1-score of 85%","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"jJ9HwfyR8U"}],"key":"SPNpnV0L6o"},{"type":"text","value":" and ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"gkowT8vMzf"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"balanced accuracy of 87.6%","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"LNIqOzacde"}],"key":"CsGNvLr5S0"},{"type":"text","value":", both of which reflect improved predictive strength compared to the baseline model. The curve suggests that the model balances bloom sensitivity and specificity effectively under the default threshold. Depending on monitoring goals, the classification threshold can be adjusted to prioritize early detection (higher recall) or conservative alerts (higher precision). The ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"XxkqC3tLjN"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"F1-score","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Yhu4ht7JBG"}],"key":"VeJskiVjgP"},{"type":"text","value":" or the ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"gkgaiZQtSX"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"area under the precision-recall curve (PR AUC)","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"jZllOh1nDG"}],"key":"I8G4C239ef"},{"type":"text","value":" can help guide optimal threshold selection for operational use.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"nsXFUlSSnz"}],"key":"J2KKA5x8td"}],"key":"vieKLnq6AG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.metrics import precision_recall_curve\nimport matplotlib.pyplot as plt\nimport os\n\n# Optional: save to your custom graphics folder\ngraphics_dir = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\"\nos.makedirs(graphics_dir, exist_ok=True)\n\n# Compute precision and recall\nprecision, recall, _ = precision_recall_curve(y_test, rf_clf.predict_proba(X_test_scaled)[:, 1])\n\n# Plot PR curve\nplt.figure(figsize=(8, 6))\nplt.plot(recall, precision, marker='.', linewidth=1.5)\nplt.xlabel('Recall', fontsize=12)\nplt.ylabel('Precision', fontsize=12)\nplt.grid(True)\n\n# Save plot\nplt.savefig(os.path.join(graphics_dir, \"PR_curve_SWFL_Tampa.png\"), dpi=300, bbox_inches='tight')\nplt.show()","key":"WXSANyPEgq"},{"type":"outputs","id":"8nMWzKd909ysqMq8P-ktN","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-02-53.png\n"},"children":[],"key":"QKPalztae2"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dd562a68562632a420fcfedbce3aaf71","path":"/red-tide-book//build/dd562a68562632a420fcfedbce3aaf71.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"xxWK85qEgA"}],"key":"w67VvOOiY5"}],"key":"pD1ToY5ZvZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.3 Feature Importance Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UqfUoWJUzw"}],"identifier":"id-2-3-feature-importance-plot","label":"2.3 Feature Importance Plot","html_id":"id-2-3-feature-importance-plot","implicit":true,"key":"Zdf96vOSJ9"}],"key":"uHxPCCl0Gg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The plot from the Random Forest Classifier shows the relative contribution of each input feature to predicting ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ULy7q6AYy9"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WaPyjxQZwj"}],"key":"L0phGMmUrd"},{"type":"text","value":" bloom severity. Feature importance reflects how much each feature reduces classification error, based on improvements in the Gini index across all decision trees in the ensemble.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qjskA6JrNj"}],"key":"rN51ovjk7D"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e13SBQeGzb"}],"key":"bACqQmKxv4"},{"type":"text","value":" cell counts (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jlRf8hke3x"},{"type":"inlineCode","value":"kb","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"k5p6tvNb3y"},{"type":"text","value":") remain the most dominant predictor, with lagged values (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X00S7aZIR6"},{"type":"inlineCode","value":"kb_prev2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rc6E3WXd0I"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wbsuT6H8ib"},{"type":"inlineCode","value":"kb_prev1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gBrEdiazdb"},{"type":"text","value":") also ranking near the top. This highlights the strong short-term autocorrelation of bloom conditions — a bloom this week is highly predictive of bloom presence in the near future.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bwiC18IwBc"}],"key":"fPVUimOkRf"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Discharge dynamics, especially the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QcEAILabKm"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"4-week rolling average","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cn6Ls3SGD4"}],"key":"fJcn8XlhAi"},{"type":"text","value":" (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bd2aWRsmm5"},{"type":"inlineCode","value":"discharge_4w_avg","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mGiEa4G5xd"},{"type":"text","value":") and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CFqb9NSq51"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"lagged Peace River discharge","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cQEYlQavDX"}],"key":"WasKxpWZt7"},{"type":"text","value":" (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BH0qzIpZ8o"},{"type":"inlineCode","value":"peace_discharge_prev1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tspoCo9MQ9"},{"type":"text","value":"), continue to be important secondary contributors. Nutrient inputs — including ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hkfnuHy71N"},{"type":"inlineCode","value":"peace_TN_prev1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kwT9aREvod"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"b5sRm7dSA6"},{"type":"inlineCode","value":"caloosa_TN_prev1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CNYDxx6Re5"},{"type":"text","value":", and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"picx8gJc8Y"},{"type":"inlineCode","value":"caloosa_total_phosphorus","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jFCB9qtmQ4"},{"type":"text","value":" — also influence bloom status, supporting the hypothesis that nitrogen and phosphorus availability play a key role in bloom maintenance and short-term intensification.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ntBpLF5cYo"}],"key":"W3LRWziQYq"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Oceanographic variables such as ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"w4Ys9RW1Xu"},{"type":"inlineCode","value":"zos","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yPz1C2QHVu"},{"type":"text","value":" (sea level anomaly) and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"e2Ge4yo9IU"},{"type":"inlineCode","value":"water_temp","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"i7gvaUczty"},{"type":"text","value":" show modest importance, while ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"mPI8Lw6tEh"},{"type":"inlineCode","value":"salinity","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dNSPlWbAOp"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Qaw6jimnC4"},{"type":"inlineCode","value":"wind_speed","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Vv7JiJhBGV"},{"type":"text","value":", and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XUKYqz2NkV"},{"type":"inlineCode","value":"wind_direction","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RQsWzZHjHh"},{"type":"text","value":" contribute less overall. These likely represent more variable or indirect effects on bloom behavior (e.g., transport, mixing).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GC5YefZPLU"}],"key":"Wyqg8I5sZY"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"These results reinforce that the strongest bloom predictors are recent KB levels, followed by discharge and nutrient signals — while atmospheric and oceanic conditions provide supporting context in bloom forecasting.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jghAhFKajZ"}],"key":"BolI3UNvi5"}],"key":"uZzZwjYTkj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport os\n\n# Get feature importances from the trained RF model\nimportances = rf_clf.feature_importances_\n\n# Sort feature indices from most to least important\nindices = np.argsort(importances)[::-1]\n\n# Optional: Save to your custom graphics directory\ngraphics_dir = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\"\nos.makedirs(graphics_dir, exist_ok=True)\n\n# Plot feature importance\nplt.figure(figsize=(12, 6))\nplt.bar(range(X_train.shape[1]), importances[indices], align=\"center\")\nplt.xticks(range(X_train.shape[1]), [feature_cols[i] for i in indices], rotation=90)\nplt.tight_layout()\n\n# Save figure\nplt.savefig(os.path.join(graphics_dir, \"feature_importances_SWFL_Tampa.png\"), dpi=300, bbox_inches=\"tight\")\nplt.show()","key":"NBSwLv26Mu"},{"type":"outputs","id":"Sgxkx7HXF38FKxvW0jMzs","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-02-53.png\n"},"children":[],"key":"tZpA9x20vW"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7d8361c3dafcad15c07c6644f4d67b45","path":"/red-tide-book//build/7d8361c3dafcad15c07c6644f4d67b45.png"},"text/plain":{"content":"\u003cFigure size 1200x600 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"h426HRlkSD"}],"key":"lhyWxTwy3z"}],"key":"lMxtRK14FI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.4 Partial Dependence Plots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rIFPbn8WfU"}],"identifier":"id-2-4-partial-dependence-plots","label":"2.4 Partial Dependence Plots","html_id":"id-2-4-partial-dependence-plots","implicit":true,"key":"UUbL5vd4Eo"}],"key":"AhoJKAkM5w"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Partial dependence plots (PDPs) illustrate how predicted ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qNJoAE0sdB"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eov4zynoQz"}],"key":"fII5m0uBVV"},{"type":"text","value":" bloom probabilities respond to changes in river discharge and nutrient concentrations from both the Peace and Caloosahatchee Rivers, while holding all other variables constant. The y-axis represents the model’s predicted bloom probability, and the x-axis shows the standardized values of each input feature.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qo3s9stibw"}],"key":"gVqkIbFskR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For both ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mBvDXzdgQo"},{"type":"inlineCode","value":"peace_discharge","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sIJjv51Q4A"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"if5N6PyXOz"},{"type":"inlineCode","value":"caloosa_discharge","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hq5AaKgJPB"},{"type":"text","value":", bloom probability increases sharply from low to moderate discharge values and then flattens out. This suggests that moderate freshwater inflows may promote bloom persistence or nutrient delivery, while higher discharge may not further increase bloom probability — potentially due to dilution or reduced residence time.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mlKZDUh5oN"}],"key":"CfUVfSZRlq"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Nutrient variables show more varied but similarly nonlinear behavior. For example, ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DiSnJaNzLn"},{"type":"inlineCode","value":"peace_TN","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fPFbOEnYBP"},{"type":"text","value":" and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oAgZ415KhT"},{"type":"inlineCode","value":"caloosa_total_nitrogen","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gJe9b6x1FY"},{"type":"text","value":" are both associated with increasing bloom probability up to a threshold (~2–3 mg/L), after which the effect plateaus. This indicates a possible nitrogen saturation point, beyond which blooms are no longer limited by nitrogen availability.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Pfsrlry3Sc"}],"key":"iAtrDLLYk6"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Phosphorus variables — ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vOYhmUWTno"},{"type":"inlineCode","value":"peace_TP","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"fJ8FtwNdL8"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"G7UHMFeLmz"},{"type":"inlineCode","value":"caloosa_total_phosphorus","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ysm9AngySw"},{"type":"text","value":" — follow the same pattern: steep initial increases in bloom probability at low phosphorus concentrations, followed by tapering or even a gradual decline beyond ~1.5 mg/L. This may reflect a stoichiometric imbalance or ecological thresholds where additional phosphorus no longer promotes bloom activity.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"p0zt9gTSPu"}],"key":"FJcSxLAhWb"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The clustering of tick marks along the lower end of the x-axes indicates that most training data points fall within those value ranges, reinforcing that model predictions are more reliable there. These PDPs collectively show that bloom risk is most sensitive to moderate discharge and nutrient conditions, consistent with ecological dynamics of nutrient triggering, hydrologic influence, and possible saturation effects in bloom formation.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"rz1UwAiz4R"}],"key":"wDlNffbIha"}],"key":"txQl4GhvxZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.inspection import PartialDependenceDisplay\nimport matplotlib.pyplot as plt\nimport os\n\n# Ensure output directory exists\ngraphics_dir = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\"\nos.makedirs(graphics_dir, exist_ok=True)\n\n## Select features to plot\nselected_features = [\n    feature_cols.index('peace_discharge'),\n    feature_cols.index('peace_TN'),\n    feature_cols.index('peace_TP'),\n    feature_cols.index('caloosa_discharge'),\n    feature_cols.index('caloosa_total_nitrogen'),\n    feature_cols.index('caloosa_total_phosphorus')\n]\n\n# Create PDP plots\nfig, ax = plt.subplots(nrows=2, ncols=3, figsize=(12, 6))\n\nPartialDependenceDisplay.from_estimator(\n    rf_clf,\n    X_train_scaled,\n    features=selected_features,\n    feature_names=feature_cols,\n    grid_resolution=50,\n    ax=ax\n)\n\n# Adjust layout to avoid cutoff \u0026 save\nplt.tight_layout(pad=2.0)\nplt.savefig(os.path.join(graphics_dir, \"partial_dependence_SWFL_Tampa.png\"), dpi=300, bbox_inches='tight')\nplt.show()","key":"qgQl5gyDRn"},{"type":"outputs","id":"qUxxYes02ijYEklG-xVXx","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-03-00.png\n"},"children":[],"key":"nX7ReuVSO3"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2ff30bc0bd6ce10193e61c35dcee1b6e","path":"/red-tide-book//build/2ff30bc0bd6ce10193e61c35dcee1b6e.png"},"text/plain":{"content":"\u003cFigure size 1200x600 with 6 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"BrqhksBgHV"}],"key":"G2xAaw1Fsf"}],"key":"uH3eo9cwFq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.5 Actual Vs. Predicted Bloom","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qw7SXnBYvP"}],"identifier":"id-2-5-actual-vs-predicted-bloom","label":"2.5 Actual Vs. Predicted Bloom","html_id":"id-2-5-actual-vs-predicted-bloom","implicit":true,"key":"QuRo75wj3e"}],"key":"rwElpRMRhP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This figure shows the actual vs. predicted ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R9ynw9FwnU"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QUvM9CbYSF"}],"key":"QdKAeFtXTx"},{"type":"text","value":" bloom status over time for the updated model that incorporates Tampa-area KB data into the Southwest Florida (SWFL) system. The model’s predictions (red dashed line) align closely with observed bloom events (blue line), capturing both the onset and duration of bloom episodes with high temporal fidelity.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yFzYAiZ9eZ"}],"key":"VB6r8YMX6x"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The model slightly underpredicts bloom persistence in a few intervals — where actual bloom duration extends beyond predicted — but overprediction is minimal. In most cases, the model accurately identifies bloom start dates and avoids premature false positives. Compared to the baseline model, this updated version demonstrates improved alignment with observed blooms and fewer lagging or premature activations.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kJxbnASumy"}],"key":"iwlgfQMfV8"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"These results indicate that incorporating KB data from Tampa enhances the model’s ability to learn bloom dynamics across the region. The consistent agreement between actual and predicted time series confirms that the model captures short-term bloom memory and seasonal signals effectively, suggesting it is well-suited for real-time bloom surveillance and early warning applications in multi-basin systems like SWFL.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xFSMeBdaBa"}],"key":"VqhYOeeAer"}],"key":"seGdMU8j1e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport os\nimport pandas as pd\n\n# Ensure output folder exists\noutput_dir = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\"\nos.makedirs(output_dir, exist_ok=True)\n\n# Create DataFrame to hold test results\ntest_df = pd.DataFrame({\n    'time': X_test.index,  # assumes X_test is indexed by time\n    'Actual': y_test,\n    'Predicted': y_pred\n})\n\n# Sort by time for plotting\ntest_df = test_df.sort_values('time')\n\n# Plot actual vs predicted bloom status\nplt.figure(figsize=(12, 6))\nplt.plot(test_df['time'], test_df['Actual'], label='Actual', color='blue')\nplt.plot(test_df['time'], test_df['Predicted'], label='Predicted', color='red', linestyle='--')\nplt.xlabel('Time')\nplt.ylabel('Bloom Status')\nplt.legend()\nplt.tight_layout()\n\n# Save updated figure\nplt.savefig(os.path.join(output_dir, 'actual_predicted_SWFL_Tampa.png'), dpi=300, bbox_inches='tight')\nplt.show()","key":"PCKauELf4j"},{"type":"outputs","id":"8RUSKUGCFhIUZWXmP_5YO","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-03-01.png\n"},"children":[],"key":"sJhXU0AWBF"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"42568d5a5579e83c5fe6248ce098ebf4","path":"/red-tide-book//build/42568d5a5579e83c5fe6248ce098ebf4.png"},"text/plain":{"content":"\u003cFigure size 1200x600 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"wGLlQottkb"}],"key":"YZeKsiq0AQ"}],"key":"vxRzFLUgd8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.6 Learning Curve","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oSdMVcooAU"}],"identifier":"id-2-6-learning-curve","label":"2.6 Learning Curve","html_id":"id-2-6-learning-curve","implicit":true,"key":"YRsiNHDIXl"}],"key":"BjcMUUBGzZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The learning curve below illustrates the model’s performance as the training set size increases. It plots training accuracy (blue) and validation accuracy (orange) to help assess model generalization and overfitting behavior.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uT7uo7lShb"}],"key":"AYMvsNIptW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Training Score (Blue Line at 1.00)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TJspAoeEW7"}],"key":"SYJMGBeSnR"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nK5ZZgBxZ2"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PBuegRSpMp"},{"type":"text","value":"The model achieves ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ab0AmK2OrJ"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"perfect accuracy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QOKKBN8jha"}],"key":"IHPbD7OomS"},{"type":"text","value":" on the training set across all sample sizes, indicating potential ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uT1q75Lmdi"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"overfitting","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pfc557BKvC"}],"key":"fOIo3MJLIO"},{"type":"text","value":". This suggests the model memorizes the training data exceptionally well.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aUCHYcFLFV"}],"key":"mQzmcc0723"}],"key":"OAqUYjlY7E"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Validation Score (Orange Line)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"w9oAjqAbAM"}],"key":"se5N527XLy"},{"type":"text","value":":","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"GL0s823aw9"},{"type":"break","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lqbaG9SXDR"},{"type":"text","value":"Validation accuracy begins around ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"GKPu8AmnVr"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"0.72","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WLN6FHHvWf"}],"key":"If37FFp4jE"},{"type":"text","value":" and steadily increases, plateauing around ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"o0mDIYt3RE"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"0.84","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Qla5sPmN4a"}],"key":"RXGBIjsc3r"},{"type":"text","value":". This trend shows that the model generalizes better as more data becomes available and benefits from a larger training set.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Z9hjFcl24E"}],"key":"YAis3EEme0"}],"key":"ecT7M4FE5b"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Gap Between Training and Validation","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xNEsL5Xwzy"}],"key":"DPKRvXG8wn"},{"type":"text","value":":","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"p7GdBdE1Au"},{"type":"break","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yiR4LzOfcA"},{"type":"text","value":"The persistent gap between the training and validation scores highlights a ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"X280TnG9hZ"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"generalization gap","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CeJHUt9mym"}],"key":"L66KZWJGtc"},{"type":"text","value":". The model performs very well on seen data but does not achieve the same level of accuracy on unseen data.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ydWLDBhDFt"}],"key":"IAtwQcFcOV"}],"key":"VJBHPJIRdl"}],"key":"OgcijNQ99w"},{"type":"thematicBreak","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"F0Z4FUyTEL"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Interpretation","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"TfI5YmOclB"}],"key":"ktTTbMUKG8"}],"key":"iP3z0AGn0C"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The Random Forest model shows strong memorization capability but limited generalization, suggesting high model capacity.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"zFkDglp7sL"}],"key":"OjwznSfJFa"}],"key":"Ckafy2w8nK"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The plateau in validation performance (~84%) implies the model has learned most of the signal available in the data.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"LRIrGmURU5"}],"key":"CtTIFyMWd3"}],"key":"vuLbjDhBiF"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This learning curve confirms that while the model is accurate and stable, further refinements may enhance its robustness in operational bloom forecasting.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"NT1wfFbBOM"}],"key":"L9JuZIYSYO"}],"key":"XDCp0DQ2Mx"}],"key":"KotOJX0eVR"}],"key":"x0xjJZGPLx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import learning_curve\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport os\n\n# Create output directory if it doesn't exist\noutput_dir = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\"\nos.makedirs(output_dir, exist_ok=True)\n\n# Generate Learning Curve data\ntrain_sizes, train_scores, test_scores = learning_curve(\n    rf_clf,\n    X_train_scaled,\n    y_train,\n    cv=5,\n    scoring='accuracy',\n    n_jobs=-1,\n    train_sizes=np.linspace(0.1, 1.0, 10)\n)\n\n# Compute mean scores across folds\ntrain_mean = train_scores.mean(axis=1)\ntest_mean = test_scores.mean(axis=1)\n\n# Plot Learning Curve\nplt.figure(figsize=(8, 6))\nplt.plot(train_sizes, train_mean, label='Training Score', color='blue')\nplt.plot(train_sizes, test_mean, label='Validation Score', color='orange')\nplt.xlabel('Training Set Size')\nplt.ylabel('Accuracy')\nplt.legend()\nplt.grid(True)\nplt.tight_layout()\nplt.savefig(os.path.join(output_dir, 'learning_curve_SWFL_Tampa.png'), dpi=300, bbox_inches='tight')\nplt.show()","key":"qefShMR4qs"},{"type":"outputs","id":"cEFqdr7qebJVoPyVcW0dL","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-03-12.png\n"},"children":[],"key":"ty9dh2sN00"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a709a9320670d8b41088955a651f6f71","path":"/red-tide-book//build/a709a9320670d8b41088955a651f6f71.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"MkBUedyBRm"}],"key":"waqPHauJ7T"}],"key":"YZ1tx6VIL2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.7 Pair Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dX2rpdo1GE"}],"identifier":"id-2-7-pair-plot","label":"2.7 Pair Plot","html_id":"id-2-7-pair-plot","implicit":true,"key":"QVGjCkBC98"}],"key":"YNChJbBfhT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The pair plot below displays the relationships and distributions among ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tE7dMH2gUx"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rkU5KHrGsh"}],"key":"bmD2QG2J93"},{"type":"text","value":" cell concentrations (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MVbGO37Ioo"},{"type":"inlineCode","value":"kb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OB8F6gepPE"},{"type":"text","value":"), river discharge, and nutrient levels from both the Peace and Caloosahatchee Rivers using the updated dataset that includes Tampa KB data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bAbhPMe8CG"}],"key":"XgZOFnZ5fp"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"All nutrient and discharge variables continue to exhibit strong right-skewed distributions, with most values clustered at the low end and occasional extreme values. This reflects episodic nutrient surges and discharge events, which are typical of coastal watershed systems.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H2ZOirGSe3"}],"key":"jKv0bge7uj"}],"key":"Kt5vLO7IYy"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"While linear correlations between ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ExEYDNebVd"},{"type":"inlineCode","value":"kb","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"r4uCzjeMmX"},{"type":"text","value":" and other variables remain weak, the plot reveals key clustering patterns — particularly, higher ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"H8RO9BQuJd"},{"type":"inlineCode","value":"kb","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pRF20cQSnu"},{"type":"text","value":" values tend to coincide with moderate levels of river discharge (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Wzi6KRtLdp"},{"type":"inlineCode","value":"peace_discharge","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vST3eU4D8l"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZgnahRIt0k"},{"type":"inlineCode","value":"caloosa_discharge","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HfAJFEC5Ap"},{"type":"text","value":") and elevated nutrient concentrations (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mwP7QIlDtY"},{"type":"inlineCode","value":"peace_TN","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NNeO2myDSt"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rFSAzJLnJA"},{"type":"inlineCode","value":"caloosa_total_nitrogen","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nVZC3LiwXO"},{"type":"text","value":"), suggesting bloom activity may be triggered or sustained by these conditions.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Y2ld33EN0O"}],"key":"Kex8Mjnxxu"}],"key":"dCTxtL9YCT"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Nutrient distributions remain consistent between the two rivers, and both nitrogen and phosphorus variables show wide variability, reinforcing their role as co-drivers of bloom events. Notably, the inclusion of Tampa KB data does not introduce conflicting trends, indicating the broader regional coherence of bloom-nutrient-discharge relationships.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"YrJ3izsUBg"}],"key":"bGcKBQLJ22"}],"key":"fVG9iK6885"}],"key":"GyNYoAmgur"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"These patterns suggest that ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"L9t6U5V887"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZULBYKslbP"}],"key":"OLgZMU95oX"},{"type":"text","value":" bloom dynamics are governed by nonlinear, episodic processes involving both nutrient inputs and hydrological forcing from multiple rivers. The Tampa KB data strengthens the ecological signal, supporting the idea that spatially aggregated bloom data can still yield consistent and informative predictors of bloom risk.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nZW7ZYgOyT"}],"key":"bqvixAo9eL"}],"key":"FG0PPk6gJ9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport os\nimport pandas as pd\n\n# Load the merged SWFL + Tampa KB dataset\ndf_swfl_merged = pd.read_csv(\"swfl_merged_features_tampa.csv\")\n\n# Ensure figures folder exists\nos.makedirs(\"Figures\", exist_ok=True)\n\n# Select relevant variables for pair plot\npairplot_vars = [\n    'kb', 'peace_discharge', 'peace_TN', 'peace_TP',\n    'caloosa_discharge', 'caloosa_total_nitrogen', 'caloosa_total_phosphorus'\n]\n\n# Generate pair plot\nsns.pairplot(df_swfl_merged[pairplot_vars], diag_kind='kde')\nplt.savefig(\"Figures/pair_plot_SWFL_Tampa.png\", dpi=300, bbox_inches='tight')\nplt.show()","key":"D7qSeLKKY5"},{"type":"outputs","id":"1KyB-cCqyE0yMVECz3-Od","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-03-20.png\n"},"children":[],"key":"dZCvCVyVLA"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8a17e7e8cb1cb97cf5d7001b75595a72","path":"/red-tide-book//build/8a17e7e8cb1cb97cf5d7001b75595a72.png"},"text/plain":{"content":"\u003cFigure size 1750x1750 with 56 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"Htf6HSBOao"}],"key":"qAlPUDNhJN"}],"key":"pqAqsuyEMZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. XGBoost Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MSzqUI6OZS"}],"identifier":"id-3-xgboost-model","label":"3. XGBoost Model","html_id":"id-3-xgboost-model","implicit":true,"key":"L0lhtDJ3G5"}],"key":"V7XBq9iKWu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We implemented ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iWQcakcuU6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"XGBoost (Extreme Gradient Boosting)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UAaOGu3x8J"}],"key":"JMOJTUzxYk"},{"type":"text","value":" as an alternative machine learning model to predict harmful algal bloom (HAB) events one week in advance. XGBoost is a high-performance, tree-based algorithm known for its ability to model complex, nonlinear relationships in structured tabular data. It builds decision trees sequentially, with each new tree correcting the errors of the previous one — making it particularly effective for classification tasks.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xOe2d2G4Vo"}],"key":"l9N3ACoXOP"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We selected XGBoost because:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G8s0K75ddo"}],"key":"koXoBAVCN9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It handles ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"o06QT08435"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"imbalanced datasets","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"X3H5Mnm7S8"}],"key":"hhn7NOS6nx"},{"type":"text","value":" well using the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kmbzexjfJV"},{"type":"inlineCode","value":"scale_pos_weight","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZzA2ff0nGt"},{"type":"text","value":" parameter.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rjd8DHgT0t"}],"key":"QAZQKlCuMX"}],"key":"igvcwdVynx"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It often outperforms traditional methods like Random Forest in predictive accuracy when properly tuned.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nENEOsufiX"}],"key":"zZ3CJyvZbK"}],"key":"R35iIyHuX1"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It allows for ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vjGdL8FQmK"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"fine-grained control","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"yS3idHhY2e"}],"key":"U8EFaICMay"},{"type":"text","value":" over learning behavior and regularization to reduce overfitting.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gc8QzjQWHF"}],"key":"r7H3gwzvCf"}],"key":"CcOFUeDtYk"}],"key":"JB9Piovewd"}],"key":"GMumu1DyxB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Import necessary libraries\nfrom xgboost import XGBClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix, balanced_accuracy_score\nfrom sklearn.model_selection import train_test_split\n\n# Define feature columns and target\nfeatures = [\n    'kb', 'kb_prev1', 'kb_prev2',\n    'zos', 'salinity', 'water_temp',\n    'wind_speed', 'wind_direction',\n    'peace_discharge', 'peace_TN', 'peace_TP',\n    'peace_discharge_prev1', 'peace_TN_prev1', 'peace_TP_prev1',\n    'caloosa_discharge', 'caloosa_total_nitrogen', 'caloosa_total_phosphorus',\n    'caloosa_discharge_prev1', 'caloosa_TN_prev1', 'caloosa_TP_prev1',\n    'discharge_4w_avg'\n]\n\ntarget = 'target_next_week'\n\n# Split into train and test\nX = df[features]\ny = df[target]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)\n\n# Compute class weight ratio\nclass_weight_ratio = y_train.value_counts()[0] / y_train.value_counts()[1]\n\n# Initialize and fit XGBoost model\nxgb_model = XGBClassifier(\n    scale_pos_weight=class_weight_ratio,  # handle imbalance\n    n_estimators=100,\n    learning_rate=0.1,\n    max_depth=4,\n    use_label_encoder=False,\n    eval_metric='logloss',\n    random_state=42\n)\n\nxgb_model.fit(X_train, y_train)\n\n# Predict and evaluate\ny_pred = xgb_model.predict(X_test)\n\nprint(\"Balanced Accuracy:\", balanced_accuracy_score(y_test, y_pred))\nprint(\"Confusion Matrix:\\n\", confusion_matrix(y_test, y_pred))\nprint(\"Classification Report:\\n\", classification_report(y_test, y_pred, target_names=[\"No Bloom\", \"Bloom\"]))","key":"URTdwPMVfI"},{"type":"outputs","id":"ACsbqVPZchQ9uX6NGW5Yq","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Balanced Accuracy: 0.810064935064935\nConfusion Matrix:\n [[201  30]\n [ 23  69]]\nClassification Report:\n               precision    recall  f1-score   support\n\n    No Bloom       0.90      0.87      0.88       231\n       Bloom       0.70      0.75      0.72        92\n\n    accuracy                           0.84       323\n   macro avg       0.80      0.81      0.80       323\nweighted avg       0.84      0.84      0.84       323\n\n"},"children":[],"key":"YDb6j9X2JE"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\miniconda3\\Lib\\site-packages\\xgboost\\training.py:183: UserWarning: [18:03:26] WARNING: C:\\actions-runner\\_work\\xgboost\\xgboost\\src\\learner.cc:738: \nParameters: { \"use_label_encoder\" } are not used.\n\n  bst.update(dtrain, iteration=i, fobj=obj)\n"},"children":[],"key":"Kb0nQcTBHm"}],"key":"J0nXo46pYZ"}],"key":"TtY5txQXmb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"XGBoost Model Performance Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jmzsTSTDqL"}],"identifier":"xgboost-model-performance-summary","label":"XGBoost Model Performance Summary","html_id":"xgboost-model-performance-summary","implicit":true,"key":"NRizX7dQEL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The XGBoost classifier demonstrated solid performance in predicting ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sy4dbvcUgF"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kqhttesVU7"}],"key":"e6VXb1iK7U"},{"type":"text","value":" bloom events one week in advance using the Southwest Florida (SWFL) dataset with the inclusion of Tampa KB data. The model achieved an overall ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vOSS0h93Lr"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"accuracy of 84%","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qs6torS7Vj"}],"key":"reM4dTuK5T"},{"type":"text","value":" and a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eRVxfDpaWa"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"balanced accuracy of 81.0%","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IsgsGKJBNQ"}],"key":"GANhVpljJD"},{"type":"text","value":", indicating good predictive capability across both bloom and non-bloom classes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M5afTBYKFt"}],"key":"QtSsBOxvIr"},{"type":"thematicBreak","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wrOmE65Lv1"},{"type":"heading","depth":4,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Class-Specific Performance:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wwfdCsyfxD"}],"identifier":"class-specific-performance","label":"Class-Specific Performance:","html_id":"class-specific-performance","implicit":true,"key":"YJ26CiWyNH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"No Bloom:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"uFiYTKGDwy"}],"key":"iEy6c1vswJ"}],"key":"xpnN3tiF7X"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Precision: ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"rdHUpQKoEv"},{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"0.90","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"BoBiMkRVCY"}],"key":"wxDXiFAULj"}],"key":"GbpapWHPx8"}],"key":"qBkybLFVO6"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Recall: ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qFVj5YBaxG"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"0.87","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MLAFwkRqUg"}],"key":"DIiNcezwPZ"}],"key":"GOJmocihs5"}],"key":"aV81MHxjzH"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"F1-score: ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"mQNGdQ2XKk"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"0.88","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"bkVjyKMMXb"}],"key":"Jnxfl4p4ib"}],"key":"Rs3y7bFPJz"}],"key":"FgvmGWbpip"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Support: 231 samples","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"W6OijlZ6Ie"}],"key":"iwO0nG7ZM5"}],"key":"ZG3QL1TTvn"}],"key":"A5g8ARxp6w"}],"key":"fIxVqpdy7w"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Bloom:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Wr806PE2RE"}],"key":"gS486eiUuH"}],"key":"M5pSY0VzNw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Precision: ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"OsSgoglbeY"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"0.70","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"D4ZVAz6a5s"}],"key":"Eak4HDUW7J"}],"key":"HaMzBAXkZC"}],"key":"YfNBTu47GX"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Recall: ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"JajNd3wMK5"},{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"0.75","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"DJXRMhijyw"}],"key":"ZsvZMt3h0g"}],"key":"iYlixVaxaN"}],"key":"LZAvFRxV6u"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"F1-score: ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"G1BtAVabRM"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"0.72","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"DRG12VYXjh"}],"key":"MJBTKZkbZu"}],"key":"cHKCmblqgr"}],"key":"NIiWmvBO3c"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Support: 92 samples","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"gsPLn13cXl"}],"key":"CaHWfoEMUY"}],"key":"ljCj2Ge3S4"}],"key":"KgKpVzFXzy"}],"key":"TWNdl0a9km"}],"key":"NvYegkaTWV"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The classifier continues to perform well for ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"d7uPUSWjBJ"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"no-bloom predictions","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"UfQv69Kpdg"}],"key":"ojtYN95D6Y"},{"type":"text","value":", with high precision and recall. For bloom predictions, the model captures ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"AF9MNQRam4"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"75% of true bloom events","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"WovDgWWaln"}],"key":"oHtrAwhFna"},{"type":"text","value":", a slight drop from the Random Forest baseline but still effective for early-warning applications. The ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"uL8IznaeoL"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"precision of 0.70","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Is1vjksOZF"}],"key":"aP9R1bgg4v"},{"type":"text","value":" suggests moderate false positives, which may be acceptable depending on monitoring priorities.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"NmHur9Aqf8"}],"key":"eg6DHIo4cg"},{"type":"thematicBreak","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"mJXLWCJ8HM"},{"type":"heading","depth":4,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Overall Averages:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"m0rIQdNS6Q"}],"identifier":"overall-averages","label":"Overall Averages:","html_id":"overall-averages","implicit":true,"key":"STpDfeh3q6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Macro average F1-score:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"Kn1JACcDzf"}],"key":"HL5J8jq4X2"},{"type":"text","value":" ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"HCdcY6Kku2"},{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"0.80","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"FKETbbG2qK"}],"key":"uSbAKYxlh5"}],"key":"g6ImF2j0sc"}],"key":"WoKHZjPwJs"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Weighted average F1-score:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"E93mASvCOF"}],"key":"Zl4FKRvyQK"},{"type":"text","value":" ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"SQhTIgPpCM"},{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"0.84","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"To1FsiCcMe"}],"key":"I3qGyWxPWD"}],"key":"kP1fSgx8N4"}],"key":"PVMDKuzJxk"}],"key":"BO77DZqzQR"},{"type":"thematicBreak","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"pULK8wn6NY"},{"type":"heading","depth":4,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Confusion Matrix Summary:","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"MRJR9uBEkl"}],"identifier":"confusion-matrix-summary","label":"Confusion Matrix Summary:","html_id":"confusion-matrix-summary","implicit":true,"key":"dG2J7YmrPK"},{"type":"table","position":{"start":{"line":34,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[],"key":"CgbmwjVvuq"},{"type":"tableCell","header":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Predicted No Bloom","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"SzpnkSfYU7"}],"key":"DXYts0BXkD"},{"type":"tableCell","header":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Predicted Bloom","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"QHLWuB0cAN"}],"key":"Wznpb27s0l"}],"key":"Ri5FVFKJWc"},{"type":"tableRow","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Actual No Bloom","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"o9paE9ysL1"}],"key":"tn81ZuoVXP"}],"key":"L6PGeWjvZP"},{"type":"tableCell","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"201","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"LvSn6gE8iF"}],"key":"vQ9hTjZ3XZ"},{"type":"tableCell","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"30","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"VWhdVs65oP"}],"key":"fK0ouyGfJf"}],"key":"q5EBuA2Rxn"},{"type":"tableRow","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"strong","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Actual Bloom","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"YJevY29i13"}],"key":"SaTFNYlUbf"}],"key":"Jow0PlQf4A"},{"type":"tableCell","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"23","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"P34NmbiM3D"}],"key":"q7DpLroZ84"},{"type":"tableCell","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"69","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"bCfLfwT7Fl"}],"key":"aDV85I2X6w"}],"key":"QehmrCjwGH"}],"key":"KMUfwhhCD4"},{"type":"thematicBreak","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"qDIFocfw8L"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"These results suggest that the XGBoost model effectively captures bloom dynamics and offers a ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"NxoJ0m1JTb"},{"type":"strong","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"reasonable trade-off between recall and precision","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"CQ4CwNlR89"}],"key":"QMK89hnqMZ"},{"type":"text","value":", even without fine-tuned hyperparameters. Although it slightly underperforms compared to the best-performing Random Forest configuration, it remains ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"TEWVYQWYvW"},{"type":"strong","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"a reliable and interpretable model","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"FqJjNwFm2t"}],"key":"gOfev5T6dS"},{"type":"text","value":". With further tuning, XGBoost could become a strong operational forecasting tool for ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"mPTka5yKl4"},{"type":"emphasis","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"fMcmZTn7SA"}],"key":"rAtWgHF7Zs"},{"type":"text","value":" blooms in Southwest Florida.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"IbfYqgtHcr"}],"key":"yC71fq5g9E"}],"key":"fzTt1OPBm4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.1 Quick Hyperparameter Tuning with RandomizedSearchCV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uQGDRgqAch"}],"identifier":"id-3-1-quick-hyperparameter-tuning-with-randomizedsearchcv","label":"3.1 Quick Hyperparameter Tuning with RandomizedSearchCV","html_id":"id-3-1-quick-hyperparameter-tuning-with-randomizedsearchcv","implicit":true,"key":"uFOaiQWUh2"}],"key":"bOeQiwTGDi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To improve the performance of the XGBoost model, we performed a quick hyperparameter tuning using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vzCCcwCeoA"},{"type":"inlineCode","value":"RandomizedSearchCV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zbbUmHGvcC"},{"type":"text","value":". This approach samples a subset of possible parameter combinations rather than evaluating all combinations exhaustively. We used 20 random trials and 3-fold cross-validation to identify a better-performing configuration.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xTo9pH4rOQ"}],"key":"WYY3p07y6i"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The hyperparameters tested included tree depth, learning rate, number of estimators, and subsampling ratios. We maintained class imbalance handling by preserving the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e6neGFTEgn"},{"type":"inlineCode","value":"scale_pos_weight","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dYBeb1hINo"},{"type":"text","value":". The optimized model was then evaluated on the test set to assess whether it improved bloom prediction performance over the original configuration.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LTyQdnADvY"}],"key":"Hhy39ysuTw"}],"key":"A50uaZlekq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import RandomizedSearchCV\nfrom scipy.stats import randint, uniform\nimport numpy as np\n\n# Define parameter distribution\nparam_dist = {\n    'n_estimators': randint(50, 200),\n    'max_depth': randint(3, 10),\n    'learning_rate': uniform(0.01, 0.2),\n    'subsample': uniform(0.6, 0.4),\n    'colsample_bytree': uniform(0.6, 0.4),\n    'scale_pos_weight': [class_weight_ratio],  # already computed earlier\n}\n\n# Initialize base model\nxgb_base = XGBClassifier(\n    use_label_encoder=False,\n    eval_metric='logloss',\n    random_state=42\n)\n\n# Run randomized search (20 trials, 3-fold CV)\nrandom_search = RandomizedSearchCV(\n    estimator=xgb_base,\n    param_distributions=param_dist,\n    n_iter=20,\n    scoring='f1',\n    cv=3,\n    verbose=1,\n    random_state=42,\n    n_jobs=-1\n)\n\nrandom_search.fit(X_train, y_train)\n\n# Evaluate best model\nbest_xgb = random_search.best_estimator_\ny_pred_best = best_xgb.predict(X_test)\n\n# Output results\nprint(\"Best Parameters:\", random_search.best_params_)\nprint(\"Balanced Accuracy:\", balanced_accuracy_score(y_test, y_pred_best))\nprint(\"Confusion Matrix:\\n\", confusion_matrix(y_test, y_pred_best))\nprint(\"Classification Report:\\n\", classification_report(\n    y_test, y_pred_best, target_names=[\"No Bloom\", \"Bloom\"]))","key":"GjrCMEi0Q7"},{"type":"outputs","id":"QwlWjNx014Wu8immx0a7R","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Fitting 3 folds for each of 20 candidates, totalling 60 fits\nBest Parameters: {'colsample_bytree': np.float64(0.6353970008207678), 'learning_rate': np.float64(0.04919657248382905), 'max_depth': 3, 'n_estimators': 89, 'scale_pos_weight': np.float64(2.505434782608696), 'subsample': np.float64(0.9378135394712606)}\nBalanced Accuracy: 0.8242047807265198\nConfusion Matrix:\n [[200  31]\n [ 20  72]]\nClassification Report:\n               precision    recall  f1-score   support\n\n    No Bloom       0.91      0.87      0.89       231\n       Bloom       0.70      0.78      0.74        92\n\n    accuracy                           0.84       323\n   macro avg       0.80      0.82      0.81       323\nweighted avg       0.85      0.84      0.84       323\n\n"},"children":[],"key":"JvmXHoT9iL"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\miniconda3\\Lib\\site-packages\\xgboost\\training.py:183: UserWarning: [18:03:32] WARNING: C:\\actions-runner\\_work\\xgboost\\xgboost\\src\\learner.cc:738: \nParameters: { \"use_label_encoder\" } are not used.\n\n  bst.update(dtrain, iteration=i, fobj=obj)\n"},"children":[],"key":"SIyRdXSy0h"}],"key":"mkAJC63nMG"}],"key":"JrCgmTQNcS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.2 Summary XGBoost Before and After Hyperparameter Tuning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hk8K4SX9Jy"}],"identifier":"id-3-2-summary-xgboost-before-and-after-hyperparameter-tuning","label":"3.2 Summary XGBoost Before and After Hyperparameter Tuning","html_id":"id-3-2-summary-xgboost-before-and-after-hyperparameter-tuning","implicit":true,"key":"TEcDQIrrwv"}],"key":"bhlChG26Cg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We evaluated the performance of the default XGBoost model against a tuned version using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E8gDi4wrND"},{"type":"inlineCode","value":"RandomizedSearchCV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rMKgZKh6nW"},{"type":"text","value":". The tuned model yielded modest but meaningful improvements, particularly in detecting harmful algal blooms (the minority class).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HgpSBHVemR"}],"key":"oJjReGsZ0H"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Best Parameters Selected:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BJlMJROiuf"}],"key":"NEbN2Tp7M2"}],"key":"hsGdqIb5lD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"n_estimators","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Y1xAAZAdf5"},{"type":"text","value":": 89","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VK1H1g1bLV"}],"key":"Alee8CnbuY"}],"key":"gFKHkXJKmA"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"max_depth","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bgHL2oZy5K"},{"type":"text","value":": 3","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HXMWTD3mQh"}],"key":"uA17b9F486"}],"key":"W7cZMKbSgo"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"learning_rate","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YUoBQfEmWh"},{"type":"text","value":": 0.04","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"v7bhkYTVsc"}],"key":"J7fzOwKKT2"}],"key":"POihXfRR6O"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"subsample","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Vkjt9uXOSV"},{"type":"text","value":": 0.94","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UpKLb7OnK8"}],"key":"JlVKHwifkJ"}],"key":"MwqEWkNi49"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"colsample_bytree","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qiZSsnl3t7"},{"type":"text","value":": 0.63","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"MZWNBdMCxZ"}],"key":"G6uv2fYLas"}],"key":"nNktE5TI0w"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"scale_pos_weight","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"XVmPzLDQIe"},{"type":"text","value":": 2.52","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"A3qsLDE6U1"}],"key":"pSxVrB3wqM"}],"key":"LMGw9v0pPB"}],"key":"E9dXOnNtkc"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Key Improvements:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ecgRnnMfEG"}],"key":"KmStwMl3QS"}],"key":"GFTnqpM8b4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Balanced Accuracy","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"O0S2AjUvXM"}],"key":"Msk1yZz6XQ"},{"type":"text","value":" increased from ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"IBHbNHlqiE"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"0.810","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"krtaVOPFd2"}],"key":"fxJ4MHPmhP"},{"type":"text","value":" to ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pt8k6NqDeU"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"0.824","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"aAFblcjhst"}],"key":"kbXgJYHzHY"}],"key":"qzQm67hXWH"}],"key":"O8q2Hl49ce"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Bloom Recall","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"FCygiRLd7D"}],"key":"MNaGb6GhEf"},{"type":"text","value":" improved from ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"I1rN3b1YG6"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"0.75","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"J7LLLyMvhK"}],"key":"hZhSD034yB"},{"type":"text","value":" to ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZMlw6uEP6X"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"0.78","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"fQnJaLEneP"}],"key":"CABCfNw6YF"},{"type":"text","value":", meaning more actual blooms were correctly detected","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"hAWMJYf6ua"}],"key":"wCYnbhbX1Y"}],"key":"rItfcNa9uC"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Bloom F1-score","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mHMXkSf8AO"}],"key":"vz3PETMgs7"},{"type":"text","value":" rose from ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Fb9yASIm43"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"0.72","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"r20M7AKDsL"}],"key":"HxYWVFMF3R"},{"type":"text","value":" to ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ciN2m304Wz"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"0.74","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"vjbYw5m2QU"}],"key":"ya3lrlCoBv"},{"type":"text","value":", indicating a better balance between sensitivity and precision","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"EW6UYJm1uP"}],"key":"KsM6eRNmXq"}],"key":"fZ7uwyzLRk"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"False negatives (missed blooms)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"jCQLMySlLH"}],"key":"a2ikLBqC6Z"},{"type":"text","value":" decreased from ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xLBHgemuOt"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"23","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ShMlXY8Zaf"}],"key":"EKC2mTZUVE"},{"type":"text","value":" to ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"NP0eq2Kn6e"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"20","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wErFK5F0Nj"}],"key":"BqNwOOKQBL"}],"key":"WXY5iIWD3T"}],"key":"GDjCx7rwpa"}],"key":"OItZtddGwt"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Trade-offs:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ppyDt2xBSB"}],"key":"WQO13u5Zq2"}],"key":"sFMItEhfNX"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The number of ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"xhO5QsV0b0"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"false positives","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"AooypP48sT"}],"key":"yKkJlkmTR0"},{"type":"text","value":" (non-blooms predicted as blooms) increased slightly (from 30 to 31), but this is considered acceptable in the context of early-warning systems where missing a bloom is more detrimental than a false alert.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"anE5eBPWgh"}],"key":"bzwHS5QyRz"}],"key":"fbXthyWy3d"}],"key":"UHbykB9FKq"},{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Conclusion:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"lUrWwj3ZPM"}],"key":"zoKG64og1P"},{"type":"text","value":"\nHyperparameter tuning led to a slightly more balanced and sensitive XGBoost model for forecasting ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"paE2sjVQKx"},{"type":"emphasis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"OI7Vw9z3Qk"}],"key":"cqoq3gQ171"},{"type":"text","value":" bloom events. These adjustments improve early detection performance while maintaining overall robustness.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"GMLbLC27He"}],"key":"sOUMMJhGvr"}],"key":"MDfhkafzr8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3 Summary Tuned XGBoost vs. Random Forest","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ovDf1izDjD"}],"identifier":"id-3-3-summary-tuned-xgboost-vs-random-forest","label":"3.3 Summary Tuned XGBoost vs. Random Forest","html_id":"id-3-3-summary-tuned-xgboost-vs-random-forest","implicit":true,"key":"plSsg3JXRk"}],"key":"daN93XCdzQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We compared the performance of the tuned XGBoost model to the Random Forest model in predicting ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rtYSvRqTY4"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Karenia brevis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hO8SkRag5A"}],"key":"o2HmkzfPjI"},{"type":"text","value":" bloom events one week ahead. The results show that Random Forest clearly outperformed the tuned XGBoost model across most metrics, although XGBoost maintained a marginal advantage in reducing false negatives.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d3PE6yyUhv"}],"key":"CWTe5Iv9zm"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Performance Summary:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rMFeZeIaOi"}],"key":"qF7LVTV6pl"}],"key":"nKgsyQoAro"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Accuracy","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KMp4M3DCJ5"}],"key":"XzSaR1wYID"},{"type":"text","value":": Random Forest = 0.90, Tuned XGBoost = 0.86","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FXN5bzDNer"}],"key":"xxOrmtO07W"}],"key":"XZyGV3hfb8"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Balanced Accuracy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rq10ohcm8P"}],"key":"rVsGyoKHM0"},{"type":"text","value":": Random Forest = 0.855, Tuned XGBoost = 0.824","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"iKsZHCILs1"}],"key":"gJp7pjSyFW"}],"key":"xurmT4jPO4"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Bloom Precision","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VRFRTWPz1B"}],"key":"EWobzWU43Q"},{"type":"text","value":": Random Forest = 0.90, Tuned XGBoost = 0.70","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xPSoQiFweN"}],"key":"AAcbrQBLAF"}],"key":"e5dPbONUui"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Bloom Recall","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nkZyT3P00x"}],"key":"qTro61QSRd"},{"type":"text","value":": Random Forest = 0.79, Tuned XGBoost = 0.78","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"SsUANXwqi1"}],"key":"R4Ko9kQt0t"}],"key":"WsVITgSnda"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Bloom F1-score","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wUUu816J84"}],"key":"WfH7pFDXF2"},{"type":"text","value":": Random Forest = 0.85, Tuned XGBoost = 0.74","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZT5B0L0io4"}],"key":"kjwfFN0Kgb"}],"key":"YQj1pXFGRo"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"False Negatives","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"cTI616lV65"}],"key":"fHMEIwoGE7"},{"type":"text","value":" ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gVQIBrU4IJ"},{"type":"emphasis","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"(missed blooms)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"EFlGkrNdWd"}],"key":"ULQJ3YtMSN"},{"type":"text","value":": Tuned XGBoost = 20, Random Forest = 18","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"pQQfvN7PNH"}],"key":"dA2YqTfal1"}],"key":"bPnRe7iHNr"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"False Positives","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Ph81wjrSUj"}],"key":"G9dQhsIYLh"},{"type":"text","value":": Tuned XGBoost = 31, Random Forest = 7","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"U1ehFUJx6B"}],"key":"cUYfb6GyFC"}],"key":"U7IJIeQ98s"}],"key":"gVT7GGv9o1"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Conclusion:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"YWuVJQH0ku"}],"key":"v11GH5TEvb"}],"key":"x4PHl8GtVc"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"i4ZCAfZGDy"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Random Forest model","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"tekBtpla4B"}],"key":"RTbMxvjspv"},{"type":"text","value":" provided better overall performance, with higher precision, accuracy, and fewer false positives. This makes it a strong candidate for operational forecasting where minimizing false alerts is critical.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xkSizQCXul"}],"key":"bnKrR696xK"}],"key":"GWuPXcaSrr"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"mla7OqfgvJ"},{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Tuned XGBoost model","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"wvP1Th7wHV"}],"key":"WySzCjB79u"},{"type":"text","value":", while slightly behind in most metrics, offered comparable recall to Random Forest and remains a useful option when seeking to diversify model perspectives or explore ensemble approaches.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"nyaMOnuMbP"}],"key":"b6OdB4yrar"}],"key":"YXMS9Klxrq"}],"key":"gZMiEAcnPS"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"In this comparison, Random Forest demonstrated a more favorable balance between sensitivity and specificity. However, model selection ultimately depends on the operational objective—whether it’s more important to ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"hjrlSB6xG5"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"minimize missed bloom events","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"C5XBMBw8fe"}],"key":"vbMv3rXo0k"},{"type":"text","value":" (recall) or to ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"RJgUiAxXYE"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"reduce false bloom predictions","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"qXgx3qB6dL"}],"key":"JQtVABDkb2"},{"type":"text","value":" (precision).","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"J6DJ7C66PY"}],"key":"Cxu86y3GYU"}],"key":"vcJ3OX65m4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\n\n# Define metrics and scores\nmetrics = ['Accuracy', 'Balanced Accuracy', 'Bloom Precision', 'Bloom Recall', 'Bloom F1-score']\nrf_scores = [0.90, 0.875, 0.88, 0.80, 0.84]       # Best RF model (with Tampa KB)\nxgb_scores = [0.86, 0.824, 0.70, 0.78, 0.74]       # Tuned XGB model (with Tampa KB)\n\nx = np.arange(len(metrics))\nwidth = 0.35\n\nplt.figure(figsize=(10, 6))\nbars_rf = plt.bar(x - width/2, rf_scores, width, label='Random Forest')\nbars_xgb = plt.bar(x + width/2, xgb_scores, width, label='Tuned XGBoost')\n\n# Add value labels\nfor bar in bars_rf:\n    height = bar.get_height()\n    plt.text(bar.get_x() + bar.get_width()/2, height + 0.015, f\"{height:.2f}\", ha='center', va='bottom')\n\nfor bar in bars_xgb:\n    height = bar.get_height()\n    plt.text(bar.get_x() + bar.get_width()/2, height + 0.015, f\"{height:.2f}\", ha='center', va='bottom')\n\nplt.ylabel('Score')\nplt.xticks(x, metrics, rotation=45)\nplt.ylim(0.6, 1.05)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"bdYp6T4Gpf"},{"type":"outputs","id":"6_XQdi8f91JqAvA2e-rWS","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-03-32.png\n"},"children":[],"key":"n9j4ppbwaL"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"cf74c063387ceba368647271a8cc56cf","path":"/red-tide-book//build/cf74c063387ceba368647271a8cc56cf.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"G5SeIjYyQC"}],"key":"n2ZyK2nGRJ"}],"key":"qtdgwGNFhH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Support Vector Classifier (Linear Kernel)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MHWMoe8R2G"}],"identifier":"id-4-support-vector-classifier-linear-kernel","label":"4. Support Vector Classifier (Linear Kernel)","html_id":"id-4-support-vector-classifier-linear-kernel","implicit":true,"key":"bZw5RoYlr9"}],"key":"pYjAXOsA3R"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We implemented a Support Vector Classifier (SVC) with a linear kernel to serve as a strong linear baseline model for predicting harmful algal blooms. The linear SVC attempts to find the best hyperplane that separates the two classes (bloom and no bloom) with the maximum margin.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cHLVeKOUbU"}],"key":"egv52scuy2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This model is particularly useful because:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JuQkUHhXRI"}],"key":"giAb0opxKV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It performs well on moderately sized datasets.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uLl7NYwiNN"}],"key":"zFf0WWHEye"}],"key":"Cu7vlJgQ9W"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It provides a clear, interpretable decision boundary.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ggvdtttOzu"}],"key":"VYL44SruUE"}],"key":"rAIZ1lbLxE"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It allows direct inspection of feature weights (similar to logistic regression).","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lyHz4KsBGW"}],"key":"OF245O82zn"}],"key":"mmB8yOWOD5"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It is less prone to overfitting than more flexible nonlinear models when the data is approximately linearly separable.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"y6sWvn2QQY"}],"key":"aDiYVLOUUn"}],"key":"Wg5cynC58C"}],"key":"QoLMnxpcdm"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"We used ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MSvyFgj5ik"},{"type":"inlineCode","value":"class_weight='balanced'","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"WHXuLlhG3n"},{"type":"text","value":" to account for class imbalance and evaluated the model using balanced accuracy and F1-score, with special attention to performance on the bloom class. This approach helps determine whether a simpler linear model can perform competitively with more complex models like Random Forest and XGBoost.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HWsQpKeSwR"}],"key":"qDUJzQ4Wgd"}],"key":"V7xBD7Jrv9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.1 Re-Split and Scaled the Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EJqNloxBDc"}],"identifier":"id-4-1-re-split-and-scaled-the-data","label":"4.1 Re-Split and Scaled the Data","html_id":"id-4-1-re-split-and-scaled-the-data","implicit":true,"key":"yzURXPCsCr"}],"key":"eXCdhFJ5xz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We re-split the data using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Aa90ZOjOAW"},{"type":"inlineCode","value":"train_test_split","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c0KJ1Hovup"},{"type":"text","value":" to ensure that the input features (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CSE1GhTpCt"},{"type":"inlineCode","value":"X","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oHlgxp2U96"},{"type":"text","value":") and target labels (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"drBCs8OrEl"},{"type":"inlineCode","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yrSdmzvI30"},{"type":"text","value":") have matching sample sizes. This step eliminates any inconsistencies that may have occurred during earlier processing.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AyyhLQp4Rc"}],"key":"TAbt3M23kO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We also applied ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b0cYvywObN"},{"type":"inlineCode","value":"StandardScaler","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Grz86OMIhQ"},{"type":"text","value":" to normalize the feature values, which is important for models like Support Vector Machines that are sensitive to the scale of input data. Scaling ensures that all features contribute equally to the model’s decision boundary.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lsNsNT3BsC"}],"key":"O6v63pnSEK"}],"key":"Ps6sMH4L41"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\n\n# Re-split data cleanly to ensure matching sizes\nX = df[features]\ny = df['target_next_week']\n\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, stratify=y, random_state=42\n)\n\n# Scale features\nscaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)","key":"bLGdLzaHGA"},{"type":"outputs","id":"S2ba7MAEP9xDz91QnvFwu","children":[],"key":"CzfDQhNHBk"}],"key":"hBv6DnAebE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.svm import SVC\nfrom sklearn.metrics import classification_report, balanced_accuracy_score\n\nsvc_linear = SVC(kernel='linear', class_weight='balanced', random_state=42)\nsvc_linear.fit(X_train_scaled, y_train)\n\ny_pred_svc = svc_linear.predict(X_test_scaled)\n\nprint(\"Balanced Accuracy:\", balanced_accuracy_score(y_test, y_pred_svc))\nprint(\"Classification Report:\\n\", classification_report(y_test, y_pred_svc, target_names=[\"No Bloom\", \"Bloom\"]))","key":"o7msZgajGj"},{"type":"outputs","id":"oy42jx-lebPHXHjO_IZnw","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Balanced Accuracy: 0.7436006022962545\nClassification Report:\n               precision    recall  f1-score   support\n\n    No Bloom       0.84      0.94      0.89       231\n       Bloom       0.79      0.54      0.65        92\n\n    accuracy                           0.83       323\n   macro avg       0.82      0.74      0.77       323\nweighted avg       0.83      0.83      0.82       323\n\n"},"children":[],"key":"WwwyhxmBNn"}],"key":"nFiBfSjPiY"}],"key":"gWGtZduSiC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4.2 Summary of Support Vector Classifier (Linear Kernel)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZxoejGFtTu"}],"identifier":"id-4-2-summary-of-support-vector-classifier-linear-kernel","label":"4.2 Summary of Support Vector Classifier (Linear Kernel)","html_id":"id-4-2-summary-of-support-vector-classifier-linear-kernel","implicit":true,"key":"AjgCMTmKps"}],"key":"tcKBnmIHkv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Support Vector Classifier (SVC) with a linear kernel achieved an overall ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lEbwrHANiq"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"accuracy of 0.83","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H5j8hKDvGE"}],"key":"gr3Ey9EpQ2"},{"type":"text","value":" and a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rlbFPjkyTj"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"balanced accuracy of 0.74","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uKdiIM7Wsn"}],"key":"iaiTJXtWI4"},{"type":"text","value":" on the full SWFL dataset including Tampa Karenia brevis data. While the model performs well at identifying non-bloom cases, it continues to struggle with reliably detecting bloom events.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bCYsf94Cih"}],"key":"tJ140PhDBt"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Class-wise performance:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t4jekSubYg"}],"key":"s1YcBE5d4G"}],"key":"h7qsx2y52a"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"No Bloom (class 0):","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WFvEdPHm2W"}],"key":"dZAkFUmAut"}],"key":"mGOkmqE0wL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Precision: 0.84","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hvEU7luOpT"}],"key":"fUTPNP9ned"}],"key":"XHNqfdebA5"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Recall: 0.94","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JdluOeiVDQ"}],"key":"aFjCD9Ra8b"}],"key":"BbIxzqJUhq"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"F1-score: 0.89","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cTuFoHJn07"}],"key":"lfcQPoaR63"}],"key":"RXvjL0NgcG"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Interpretation","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"p1cfxYp2gd"}],"key":"zTS9WtK2N4"},{"type":"text","value":": The model is highly effective at detecting non-bloom conditions.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Rsioh74td9"}],"key":"P5ez4qmqA5"}],"key":"CvK5HhhYjM"}],"key":"V2mFxaNWc4"}],"key":"Ixhr1nBobz"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Bloom (class 1):","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NaemJYC4v5"}],"key":"s7N7uadaYB"}],"key":"azcSdp2f5K"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Precision: 0.79","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fO6NuKud4m"}],"key":"eRB9XtlS7l"}],"key":"NJkenKS5ti"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Recall: 0.54","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"MrFVybrAGX"}],"key":"nVniU5VEzB"}],"key":"UFKOTGiVpu"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"F1-score: 0.65","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"wB4JF7yigG"}],"key":"QgmC8MdU7N"}],"key":"lhzKEtWS56"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Interpretation","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"maQIMK7eiu"}],"key":"OpJnxfMOcw"},{"type":"text","value":": The model is moderately precise when predicting a bloom, but still misses nearly half of actual bloom events.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"glKaHJgEty"}],"key":"E7Sg3Tsw5H"}],"key":"hbwfKSgij8"}],"key":"uPUoS8CGcA"}],"key":"lGiq771z5m"}],"key":"OyfeRs0lnu"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Summary:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"HCqYdJiwVA"}],"key":"R40IqmfGq4"}],"key":"WTu15fIOGn"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Overall, the linear SVC model remains a more conservative classifier. It favors predicting “No Bloom” and only predicts “Bloom” when it is relatively confident. This approach results in relatively few false positives (false bloom alerts) but a higher number of false negatives (missed bloom events). While this behavior may be acceptable in settings where false alarms must be minimized, it may be unsuitable in environmental or public health contexts where early detection of harmful blooms is a priority.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"a8doIJqU26"}],"key":"t8akmlYBZP"}],"key":"OdCNcJFX1u"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5. Model Comparison","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qFzS9BYedI"}],"identifier":"id-5-model-comparison","label":"5. Model Comparison","html_id":"id-5-model-comparison","implicit":true,"key":"vvnBVcKD52"}],"key":"KZ4YWuYYNC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\n\n# Define the performance metrics\nmetrics = ['Accuracy', 'Balanced Accuracy', 'Bloom Precision', 'Bloom Recall', 'Bloom F1-score']\n\n# Updated scores for the most recent SWFL + Tampa KB run\nrf_scores =  [0.90, 0.875, 0.88, 0.80, 0.84]  # from previous RF evaluation\nxgb_scores = [0.86, 0.857, 0.81, 0.78, 0.77]  # tuned XGBoost on new dataset\nsvc_scores = [0.83, 0.743, 0.79, 0.54, 0.65]  # new SVC results from latest output\n\n# Set up bar positions\nx = np.arange(len(metrics))\nwidth = 0.25  # Width of each bar\n\n# Create the plot\nplt.figure(figsize=(10, 7))\nbars_rf = plt.bar(x - width, rf_scores, width, label='Random Forest')\nbars_xgb = plt.bar(x, xgb_scores, width, label='Tuned XGBoost')\nbars_svc = plt.bar(x + width, svc_scores, width, label='Linear SVC')\n\n# Add value labels above each bar\nfor bars in [bars_rf, bars_xgb, bars_svc]:\n    for bar in bars:\n        height = bar.get_height()\n        plt.text(bar.get_x() + bar.get_width() / 2, height + 0.01, f\"{height:.2f}\",\n                 ha='center', va='bottom')\n\n# Customize chart appearance\nplt.ylabel('Score')\nplt.xticks(x, metrics, rotation=45)\nplt.ylim(0.5, 1.0)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"knFPqUcsVx"},{"type":"outputs","id":"fYAGs8xQCpUgizo7HqDnA","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-03-32.png\n"},"children":[],"key":"kDLnGa5wXG"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"64e5c293682666c3f0478d0b90ea937e","path":"/red-tide-book//build/64e5c293682666c3f0478d0b90ea937e.png"},"text/plain":{"content":"\u003cFigure size 1000x700 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"LBU7RNnmwi"}],"key":"rL0DDwLP4t"}],"key":"nYMULm7Dgo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5.1 Summary of Model Performance Comparison","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nE2eQ910af"}],"identifier":"id-5-1-summary-of-model-performance-comparison","label":"5.1 Summary of Model Performance Comparison","html_id":"id-5-1-summary-of-model-performance-comparison","implicit":true,"key":"yv6V7tKMfY"}],"key":"kWzpHph5cM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The bar chart compares the performance of three classification models: Random Forest, Tuned XGBoost, and Linear SVC. Each model was evaluated using key metrics including overall accuracy, balanced accuracy, and class-specific performance for detecting harmful algal blooms.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KwCebijRiw"}],"key":"yfbh8x1B9g"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Df6aKyhOpR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Key Insights:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kflcncHMTt"}],"key":"OfpbsyZArP"}],"key":"eSawcTcPqe"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Random Forest","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UxcWhAsPdL"}],"key":"CWCut6pinW"},{"type":"text","value":" delivers the strongest overall performance:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ulUziAhhOU"}],"key":"t0gA3ERhPL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Accuracy:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BkUzQLARCD"}],"key":"dQUkFQ7lZa"},{"type":"text","value":" 0.90","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"JhwnkYXz6E"}],"key":"jVEUptgMIB"}],"key":"EwlrYyqvEA"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Balanced Accuracy:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QeiuBFlBf7"}],"key":"shw8GczUlY"},{"type":"text","value":" 0.88","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ea7DsC83hW"}],"key":"zs2PddfGjL"}],"key":"KueyFcjIuv"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Bloom Precision:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ozmMAuXWFF"}],"key":"okHBQyjZAQ"},{"type":"text","value":" 0.88","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"efSvAMNvy3"}],"key":"ZfKXjaK58K"}],"key":"ApwUGNeAYe"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Bloom Recall:","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Ei37cMq2rM"}],"key":"H121lfzCbj"},{"type":"text","value":" 0.80","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kRvsFplrdB"}],"key":"CQIvODvoPY"}],"key":"wzEqV95ecC"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Bloom F1-score:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"KbOyZqICw0"}],"key":"CJtZEzaA5o"},{"type":"text","value":" 0.84","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"g1OJLkc8Md"}],"key":"QpZyauXgPs"}],"key":"CZ1kbp6v1r"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Conclusion:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"mSxE71Cv74"}],"key":"tOJnlZHppr"},{"type":"text","value":" This model balances bloom detection and false positive avoidance, making it a reliable choice for operational deployment.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"ZiAeLub2PS"}],"key":"jgJMjcBCks"}],"key":"I9tdfvbr4l"}],"key":"GSEGCsFmYG"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Tuned XGBoost","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ToigcwNiRe"}],"key":"bWpM28H5O4"},{"type":"text","value":" offers competitive performance:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"qDVy22dHVB"}],"key":"bYh28ZU9XL"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Accuracy:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"GWtaTcUnzO"}],"key":"d7PTrpSaU6"},{"type":"text","value":" 0.86","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"UasvydDMfz"}],"key":"Q5rGpzTjdQ"}],"key":"Hiyx2kwiYq"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Balanced Accuracy:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"tsmdS8xvAa"}],"key":"HKz2YqBROH"},{"type":"text","value":" 0.86","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"F45aApyjyY"}],"key":"tPCp80BTtf"}],"key":"KaUzoDMGSl"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Bloom Precision:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pGXOZtg3yI"}],"key":"HAvXxMYGSp"},{"type":"text","value":" 0.81","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"AzQWvw7cJQ"}],"key":"OvF51KOiTa"}],"key":"v9Gch2i2Fb"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Bloom Recall:","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ZPjiSefD48"}],"key":"C73pKqfTJy"},{"type":"text","value":" 0.85","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"S4uC73tWLK"}],"key":"ZwaXtNVSxR"}],"key":"eyWyXoUwRK"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Bloom F1-score:","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"gFcM2A5UV2"}],"key":"v1lk5FGTNM"},{"type":"text","value":" 0.77","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"LZ7p8t5XM8"}],"key":"TAHX1OGoFP"}],"key":"RqAUpVS4Ez"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Conclusion:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"bN7fcbRrTO"}],"key":"cxfNDQz7BO"},{"type":"text","value":" This model sacrifices some precision in order to catch more actual bloom events, making it ideal where early detection is a priority despite a slightly higher false alarm rate.","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"lkY5tn7IQI"}],"key":"Oq8Kl1JNsk"}],"key":"navV2799R9"}],"key":"wMG9v5Br8B"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Linear SVC","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"vx9kTi6iif"}],"key":"tLabcwME5Q"},{"type":"text","value":" underperforms in bloom detection:","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"epbflqWVCW"}],"key":"W21Q55fhmb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Accuracy:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"lZtOWjnFgx"}],"key":"ZusEBO1BHT"},{"type":"text","value":" 0.85","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"GS1vIHur7x"}],"key":"ilTsHmfpjw"}],"key":"IGpCuz4JCj"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Balanced Accuracy:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Dy63Lxuug5"}],"key":"zbNFTZMo8K"},{"type":"text","value":" 0.75","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Quu6n2SwTR"}],"key":"ppd4sP2LKv"}],"key":"Of0fFJZOj4"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Bloom Precision:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xfLQRVsMjT"}],"key":"p8uhde6EC5"},{"type":"text","value":" 0.79","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"NqukyxmIND"}],"key":"Z5UyGS02Nx"}],"key":"gYTFK6Bwa3"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Bloom Recall:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"IVme9SFKaN"}],"key":"lIL7TUI6F4"},{"type":"text","value":" 0.54","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"KtRKyTHco5"}],"key":"AQL2NNv8ZL"}],"key":"KqfX0rfiM1"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Bloom F1-score:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"L2yEhwolmA"}],"key":"mw0tCzBswp"},{"type":"text","value":" 0.65","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"XhwwZrJqVE"}],"key":"yC3ACCs1NG"}],"key":"h6c9aWbzQd"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"emphasis","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Conclusion:","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"GZfyBEPMwI"}],"key":"wTtmiud8u1"},{"type":"text","value":" While this model avoids false positives, its lower recall leads to more missed bloom events, limiting its value for sensitive ecological monitoring.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"xiDkCQizNV"}],"key":"QSdbsERzLc"}],"key":"oEYmxWoekm"}],"key":"DKNhVk7KEM"},{"type":"thematicBreak","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Qdc5nrIvxz"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Conclusion:","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"SQumVY11wV"}],"key":"myB9zmiiO9"}],"key":"dxiPA28MQM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":35,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Random Forest","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"B0SggpdsKO"}],"key":"Fpt6D2XrwG"},{"type":"text","value":" remains the top-performing model with the best all-around accuracy, balance, and bloom detection reliability.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"zfM6UJb33n"}],"key":"YpRnq51g3w"}],"key":"BqN48WSiTS"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Tuned XGBoost","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"U85wz7AurS"}],"key":"rd9AzNl6bg"},{"type":"text","value":" is preferred when early bloom detection is critical, especially in high-risk conditions.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"yQpu5quQi9"}],"key":"tOz01Mh2rs"}],"key":"gKwMHPPsVE"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Linear SVC","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"vlnGR9NuXk"}],"key":"BZQGSOPdU0"},{"type":"text","value":" may be suitable for exploratory or low-risk use cases, but its low sensitivity makes it less viable for real-time or mission-critical bloom monitoring.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"svumtVQW3V"}],"key":"IBJ28PbVbs"}],"key":"LvC7c8LTVd"}],"key":"Z2KXsvOGxo"}],"key":"EdSJNx0lIQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6. KB Probability as a Function of TN and TP","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JLUK0e8UrA"}],"identifier":"id-6-kb-probability-as-a-function-of-tn-and-tp","label":"6. KB Probability as a Function of TN and TP","html_id":"id-6-kb-probability-as-a-function-of-tn-and-tp","implicit":true,"key":"xeS1rnWGkN"}],"key":"GfEOZug4Kt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This plot was created using a Random Forest classifier trained to predict the likelihood of a KB bloom event based on combined nutrient concentrations from the Peace and Caloosahatchee Rivers. Specifically, TN was calculated as the sum of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H5NhOmO1Sn"},{"type":"inlineCode","value":"peace_TN","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nQYtbLixYH"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VzVwasoIbB"},{"type":"inlineCode","value":"caloosa_total_nitrogen","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FsSJRz0tjM"},{"type":"text","value":", and TP as the sum of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xixEt4Pory"},{"type":"inlineCode","value":"peace_TP","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y0ehYTvPBR"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nB1IqxLvc6"},{"type":"inlineCode","value":"caloosa_total_phosphorus","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UYab9td4rL"},{"type":"text","value":". The model was trained on historical data from the merged SWFL + Tampa KB dataset. After training, bloom probabilities were predicted across a meshgrid of TN and TP values spanning the 1st to 99th percentiles of observed concentrations. These predictions were smoothed using a Gaussian filter to reduce noise and enhance interpretability. The result is a continuous contour map showing bloom probability as a function of nutrient levels, with a red gradient indicating increasing bloom risk.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C4arz6q0K3"}],"key":"aM66igdpqU"}],"key":"d0Q3934Wos"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.ensemble import RandomForestClassifier\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Load your merged dataset (make sure this path matches your actual CSV)\ndf = pd.read_csv('swfl_merged_features_tampa.csv', parse_dates=['time'])\n\n# Filter out rows with missing data for all required columns\ndf = df[['peace_TN', 'peace_TP', 'caloosa_total_nitrogen', 'caloosa_total_phosphorus', 'kb']].dropna()\n\n# Create binary target: bloom if kb \u003e= 100000\ndf['bloom'] = (df['kb'] \u003e= 100000).astype(int)\n\n# Define combined TN and TP using intermediate variables (does NOT overwrite columns)\ntotal_TN = df['peace_TN'] + df['caloosa_total_nitrogen']\ntotal_TP = df['peace_TP'] + df['caloosa_total_phosphorus']\n\n# Train classifier using combined TN and TP\nX = pd.DataFrame({'total_TN': total_TN, 'total_TP': total_TP})\ny = df['bloom']\n\nclf = RandomForestClassifier(n_estimators=100, class_weight='balanced', random_state=42)\nclf.fit(X, y)\n\n# Create grid\ntn_vals = np.linspace(total_TN.quantile(0.01), total_TN.quantile(0.99), 100)\ntp_vals = np.linspace(total_TP.quantile(0.01), total_TP.quantile(0.99), 100)\nTN, TP = np.meshgrid(tn_vals, tp_vals)\n\n# Predict bloom probability over grid\nbloom_probs = np.zeros_like(TN)\n\nfor i in range(TN.shape[0]):\n    for j in range(TN.shape[1]):\n        sample = pd.DataFrame({'total_TN': [TN[i, j]], 'total_TP': [TP[i, j]]})\n        bloom_probs[i, j] = clf.predict_proba(sample)[0, 1]\n\n# Plot\nplt.figure(figsize=(10, 6))\ncontour = plt.contourf(TN, TP, bloom_probs, levels=20, cmap='Reds')\ncbar = plt.colorbar(contour)\ncbar.set_label('Bloom Probability')\nplt.xlabel('Total Nitrogen (mg/L)')\nplt.ylabel('Total Phosphorus (mg/L)')\nplt.show()","key":"veck6ieUj0"},{"type":"outputs","id":"01broN-QdsfJZ-5sB828x","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Final_Graphics\\figure_2025-12-29_18-04-59.png\n"},"children":[],"key":"DWvKiFdjLS"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc26e8efa131542628ba8138548c2a7e","path":"/red-tide-book//build/fc26e8efa131542628ba8138548c2a7e.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 2 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"sbLS4mFYsL"}],"key":"MeU6chZUpA"}],"key":"UzOGkeXE5w"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6.1 Conclusion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KZ62gAeMvz"}],"identifier":"id-6-1-conclusion","label":"6.1 Conclusion","html_id":"id-6-1-conclusion","implicit":true,"key":"cbOdu5hV3V"}],"key":"CCUUivZT0r"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Key Insights","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q8Ie5GXnB4"}],"key":"geDErSrOlM"}],"key":"csdjGNLldO"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The contour plot reveals that KB bloom risk is strongly associated with elevated nutrient concentrations, particularly total phosphorus. Bloom probabilities increase markedly when TP exceeds ~1.5–2.5 mg/L, especially when total nitrogen is also elevated. The highest predicted bloom probabilities occur when both TN and TP are simultaneously high, suggesting that bloom formation is influenced by co-limitation or synergistic effects between the two nutrients. Conversely, low concentrations of either nutrient suppress bloom probability, reinforcing the ecological expectation that both nitrogen and phosphorus must be sufficiently available to support bloom development.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J3nS2uD6NI"}],"key":"RGLjHBFZ9X"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Real-World Implications","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NW4pzKE14D"}],"key":"syvWySJTT2"}],"key":"gcEen0aJFw"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"These results emphasize the importance of joint nutrient management across both the Peace and Caloosahatchee River systems. Because bloom risk is driven by combined nutrient input, mitigating only one nutrient source or one watershed may not be sufficient. Watershed planners and environmental managers can use this plot to identify nutrient concentration zones most associated with bloom risk and prioritize efforts to reduce both nitrogen and phosphorus loading. Additionally, this model could support early warning systems by identifying high-risk nutrient conditions in real time, providing a data-driven foundation for forecasting and mitigation strategies.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VL3aMZyeDX"}],"key":"dtecJDZ2z7"}],"key":"nD72vLLusQ"}],"key":"tiGCSHmKgp"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Watershed Study Area","url":"/watershed-graphics","group":"Red Tide Data and Modeling Book"}}},"domain":"http://localhost:3000"},"project":{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"id":"red-tide-book","toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/red-tide-book//build/manifest-86A905A4.js";
import * as route0 from "/red-tide-book//build/root-CXYA7X5D.js";
import * as route1 from "/red-tide-book//build/routes/$-JRBPULBO.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/red-tide-book//build/entry.client-PCJPW7TK.js");</script></body></html>