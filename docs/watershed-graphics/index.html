<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Watershed Study Area - Red Tide Data and Modeling Book</title><meta property="og:title" content="Watershed Study Area - Red Tide Data and Modeling Book"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><link rel="stylesheet" href="/build/_assets/app-AIT5GAEP.css"/><link rel="stylesheet" href="/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/favicon.ico"/><link rel="stylesheet" href="/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="Red Tide Data and Modeling Book" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/">Red Tide Data and Modeling Book</a><a title="Data Integration for Southwest Florida" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/data-swfl-combined">Data Integration for Southwest Florida</a><a title="Watershed Study Area" aria-current="page" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg myst-toc-item-exact bg-blue-300/30 active" href="/watershed-graphics">Watershed Study Area</a><a title="Machine Learning Model for Combined Peace River and Caloosahatchee River" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/ml-model-swfl-with-tampa">Machine Learning Model for Combined Peace River and Caloosahatchee River</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"></div><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Watershed Study Area</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Matthew Duus</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="AvbBekE6Z9" class="myst-jp-nb-block relative group/block"><h2 id="id-1-caloosahatchee-watershed-boundary-extraction" class="relative group"><span class="heading-text">1. Caloosahatchee Watershed Boundary Extraction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-caloosahatchee-watershed-boundary-extraction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="GZuxKkFVul" class="myst-jp-nb-block relative group/block"><p>The Caloosahatchee River watershed boundary was obtained from the USGS Watershed Boundary Dataset (WBD) by querying the hydrologic unit corresponding to HUC-8 03090205. The resulting polygon defines the official extent of the Caloosahatchee basin and serves as the spatial framework for subsequent mapping and analysis.</p></div><div id="MwZti8nz3h" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import geopandas as gpd

wbd_url = (
    &quot;https://hydro.nationalmap.gov/arcgis/rest/services/wbd/MapServer/4/&quot;
    &quot;query?where=HUC8%3D%2703090205%27&amp;outFields=*&amp;f=geojson&quot;
)

caloosa = gpd.read_file(wbd_url)

print(caloosa.crs)   # just to see what it is

caloosa.plot(edgecolor=&quot;black&quot;, facecolor=&quot;none&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="vxlUQaG1f885YnT7-fL8s" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>EPSG:4326
</span></code></pre></div></div><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>&lt;Axes: &gt;</span></code></div><div data-name="safe-output-image"><img src="/build/015068ce12797aea21624c166b0bbd9a.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div></div><div id="veBNbnYGju" class="myst-jp-nb-block relative group/block"><h2 id="id-2-caloosahatchee-river-flowline-extraction" class="relative group"><span class="heading-text">2. Caloosahatchee River Flowline Extraction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-caloosahatchee-river-flowline-extraction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="mmr9QYY1li" class="myst-jp-nb-block relative group/block"><p>The main stem of the Caloosahatchee River was extracted from the USGS National Hydrography Dataset (NHD) using a name-based query of the NHD Flowline (Large Scale) layer. All polyline features associated with the “Caloosahatchee” GNIS name were retrieved, providing an accurate representation of the river’s course through the watershed.</p></div><div id="razquXeAta" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import geopandas as gpd

# NHD Flowline - Large Scale (layer 6), search by name
nhd_url = (
    &quot;https://hydro.nationalmap.gov/arcgis/rest/services/nhd/MapServer/6/&quot;
    &quot;query?where=gnis_name%20LIKE%20%27Caloosahatchee%25%27&amp;outFields=*&amp;f=geojson&quot;
)

river = gpd.read_file(nhd_url)

print(&quot;River CRS:&quot;, river.crs)
print(&quot;Number of features:&quot;, len(river))

if len(river) &gt; 0:
    ax = river.plot(color=&quot;deepskyblue&quot;, linewidth=1)
else:
    print(&quot;No features returned – name query didn&#x27;t find anything.&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="m89ixx-dyCpHsV07vYlnf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>River CRS: EPSG:4326
Number of features: 268
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/build/2d4937009af155fa8f8d70451e9629bb.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div></div><div id="NLODAX6z3F" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">pip install contextily</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="x4NlxEnpF7GFLP4CM_ljd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Requirement already satisfied: contextily in c:\users\mkduu\miniconda3\lib\site-packages (1.6.2)
Requirement already satisfied: geopy in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (2.4.1)
Requirement already satisfied: matplotlib in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (3.10.0)
Requirement already satisfied: mercantile in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (1.2.1)
Requirement already satisfied: pillow in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (11.1.0)
Requirement already satisfied: rasterio in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (1.4.3)
Requirement already satisfied: requests in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (2.32.3)
Requirement already satisfied: joblib in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (1.4.2)
Requirement already satisfied: xyzservices in c:\users\mkduu\miniconda3\lib\site-packages (from contextily) (2024.9.0)
Requirement already satisfied: geographiclib&lt;3,&gt;=1.52 in c:\users\mkduu\miniconda3\lib\site-packages (from geopy-&gt;contextily) (2.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (4.55.3)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (1.4.8)
Requirement already satisfied: numpy&gt;=1.23 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (2.2.1)
Requirement already satisfied: packaging&gt;=20.0 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (24.1)
Requirement already satisfied: pyparsing&gt;=2.3.1 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (3.2.1)
Requirement already satisfied: python-dateutil&gt;=2.7 in c:\users\mkduu\miniconda3\lib\site-packages (from matplotlib-&gt;contextily) (2.9.0.post0)
Requirement already satisfied: click&gt;=3.0 in c:\users\mkduu\miniconda3\lib\site-packages (from mercantile-&gt;contextily) (8.1.8)
Requirement already satisfied: affine in c:\users\mkduu\miniconda3\lib\site-packages (from rasterio-&gt;contextily) (2.4.0)
Requirement already satisfied: attrs in c:\users\mkduu\miniconda3\lib\site-packages (from rasterio-&gt;contextily) (24.3.0)
Requirement already satisfied: certifi in c:\users\mkduu\miniconda3\lib\site-packages (from rasterio-&gt;contextily) (2024.8.30)
Requirement already satisfied: cligj&gt;=0.5 in c:\users\mkduu\miniconda3\lib\site-packages (from rasterio-&gt;contextily) (0.7.2)
Requirement already satisfied: click-plugins in c:\users\mkduu\miniconda3\lib\site-packages (from rasterio-&gt;contextily) (1.1.1)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in c:\users\mkduu\miniconda3\lib\site-packages (from requests-&gt;contextily) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in c:\users\mkduu\miniconda3\lib\site-packages (from requests-&gt;contextily) (3.7)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in c:\users\mkduu\miniconda3\lib\site-packages (from requests-&gt;contextily) (2.2.3)
Requirement already satisfied: colorama in c:\users\mkduu\miniconda3\lib\site-packages (from click&gt;=3.0-&gt;mercantile-&gt;contextily) (0.4.6)
Requirement already satisfied: six&gt;=1.5 in c:\users\mkduu\miniconda3\lib\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib-&gt;contextily) (1.17.0)
Note: you may need to restart the kernel to use updated packages.
</span></code></pre></div></div></div></div><div id="ttQyTuPGbp" class="myst-jp-nb-block relative group/block"><h2 id="id-3-monitoring-stations-coordinate-transformation-and-map-generation-caloosahatchee" class="relative group"><span class="heading-text">3. Monitoring Stations, Coordinate Transformation, and Map Generation (Caloosahatchee)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-monitoring-stations-coordinate-transformation-and-map-generation-caloosahatchee" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="FkaJkmWhiy" class="myst-jp-nb-block relative group/block"><p>Monitoring station coordinates were compiled and converted into a geospatial dataset for inclusion on the study-area map. All spatial layers—including the watershed boundary, river flowline, and station locations—were reprojected to the Web Mercator coordinate system (EPSG:3857) to ensure compatibility with the OpenStreetMap basemap. These layers were then combined to generate a composite map of the Caloosahatchee watershed, providing a clear visualization of the basin, the river’s course, and the associated monitoring locations.</p></div><div id="N7Swio0kbG" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import geopandas as gpd
import matplotlib.pyplot as plt
from shapely.geometry import Point
import contextily as cx
import matplotlib.lines as mlines

# -----------------------------------------------------------
# 1. STATION LOCATIONS (EDIT COORDS AS NEEDED)
# -----------------------------------------------------------
stations_data = [
    {&quot;name&quot;: &quot;S-79 NEAR OLGA&quot;,        &quot;lon&quot;: -81.7760, &quot;lat&quot;: 26.7150},
    {&quot;name&quot;: &quot;CALOOSAHATCHEE BRIDGE&quot;, &quot;lon&quot;: -81.8780, &quot;lat&quot;: 26.6400},
    {&quot;name&quot;: &quot;DEEP LAGOON&quot;,           &quot;lon&quot;: -81.9530, &quot;lat&quot;: 26.5600},
]

stations = gpd.GeoDataFrame(
    stations_data,
    geometry=[Point(d[&quot;lon&quot;], d[&quot;lat&quot;]) for d in stations_data],
    crs=&quot;EPSG:4326&quot;
)

# -----------------------------------------------------------
# 2. PROJECT EVERYTHING TO WEB MERCATOR FOR BASEMAP
# -----------------------------------------------------------
target_crs = &quot;EPSG:3857&quot;

caloosa_3857 = caloosa.to_crs(target_crs)
river_3857   = river.to_crs(target_crs)
stations_3857 = stations.to_crs(target_crs)

# -----------------------------------------------------------
# 3. START FIGURE
# -----------------------------------------------------------
fig, ax = plt.subplots(figsize=(4, 6), dpi=300)

# Watershed outline
caloosa_3857.boundary.plot(ax=ax, color=&quot;black&quot;, linewidth=1)

# River line
river_3857.plot(ax=ax, color=&quot;deepskyblue&quot;, linewidth=2)

# Stations
stations_3857.plot(ax=ax, color=&quot;blue&quot;, markersize=25)

# -----------------------------------------------------------
# 4. PER-STATION LABEL OFFSETS (for cleaner labeling)
# -----------------------------------------------------------
offsets = {
    &quot;S-79 NEAR OLGA&quot;:        ( 2000,  700),
    &quot;CALOOSAHATCHEE BRIDGE&quot;: ( 2000,    0),
    &quot;DEEP LAGOON&quot;:           ( 2000, -800),
}

for x, y, label in zip(
        stations_3857.geometry.x,
        stations_3857.geometry.y,
        stations_3857[&quot;name&quot;]):
    
    dx, dy = offsets.get(label, (500, 500))
    
    ax.text(
        x + dx,
        y + dy,
        label,
        fontsize=6,
        color=&quot;navy&quot;,
    )

# -----------------------------------------------------------
# 5. BASEMAP + EXTENT + LEGEND
# -----------------------------------------------------------
xmin, ymin, xmax, ymax = caloosa_3857.total_bounds
pad = 5000   # meters of padding around bounding box

ax.set_xlim(xmin - pad, xmax + pad)
ax.set_ylim(ymin - pad, ymax + pad)

# Add OpenStreetMap basemap
cx.add_basemap(
    ax,
    source=cx.providers.OpenStreetMap.Mapnik,
    crs=target_crs,
    alpha=0.8
)

# Legend handles
station_handle = mlines.Line2D(
    [], [], color=&quot;blue&quot;, marker=&quot;o&quot;, linestyle=&quot;None&quot;,
    markersize=5, label=&quot;Stations&quot;
)
river_handle = mlines.Line2D(
    [], [], color=&quot;deepskyblue&quot;, linewidth=2,
    label=&quot;Caloosahatchee River&quot;
)

ax.legend(handles=[station_handle, river_handle],
          loc=&quot;upper right&quot;, fontsize=7, frameon=True)

# Remove axes ticks
ax.set_xticks([])
ax.set_yticks([])

plt.tight_layout()

# -----------------------------------------------------------
# 6. SAVE HIGH-RES EXPORT
# -----------------------------------------------------------
plt.savefig(&quot;caloosahatchee_watershed_map.png&quot;, dpi=600, bbox_inches=&quot;tight&quot;)
plt.savefig(
    &quot;caloosahatchee_watershed_map.png&quot;,
    dpi=600,
    bbox_inches=&quot;tight&quot;
)
plt.savefig(
    r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Caloosahatchee watershed Graphics\caloosahatchee_watershed_map.png&quot;,
    dpi=600,
    bbox_inches=&quot;tight&quot;
)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="YploTJUGKf1osKgc0J5w_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/build/6c267bd0d10aa418d138fcdec0290270.png" alt="&lt;Figure size 1200x1800 with 1 Axes&gt;"/></div></div></div><div id="jX3fvKZxi8" class="myst-jp-nb-block relative group/block"><h2 id="id-4-peace-river-watershed-boundary-extraction" class="relative group"><span class="heading-text">4. Peace River Watershed Boundary Extraction</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-peace-river-watershed-boundary-extraction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="HLnMvtnx1Q" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import geopandas as gpd

# Peace River HUC-8 from USGS WBD
wbd_url_peace = (
    &quot;https://hydro.nationalmap.gov/arcgis/rest/services/wbd/MapServer/4/&quot;
    &quot;query?where=HUC8%3D%2703100101%27&amp;outFields=*&amp;f=geojson&quot;
)

peace_ws = gpd.read_file(wbd_url_peace)

print(peace_ws.crs)
peace_ws.plot(edgecolor=&quot;black&quot;, facecolor=&quot;none&quot;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="iRiGiYQ9JNIHRXVxek1CQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>EPSG:4326
</span></code></pre></div></div><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>&lt;Axes: &gt;</span></code></div><div data-name="safe-output-image"><img src="/build/76c6879485b21afc35aa12a7254bfe1b.png" alt="&lt;Figure size 640x480 with 1 Axes&gt;"/></div></div></div><div id="GEB9aT6erd" class="myst-jp-nb-block relative group/block"><h2 id="id-5-peace-river-flowline-from-nhd" class="relative group"><span class="heading-text">5. Peace River Flowline From NHD</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-peace-river-flowline-from-nhd" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="wK0ahFnEXv" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import geopandas as gpd

# ---------------------------------------------------------------------
# 1. Peace River watershed boundary (HUC-8: 03100101)
# ---------------------------------------------------------------------
wbd_url_peace = (
    &quot;https://hydro.nationalmap.gov/arcgis/rest/services/wbd/MapServer/4/&quot;
    &quot;query?where=HUC8%3D%2703100101%27&amp;outFields=*&amp;f=geojson&quot;
)

peace_ws = gpd.read_file(wbd_url_peace)
print(&quot;Peace WS CRS:&quot;, peace_ws.crs)

# ---------------------------------------------------------------------
# 2. Peace River flowlines from NHD (often returns extra junk)
# ---------------------------------------------------------------------
nhd_url_peace = (
    &quot;https://hydro.nationalmap.gov/arcgis/rest/services/nhd/MapServer/6/&quot;
    &quot;query?where=gnis_name%20LIKE%20%27Peace%20River%25%27&amp;outFields=*&amp;f=geojson&quot;
)

peace_river = gpd.read_file(nhd_url_peace)
print(&quot;Raw flowline features:&quot;, len(peace_river))

# ---------------------------------------------------------------------
# 3. Clip flowlines to the watershed to remove stray segments
# ---------------------------------------------------------------------
# Ensure CRS matches
peace_ws = peace_ws.to_crs(peace_river.crs)

peace_river_clip = gpd.overlay(peace_river, peace_ws, how=&quot;intersection&quot;)
print(&quot;Clipped flowline features:&quot;, len(peace_river_clip))

# ---------------------------------------------------------------------
# 4. Plot result
# ---------------------------------------------------------------------
ax = peace_ws.plot(edgecolor=&quot;black&quot;, facecolor=&quot;none&quot;, figsize=(4, 6))
peace_river_clip.plot(ax=ax, color=&quot;deepskyblue&quot;, linewidth=1)

plt.title(&quot;Peace River Flowline (Clipped to Watershed)&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Idr6sG47OoAZnqDavgP7p" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Peace WS CRS: EPSG:4326
Raw flowline features: 274
Clipped flowline features: 195
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/build/7c05951b1fab4b46abe4a886db0bd309.png" alt="&lt;Figure size 400x600 with 1 Axes&gt;"/></div></div></div><div id="loUyOLFcwo" class="myst-jp-nb-block relative group/block"><h2 id="id-6-monitoring-stations-coordinate-transformation-and-map-generation-peace-river" class="relative group"><span class="heading-text">6. Monitoring Stations, Coordinate Transformation, and Map Generation (Peace River)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-monitoring-stations-coordinate-transformation-and-map-generation-peace-river" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="CGG0W9AgFK" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import geopandas as gpd
import matplotlib.pyplot as plt
from shapely.geometry import Point
import contextily as cx
import matplotlib.lines as mlines

# -----------------------------------------------------------
# 1. PEACE RIVER STATION LOCATIONS (EDIT COORDS AS NEEDED)
# -----------------------------------------------------------
stations_peace_data = [
    {&quot;name&quot;: &quot;NEAR GARDNER&quot;,          &quot;lon&quot;: -81.8320229, &quot;lat&quot;: 27.3669874},
    {&quot;name&quot;: &quot;ARCADIA&quot;,               &quot;lon&quot;: -81.8761946, &quot;lat&quot;: 27.22088245},
    {&quot;name&quot;: &quot;NOCATEE&quot;,               &quot;lon&quot;: -81.90175090, &quot;lat&quot;: 27.16282928},
    {&quot;name&quot;: &quot;PEACE RIVER RESERVOIR&quot;, &quot;lon&quot;: -82.056225, &quot;lat&quot;: 27.056806},
]

stations_peace = gpd.GeoDataFrame(
    stations_peace_data,
    geometry=[Point(d[&quot;lon&quot;], d[&quot;lat&quot;]) for d in stations_peace_data],
    crs=&quot;EPSG:4326&quot;
)

# -----------------------------------------------------------
# 2. REPROJECT EVERYTHING TO WEB MERCATOR FOR BASEMAP
# -----------------------------------------------------------
target_crs = &quot;EPSG:3857&quot;

peace_ws_3857       = peace_ws.to_crs(target_crs)
peace_river_3857    = peace_river_clip.to_crs(target_crs)
stations_peace_3857 = stations_peace.to_crs(target_crs)

# -----------------------------------------------------------
# 3. CREATE FIGURE (TALL LIKE YOUR ADVISOR&#x27;S)
# -----------------------------------------------------------
fig, ax = plt.subplots(figsize=(4, 8), dpi=300)

# Watershed outline
peace_ws_3857.boundary.plot(ax=ax, color=&quot;black&quot;, linewidth=1)

# River line
peace_river_3857.plot(ax=ax, color=&quot;deepskyblue&quot;, linewidth=2)

# Stations
stations_peace_3857.plot(ax=ax, color=&quot;blue&quot;, markersize=25)

# -----------------------------------------------------------
# 4. LABELS WITH PER-STATION OFFSETS
# -----------------------------------------------------------
offsets_peace = {
    &quot;NEAR GARDNER&quot;:          ( 1500,  800),
    &quot;ARCADIA&quot;:               ( 1500,    0),
    &quot;NOCATEE&quot;:               ( 1500, -600),
    &quot;PEACE RIVER RESERVOIR&quot;: ( 1500, -800),
}

for x, y, label in zip(
        stations_peace_3857.geometry.x,
        stations_peace_3857.geometry.y,
        stations_peace_3857[&quot;name&quot;]):

    dx, dy = offsets_peace.get(label, (500, 500))
    ax.text(x + dx, y + dy, label, fontsize=6, color=&quot;navy&quot;)

# -----------------------------------------------------------
# 5. EXTENT, BASEMAP, LEGEND
# -----------------------------------------------------------
xmin, ymin, xmax, ymax = peace_ws_3857.total_bounds
pad = 5000  # meters of padding
ax.set_xlim(xmin - pad, xmax + pad)
ax.set_ylim(ymin - pad, ymax + pad)

# OSM basemap
cx.add_basemap(
    ax,
    source=cx.providers.OpenStreetMap.Mapnik,
    crs=target_crs,
    alpha=0.8
)

# Legend entries
station_handle = mlines.Line2D([], [], color=&quot;blue&quot;, marker=&quot;o&quot;,
                               linestyle=&quot;None&quot;, markersize=5,
                               label=&quot;Stations&quot;)
river_handle = mlines.Line2D([], [], color=&quot;deepskyblue&quot;,
                             linewidth=2, label=&quot;Peace River&quot;)

ax.legend(handles=[station_handle, river_handle],
          loc=&quot;upper right&quot;, fontsize=7, frameon=True)

ax.set_xticks([])
ax.set_yticks([])

plt.tight_layout()

# -----------------------------------------------------------
# 6. SAVE HIGH-RES IMAGE TO YOUR FOLDER
# -----------------------------------------------------------
plt.savefig(
    r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Peace River Watershed Graphics\peace_river_watershed_map.png&quot;,
    dpi=600,
    bbox_inches=&quot;tight&quot;
)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="qrPkGv6OM7TgpMWJTtaaO" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/build/4387b7a9617046081af15767454c2123.png" alt="&lt;Figure size 1200x2400 with 1 Axes&gt;"/></div></div></div><div id="xs6CGAHqSm" class="myst-jp-nb-block relative group/block"><h2 id="id-7-generate-side-by-side-graphic-of-watersheds" class="relative group"><span class="heading-text">7. Generate Side by Side Graphic of Watersheds</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-generate-side-by-side-graphic-of-watersheds" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="YB1cS3DRF4" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from PIL import Image
import matplotlib.pyplot as plt

# --- EDIT THESE PATHS to your actual saved map files ---
peace_png = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Peace River Watershed Graphics\peace_river_watershed_map.png&quot;
caloosa_png = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Caloosahatchee watershed Graphics\caloosahatchee_watershed_map.png&quot;

# Output file
out_png = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Figure_1_Study_Area_Peace_Caloosa.png&quot;

# Load images
img_peace = Image.open(peace_png)
img_caloosa = Image.open(caloosa_png)

# Make them the same height (keeps proportions clean)
target_h = max(img_peace.height, img_caloosa.height)

img_peace = img_peace.resize(
    (int(img_peace.width * target_h / img_peace.height), target_h)
)

img_caloosa = img_caloosa.resize(
    (int(img_caloosa.width * target_h / img_caloosa.height), target_h)
)

# Plot side-by-side
fig, axes = plt.subplots(1, 2, figsize=(10, 7), dpi=300)

axes[0].imshow(img_peace)
axes[0].axis(&quot;off&quot;)
axes[0].text(
    0.02, 0.98, &quot;(a)&quot;,
    transform=axes[0].transAxes,
    ha=&quot;left&quot;, va=&quot;top&quot;,
    fontsize=14,
    bbox=dict(facecolor=&quot;white&quot;, edgecolor=&quot;none&quot;, alpha=0.75)
)

axes[1].imshow(img_caloosa)
axes[1].axis(&quot;off&quot;)
axes[1].text(
    0.02, 0.98, &quot;(b)&quot;,
    transform=axes[1].transAxes,
    ha=&quot;left&quot;, va=&quot;top&quot;,
    fontsize=14,
    bbox=dict(facecolor=&quot;white&quot;, edgecolor=&quot;none&quot;, alpha=0.75)
)

plt.tight_layout()

# Save combined figure
plt.savefig(out_png, dpi=600, bbox_inches=&quot;tight&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Qwjtn5IEC4KjIc-thfayF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/build/e9329531ec1b75e37846eded759392c8.png" alt="&lt;Figure size 3000x2100 with 2 Axes&gt;"/></div></div></div><div id="HIfao11uZO" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from PIL import Image, ImageOps
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec

# -----------------------------------------------------------
# INPUT FILE PATHS (EDIT IF NEEDED)
# -----------------------------------------------------------
peace_png = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Peace River Watershed Graphics\peace_river_watershed_map.png&quot;
caloosa_png = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Caloosahatchee watershed Graphics\caloosahatchee_watershed_map.png&quot;

# OUTPUT FILE
out_png = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Figure_1_Study_Area_Peace_Caloosa_PUBLICATION.png&quot;

# -----------------------------------------------------------
# LOAD IMAGES (CONVERT RGBA → RGB TO AVOID PIL ERROR)
# -----------------------------------------------------------
imgA = Image.open(peace_png).convert(&quot;RGB&quot;)
imgB = Image.open(caloosa_png).convert(&quot;RGB&quot;)

# OPTIONAL: autocontrast to tighten whites (safe now)
imgA = ImageOps.autocontrast(imgA)
imgB = ImageOps.autocontrast(imgB)

# -----------------------------------------------------------
# RESIZE TO MATCH WIDTHS (MAKES PANELS FEEL BALANCED)
# -----------------------------------------------------------
target_width = 1400  # adjust if desired

imgA = imgA.resize(
    (target_width, int(imgA.height * target_width / imgA.width))
)
imgB = imgB.resize(
    (target_width, int(imgB.height * target_width / imgB.width))
)

# -----------------------------------------------------------
# CREATE GRID LAYOUT (PUBLICATION STYLE)
# -----------------------------------------------------------
fig = plt.figure(figsize=(10, 7), dpi=300)

gs = gridspec.GridSpec(
    2, 2,
    width_ratios=[1.0, 1.0],
    height_ratios=[1.0, 1.0],
    wspace=0.05,
    hspace=0.05
)

# (a) Peace River — left column, full height
axA = fig.add_subplot(gs[:, 0])
axA.imshow(imgA)
axA.axis(&quot;off&quot;)
axA.text(
    0.02, 0.98, &quot;(a)&quot;,
    transform=axA.transAxes,
    ha=&quot;left&quot;, va=&quot;top&quot;,
    fontsize=14,
    bbox=dict(facecolor=&quot;white&quot;, edgecolor=&quot;none&quot;, alpha=0.8)
)

# (b) Caloosahatchee — upper right
axB = fig.add_subplot(gs[0, 1])
axB.imshow(imgB)
axB.axis(&quot;off&quot;)
axB.text(
    0.02, 0.98, &quot;(b)&quot;,
    transform=axB.transAxes,
    ha=&quot;left&quot;, va=&quot;top&quot;,
    fontsize=14,
    bbox=dict(facecolor=&quot;white&quot;, edgecolor=&quot;none&quot;, alpha=0.8)
)

# Bottom-right intentionally blank (clean composition)
ax_blank = fig.add_subplot(gs[1, 1])
ax_blank.axis(&quot;off&quot;)

# -----------------------------------------------------------
# SAVE HIGH-RES FIGURE
# -----------------------------------------------------------
plt.savefig(out_png, dpi=600, bbox_inches=&quot;tight&quot;)
plt.show()

print(&quot;Saved publication figure to:&quot;)
print(out_png)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="totCzfGJGLZA2umqY0C_p" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/build/613cc96ccaa7c622e2c03e31701a49e8.png" alt="&lt;Figure size 3000x2100 with 3 Axes&gt;"/></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Saved publication figure to:
C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Figure_1_Study_Area_Peace_Caloosa_PUBLICATION.png
</span></code></pre></div></div></div></div><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/data-swfl-combined"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Red Tide Data and Modeling Book</div>Data Integration for Southwest Florida</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/ml-model-swfl-with-tampa"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Red Tide Data and Modeling Book</div>Machine Learning Model for Combined Peace River and Caloosahatchee River</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/build/_shared/chunk-OYMW4E3D.js"/><link rel="modulepreload" href="/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/build/root-CXYA7X5D.js"/><link rel="modulepreload" href="/build/_shared/chunk-DATP5P2X.js"/><link rel="modulepreload" href="/build/routes/$-JRBPULBO.js"/><script>window.__remixContext = {"url":"/watershed-graphics","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.7.1","options":{},"nav":[],"actions":[],"projects":[{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static"},"routes/$":{"config":{"version":3,"myst":"1.7.1","options":{},"nav":[],"actions":[],"projects":[{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":3,"kind":"Notebook","sha256":"5451951509a9058ef53b3f827e50510b713c21b9019a9a0b7dc9419f568c0d28","slug":"watershed-graphics","location":"/Watershed_Graphics.ipynb","dependencies":[],"frontmatter":{"title":"Watershed Study Area","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"exports":[{"format":"ipynb","filename":"Watershed_Graphics.ipynb","url":"/build/Watershed_Graphics-c57eb276dec8b291cd17bcacb088e603.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Caloosahatchee Watershed Boundary Extraction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a2clj3uKSC"}],"identifier":"id-1-caloosahatchee-watershed-boundary-extraction","label":"1. Caloosahatchee Watershed Boundary Extraction","html_id":"id-1-caloosahatchee-watershed-boundary-extraction","implicit":true,"key":"XnX5TOlLgG"}],"key":"AvbBekE6Z9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Caloosahatchee River watershed boundary was obtained from the USGS Watershed Boundary Dataset (WBD) by querying the hydrologic unit corresponding to HUC-8 03090205. The resulting polygon defines the official extent of the Caloosahatchee basin and serves as the spatial framework for subsequent mapping and analysis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IqnBhD499b"}],"key":"krzmlW4XUa"}],"key":"GZuxKkFVul"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import geopandas as gpd\n\nwbd_url = (\n    \"https://hydro.nationalmap.gov/arcgis/rest/services/wbd/MapServer/4/\"\n    \"query?where=HUC8%3D%2703090205%27\u0026outFields=*\u0026f=geojson\"\n)\n\ncaloosa = gpd.read_file(wbd_url)\n\nprint(caloosa.crs)   # just to see what it is\n\ncaloosa.plot(edgecolor=\"black\", facecolor=\"none\")","key":"gzTFoX8b2S"},{"type":"outputs","id":"vxlUQaG1f885YnT7-fL8s","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"EPSG:4326\n"},"children":[],"key":"cQLODSRrNM"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},"children":[],"key":"uTJXXZwXNP"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"015068ce12797aea21624c166b0bbd9a","path":"/build/015068ce12797aea21624c166b0bbd9a.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"DTO2V7H504"}],"key":"XOgC0dlINP"}],"key":"MwZti8nz3h"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Caloosahatchee River Flowline Extraction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KOOC5iXFf0"}],"identifier":"id-2-caloosahatchee-river-flowline-extraction","label":"2. Caloosahatchee River Flowline Extraction","html_id":"id-2-caloosahatchee-river-flowline-extraction","implicit":true,"key":"OCY9PAXxue"}],"key":"veBNbnYGju"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The main stem of the Caloosahatchee River was extracted from the USGS National Hydrography Dataset (NHD) using a name-based query of the NHD Flowline (Large Scale) layer. All polyline features associated with the “Caloosahatchee” GNIS name were retrieved, providing an accurate representation of the river’s course through the watershed.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YLRLt8n62e"}],"key":"rHhkkKXDqW"}],"key":"mmr9QYY1li"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import geopandas as gpd\n\n# NHD Flowline - Large Scale (layer 6), search by name\nnhd_url = (\n    \"https://hydro.nationalmap.gov/arcgis/rest/services/nhd/MapServer/6/\"\n    \"query?where=gnis_name%20LIKE%20%27Caloosahatchee%25%27\u0026outFields=*\u0026f=geojson\"\n)\n\nriver = gpd.read_file(nhd_url)\n\nprint(\"River CRS:\", river.crs)\nprint(\"Number of features:\", len(river))\n\nif len(river) \u003e 0:\n    ax = river.plot(color=\"deepskyblue\", linewidth=1)\nelse:\n    print(\"No features returned – name query didn't find anything.\")","key":"aGUnWUkj63"},{"type":"outputs","id":"m89ixx-dyCpHsV07vYlnf","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"River CRS: EPSG:4326\nNumber of features: 268\n"},"children":[],"key":"vTSMXdDCTH"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2d4937009af155fa8f8d70451e9629bb","path":"/build/2d4937009af155fa8f8d70451e9629bb.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"Mr6eTppl54"}],"key":"Z5mx35U59h"}],"key":"razquXeAta"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pip install contextily","key":"RaTkgkf8pl"},{"type":"outputs","id":"x4NlxEnpF7GFLP4CM_ljd","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Requirement already satisfied: contextily in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (1.6.2)\nRequirement already satisfied: geopy in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (2.4.1)\nRequirement already satisfied: matplotlib in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (3.10.0)\nRequirement already satisfied: mercantile in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (1.2.1)\nRequirement already satisfied: pillow in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (11.1.0)\nRequirement already satisfied: rasterio in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (1.4.3)\nRequirement already satisfied: requests in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (2.32.3)\nRequirement already satisfied: joblib in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (1.4.2)\nRequirement already satisfied: xyzservices in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from contextily) (2024.9.0)\nRequirement already satisfied: geographiclib\u003c3,\u003e=1.52 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from geopy-\u003econtextily) (2.0)\nRequirement already satisfied: contourpy\u003e=1.0.1 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (1.3.1)\nRequirement already satisfied: cycler\u003e=0.10 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (0.12.1)\nRequirement already satisfied: fonttools\u003e=4.22.0 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (4.55.3)\nRequirement already satisfied: kiwisolver\u003e=1.3.1 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (1.4.8)\nRequirement already satisfied: numpy\u003e=1.23 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (2.2.1)\nRequirement already satisfied: packaging\u003e=20.0 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (24.1)\nRequirement already satisfied: pyparsing\u003e=2.3.1 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (3.2.1)\nRequirement already satisfied: python-dateutil\u003e=2.7 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from matplotlib-\u003econtextily) (2.9.0.post0)\nRequirement already satisfied: click\u003e=3.0 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from mercantile-\u003econtextily) (8.1.8)\nRequirement already satisfied: affine in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from rasterio-\u003econtextily) (2.4.0)\nRequirement already satisfied: attrs in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from rasterio-\u003econtextily) (24.3.0)\nRequirement already satisfied: certifi in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from rasterio-\u003econtextily) (2024.8.30)\nRequirement already satisfied: cligj\u003e=0.5 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from rasterio-\u003econtextily) (0.7.2)\nRequirement already satisfied: click-plugins in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from rasterio-\u003econtextily) (1.1.1)\nRequirement already satisfied: charset-normalizer\u003c4,\u003e=2 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from requests-\u003econtextily) (3.3.2)\nRequirement already satisfied: idna\u003c4,\u003e=2.5 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from requests-\u003econtextily) (3.7)\nRequirement already satisfied: urllib3\u003c3,\u003e=1.21.1 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from requests-\u003econtextily) (2.2.3)\nRequirement already satisfied: colorama in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from click\u003e=3.0-\u003emercantile-\u003econtextily) (0.4.6)\nRequirement already satisfied: six\u003e=1.5 in c:\\users\\mkduu\\miniconda3\\lib\\site-packages (from python-dateutil\u003e=2.7-\u003ematplotlib-\u003econtextily) (1.17.0)\nNote: you may need to restart the kernel to use updated packages.\n"},"children":[],"key":"gSnIgcE5A0"}],"key":"jLd5iyv8R7"}],"key":"NLODAX6z3F"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. Monitoring Stations, Coordinate Transformation, and Map Generation (Caloosahatchee)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mCkcwJSzzs"}],"identifier":"id-3-monitoring-stations-coordinate-transformation-and-map-generation-caloosahatchee","label":"3. Monitoring Stations, Coordinate Transformation, and Map Generation (Caloosahatchee)","html_id":"id-3-monitoring-stations-coordinate-transformation-and-map-generation-caloosahatchee","implicit":true,"key":"tquCc8c427"}],"key":"ttQyTuPGbp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Monitoring station coordinates were compiled and converted into a geospatial dataset for inclusion on the study-area map. All spatial layers—including the watershed boundary, river flowline, and station locations—were reprojected to the Web Mercator coordinate system (EPSG:3857) to ensure compatibility with the OpenStreetMap basemap. These layers were then combined to generate a composite map of the Caloosahatchee watershed, providing a clear visualization of the basin, the river’s course, and the associated monitoring locations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nXfwn1wMhr"}],"key":"tjk4GBNMUT"}],"key":"FkaJkmWhiy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import geopandas as gpd\nimport matplotlib.pyplot as plt\nfrom shapely.geometry import Point\nimport contextily as cx\nimport matplotlib.lines as mlines\n\n# -----------------------------------------------------------\n# 1. STATION LOCATIONS (EDIT COORDS AS NEEDED)\n# -----------------------------------------------------------\nstations_data = [\n    {\"name\": \"S-79 NEAR OLGA\",        \"lon\": -81.7760, \"lat\": 26.7150},\n    {\"name\": \"CALOOSAHATCHEE BRIDGE\", \"lon\": -81.8780, \"lat\": 26.6400},\n    {\"name\": \"DEEP LAGOON\",           \"lon\": -81.9530, \"lat\": 26.5600},\n]\n\nstations = gpd.GeoDataFrame(\n    stations_data,\n    geometry=[Point(d[\"lon\"], d[\"lat\"]) for d in stations_data],\n    crs=\"EPSG:4326\"\n)\n\n# -----------------------------------------------------------\n# 2. PROJECT EVERYTHING TO WEB MERCATOR FOR BASEMAP\n# -----------------------------------------------------------\ntarget_crs = \"EPSG:3857\"\n\ncaloosa_3857 = caloosa.to_crs(target_crs)\nriver_3857   = river.to_crs(target_crs)\nstations_3857 = stations.to_crs(target_crs)\n\n# -----------------------------------------------------------\n# 3. START FIGURE\n# -----------------------------------------------------------\nfig, ax = plt.subplots(figsize=(4, 6), dpi=300)\n\n# Watershed outline\ncaloosa_3857.boundary.plot(ax=ax, color=\"black\", linewidth=1)\n\n# River line\nriver_3857.plot(ax=ax, color=\"deepskyblue\", linewidth=2)\n\n# Stations\nstations_3857.plot(ax=ax, color=\"blue\", markersize=25)\n\n# -----------------------------------------------------------\n# 4. PER-STATION LABEL OFFSETS (for cleaner labeling)\n# -----------------------------------------------------------\noffsets = {\n    \"S-79 NEAR OLGA\":        ( 2000,  700),\n    \"CALOOSAHATCHEE BRIDGE\": ( 2000,    0),\n    \"DEEP LAGOON\":           ( 2000, -800),\n}\n\nfor x, y, label in zip(\n        stations_3857.geometry.x,\n        stations_3857.geometry.y,\n        stations_3857[\"name\"]):\n    \n    dx, dy = offsets.get(label, (500, 500))\n    \n    ax.text(\n        x + dx,\n        y + dy,\n        label,\n        fontsize=6,\n        color=\"navy\",\n    )\n\n# -----------------------------------------------------------\n# 5. BASEMAP + EXTENT + LEGEND\n# -----------------------------------------------------------\nxmin, ymin, xmax, ymax = caloosa_3857.total_bounds\npad = 5000   # meters of padding around bounding box\n\nax.set_xlim(xmin - pad, xmax + pad)\nax.set_ylim(ymin - pad, ymax + pad)\n\n# Add OpenStreetMap basemap\ncx.add_basemap(\n    ax,\n    source=cx.providers.OpenStreetMap.Mapnik,\n    crs=target_crs,\n    alpha=0.8\n)\n\n# Legend handles\nstation_handle = mlines.Line2D(\n    [], [], color=\"blue\", marker=\"o\", linestyle=\"None\",\n    markersize=5, label=\"Stations\"\n)\nriver_handle = mlines.Line2D(\n    [], [], color=\"deepskyblue\", linewidth=2,\n    label=\"Caloosahatchee River\"\n)\n\nax.legend(handles=[station_handle, river_handle],\n          loc=\"upper right\", fontsize=7, frameon=True)\n\n# Remove axes ticks\nax.set_xticks([])\nax.set_yticks([])\n\nplt.tight_layout()\n\n# -----------------------------------------------------------\n# 6. SAVE HIGH-RES EXPORT\n# -----------------------------------------------------------\nplt.savefig(\"caloosahatchee_watershed_map.png\", dpi=600, bbox_inches=\"tight\")\nplt.savefig(\n    \"caloosahatchee_watershed_map.png\",\n    dpi=600,\n    bbox_inches=\"tight\"\n)\nplt.savefig(\n    r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Caloosahatchee watershed Graphics\\caloosahatchee_watershed_map.png\",\n    dpi=600,\n    bbox_inches=\"tight\"\n)\nplt.show()","key":"ppIRqHDhs0"},{"type":"outputs","id":"YploTJUGKf1osKgc0J5w_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6c267bd0d10aa418d138fcdec0290270","path":"/build/6c267bd0d10aa418d138fcdec0290270.png"},"text/plain":{"content":"\u003cFigure size 1200x1800 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"iedRRTMPPJ"}],"key":"QxkQ5jnMIC"}],"key":"N7Swio0kbG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Peace River Watershed Boundary Extraction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J3S43RX21k"}],"identifier":"id-4-peace-river-watershed-boundary-extraction","label":"4. Peace River Watershed Boundary Extraction","html_id":"id-4-peace-river-watershed-boundary-extraction","implicit":true,"key":"T5liTq1FQn"}],"key":"jX3fvKZxi8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import geopandas as gpd\n\n# Peace River HUC-8 from USGS WBD\nwbd_url_peace = (\n    \"https://hydro.nationalmap.gov/arcgis/rest/services/wbd/MapServer/4/\"\n    \"query?where=HUC8%3D%2703100101%27\u0026outFields=*\u0026f=geojson\"\n)\n\npeace_ws = gpd.read_file(wbd_url_peace)\n\nprint(peace_ws.crs)\npeace_ws.plot(edgecolor=\"black\", facecolor=\"none\")\n","key":"zdOZ2xewGn"},{"type":"outputs","id":"iRiGiYQ9JNIHRXVxek1CQ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"EPSG:4326\n"},"children":[],"key":"Tjevio3fLd"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/plain":{"content":"\u003cAxes: \u003e","content_type":"text/plain"}}},"children":[],"key":"kvh9liXek2"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"76c6879485b21afc35aa12a7254bfe1b","path":"/build/76c6879485b21afc35aa12a7254bfe1b.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"k6IKcL7E5r"}],"key":"O2WA63XL8p"}],"key":"HLnMvtnx1Q"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5. Peace River Flowline From NHD","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iownAxFjCe"}],"identifier":"id-5-peace-river-flowline-from-nhd","label":"5. Peace River Flowline From NHD","html_id":"id-5-peace-river-flowline-from-nhd","implicit":true,"key":"Tlx4lCYMgp"}],"key":"GEB9aT6erd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import geopandas as gpd\n\n# ---------------------------------------------------------------------\n# 1. Peace River watershed boundary (HUC-8: 03100101)\n# ---------------------------------------------------------------------\nwbd_url_peace = (\n    \"https://hydro.nationalmap.gov/arcgis/rest/services/wbd/MapServer/4/\"\n    \"query?where=HUC8%3D%2703100101%27\u0026outFields=*\u0026f=geojson\"\n)\n\npeace_ws = gpd.read_file(wbd_url_peace)\nprint(\"Peace WS CRS:\", peace_ws.crs)\n\n# ---------------------------------------------------------------------\n# 2. Peace River flowlines from NHD (often returns extra junk)\n# ---------------------------------------------------------------------\nnhd_url_peace = (\n    \"https://hydro.nationalmap.gov/arcgis/rest/services/nhd/MapServer/6/\"\n    \"query?where=gnis_name%20LIKE%20%27Peace%20River%25%27\u0026outFields=*\u0026f=geojson\"\n)\n\npeace_river = gpd.read_file(nhd_url_peace)\nprint(\"Raw flowline features:\", len(peace_river))\n\n# ---------------------------------------------------------------------\n# 3. Clip flowlines to the watershed to remove stray segments\n# ---------------------------------------------------------------------\n# Ensure CRS matches\npeace_ws = peace_ws.to_crs(peace_river.crs)\n\npeace_river_clip = gpd.overlay(peace_river, peace_ws, how=\"intersection\")\nprint(\"Clipped flowline features:\", len(peace_river_clip))\n\n# ---------------------------------------------------------------------\n# 4. Plot result\n# ---------------------------------------------------------------------\nax = peace_ws.plot(edgecolor=\"black\", facecolor=\"none\", figsize=(4, 6))\npeace_river_clip.plot(ax=ax, color=\"deepskyblue\", linewidth=1)\n\nplt.title(\"Peace River Flowline (Clipped to Watershed)\")\nplt.show()","key":"D5wobZsD7C"},{"type":"outputs","id":"Idr6sG47OoAZnqDavgP7p","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Peace WS CRS: EPSG:4326\nRaw flowline features: 274\nClipped flowline features: 195\n"},"children":[],"key":"caNIwhvLAS"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7c05951b1fab4b46abe4a886db0bd309","path":"/build/7c05951b1fab4b46abe4a886db0bd309.png"},"text/plain":{"content":"\u003cFigure size 400x600 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"Dhkk7vrIoH"}],"key":"T4UkblDQ7T"}],"key":"wK0ahFnEXv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6. Monitoring Stations, Coordinate Transformation, and Map Generation (Peace River)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H516gDzrmU"}],"identifier":"id-6-monitoring-stations-coordinate-transformation-and-map-generation-peace-river","label":"6. Monitoring Stations, Coordinate Transformation, and Map Generation (Peace River)","html_id":"id-6-monitoring-stations-coordinate-transformation-and-map-generation-peace-river","implicit":true,"key":"wg0aTVcmiX"}],"key":"loUyOLFcwo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import geopandas as gpd\nimport matplotlib.pyplot as plt\nfrom shapely.geometry import Point\nimport contextily as cx\nimport matplotlib.lines as mlines\n\n# -----------------------------------------------------------\n# 1. PEACE RIVER STATION LOCATIONS (EDIT COORDS AS NEEDED)\n# -----------------------------------------------------------\nstations_peace_data = [\n    {\"name\": \"NEAR GARDNER\",          \"lon\": -81.8320229, \"lat\": 27.3669874},\n    {\"name\": \"ARCADIA\",               \"lon\": -81.8761946, \"lat\": 27.22088245},\n    {\"name\": \"NOCATEE\",               \"lon\": -81.90175090, \"lat\": 27.16282928},\n    {\"name\": \"PEACE RIVER RESERVOIR\", \"lon\": -82.056225, \"lat\": 27.056806},\n]\n\nstations_peace = gpd.GeoDataFrame(\n    stations_peace_data,\n    geometry=[Point(d[\"lon\"], d[\"lat\"]) for d in stations_peace_data],\n    crs=\"EPSG:4326\"\n)\n\n# -----------------------------------------------------------\n# 2. REPROJECT EVERYTHING TO WEB MERCATOR FOR BASEMAP\n# -----------------------------------------------------------\ntarget_crs = \"EPSG:3857\"\n\npeace_ws_3857       = peace_ws.to_crs(target_crs)\npeace_river_3857    = peace_river_clip.to_crs(target_crs)\nstations_peace_3857 = stations_peace.to_crs(target_crs)\n\n# -----------------------------------------------------------\n# 3. CREATE FIGURE (TALL LIKE YOUR ADVISOR'S)\n# -----------------------------------------------------------\nfig, ax = plt.subplots(figsize=(4, 8), dpi=300)\n\n# Watershed outline\npeace_ws_3857.boundary.plot(ax=ax, color=\"black\", linewidth=1)\n\n# River line\npeace_river_3857.plot(ax=ax, color=\"deepskyblue\", linewidth=2)\n\n# Stations\nstations_peace_3857.plot(ax=ax, color=\"blue\", markersize=25)\n\n# -----------------------------------------------------------\n# 4. LABELS WITH PER-STATION OFFSETS\n# -----------------------------------------------------------\noffsets_peace = {\n    \"NEAR GARDNER\":          ( 1500,  800),\n    \"ARCADIA\":               ( 1500,    0),\n    \"NOCATEE\":               ( 1500, -600),\n    \"PEACE RIVER RESERVOIR\": ( 1500, -800),\n}\n\nfor x, y, label in zip(\n        stations_peace_3857.geometry.x,\n        stations_peace_3857.geometry.y,\n        stations_peace_3857[\"name\"]):\n\n    dx, dy = offsets_peace.get(label, (500, 500))\n    ax.text(x + dx, y + dy, label, fontsize=6, color=\"navy\")\n\n# -----------------------------------------------------------\n# 5. EXTENT, BASEMAP, LEGEND\n# -----------------------------------------------------------\nxmin, ymin, xmax, ymax = peace_ws_3857.total_bounds\npad = 5000  # meters of padding\nax.set_xlim(xmin - pad, xmax + pad)\nax.set_ylim(ymin - pad, ymax + pad)\n\n# OSM basemap\ncx.add_basemap(\n    ax,\n    source=cx.providers.OpenStreetMap.Mapnik,\n    crs=target_crs,\n    alpha=0.8\n)\n\n# Legend entries\nstation_handle = mlines.Line2D([], [], color=\"blue\", marker=\"o\",\n                               linestyle=\"None\", markersize=5,\n                               label=\"Stations\")\nriver_handle = mlines.Line2D([], [], color=\"deepskyblue\",\n                             linewidth=2, label=\"Peace River\")\n\nax.legend(handles=[station_handle, river_handle],\n          loc=\"upper right\", fontsize=7, frameon=True)\n\nax.set_xticks([])\nax.set_yticks([])\n\nplt.tight_layout()\n\n# -----------------------------------------------------------\n# 6. SAVE HIGH-RES IMAGE TO YOUR FOLDER\n# -----------------------------------------------------------\nplt.savefig(\n    r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Peace River Watershed Graphics\\peace_river_watershed_map.png\",\n    dpi=600,\n    bbox_inches=\"tight\"\n)\n\nplt.show()","key":"pqvSFDnqem"},{"type":"outputs","id":"qrPkGv6OM7TgpMWJTtaaO","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4387b7a9617046081af15767454c2123","path":"/build/4387b7a9617046081af15767454c2123.png"},"text/plain":{"content":"\u003cFigure size 1200x2400 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"UaLQy6TRmm"}],"key":"rR3jL2FhZF"}],"key":"CGG0W9AgFK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7. Generate Side by Side Graphic of Watersheds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zPxPxXwKXe"}],"identifier":"id-7-generate-side-by-side-graphic-of-watersheds","label":"7. Generate Side by Side Graphic of Watersheds","html_id":"id-7-generate-side-by-side-graphic-of-watersheds","implicit":true,"key":"nbxijEHb4Z"}],"key":"xs6CGAHqSm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from PIL import Image\nimport matplotlib.pyplot as plt\n\n# --- EDIT THESE PATHS to your actual saved map files ---\npeace_png = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Peace River Watershed Graphics\\peace_river_watershed_map.png\"\ncaloosa_png = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Caloosahatchee watershed Graphics\\caloosahatchee_watershed_map.png\"\n\n# Output file\nout_png = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Figure_1_Study_Area_Peace_Caloosa.png\"\n\n# Load images\nimg_peace = Image.open(peace_png)\nimg_caloosa = Image.open(caloosa_png)\n\n# Make them the same height (keeps proportions clean)\ntarget_h = max(img_peace.height, img_caloosa.height)\n\nimg_peace = img_peace.resize(\n    (int(img_peace.width * target_h / img_peace.height), target_h)\n)\n\nimg_caloosa = img_caloosa.resize(\n    (int(img_caloosa.width * target_h / img_caloosa.height), target_h)\n)\n\n# Plot side-by-side\nfig, axes = plt.subplots(1, 2, figsize=(10, 7), dpi=300)\n\naxes[0].imshow(img_peace)\naxes[0].axis(\"off\")\naxes[0].text(\n    0.02, 0.98, \"(a)\",\n    transform=axes[0].transAxes,\n    ha=\"left\", va=\"top\",\n    fontsize=14,\n    bbox=dict(facecolor=\"white\", edgecolor=\"none\", alpha=0.75)\n)\n\naxes[1].imshow(img_caloosa)\naxes[1].axis(\"off\")\naxes[1].text(\n    0.02, 0.98, \"(b)\",\n    transform=axes[1].transAxes,\n    ha=\"left\", va=\"top\",\n    fontsize=14,\n    bbox=dict(facecolor=\"white\", edgecolor=\"none\", alpha=0.75)\n)\n\nplt.tight_layout()\n\n# Save combined figure\nplt.savefig(out_png, dpi=600, bbox_inches=\"tight\")\nplt.show()","key":"SlIi6exAXh"},{"type":"outputs","id":"Qwjtn5IEC4KjIc-thfayF","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e9329531ec1b75e37846eded759392c8","path":"/build/e9329531ec1b75e37846eded759392c8.png"},"text/plain":{"content":"\u003cFigure size 3000x2100 with 2 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"EWGTadG5wC"}],"key":"DLOsGw0XDm"}],"key":"YB1cS3DRF4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from PIL import Image, ImageOps\nimport matplotlib.pyplot as plt\nimport matplotlib.gridspec as gridspec\n\n# -----------------------------------------------------------\n# INPUT FILE PATHS (EDIT IF NEEDED)\n# -----------------------------------------------------------\npeace_png = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Peace River Watershed Graphics\\peace_river_watershed_map.png\"\ncaloosa_png = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Caloosahatchee watershed Graphics\\caloosahatchee_watershed_map.png\"\n\n# OUTPUT FILE\nout_png = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Figure_1_Study_Area_Peace_Caloosa_PUBLICATION.png\"\n\n# -----------------------------------------------------------\n# LOAD IMAGES (CONVERT RGBA → RGB TO AVOID PIL ERROR)\n# -----------------------------------------------------------\nimgA = Image.open(peace_png).convert(\"RGB\")\nimgB = Image.open(caloosa_png).convert(\"RGB\")\n\n# OPTIONAL: autocontrast to tighten whites (safe now)\nimgA = ImageOps.autocontrast(imgA)\nimgB = ImageOps.autocontrast(imgB)\n\n# -----------------------------------------------------------\n# RESIZE TO MATCH WIDTHS (MAKES PANELS FEEL BALANCED)\n# -----------------------------------------------------------\ntarget_width = 1400  # adjust if desired\n\nimgA = imgA.resize(\n    (target_width, int(imgA.height * target_width / imgA.width))\n)\nimgB = imgB.resize(\n    (target_width, int(imgB.height * target_width / imgB.width))\n)\n\n# -----------------------------------------------------------\n# CREATE GRID LAYOUT (PUBLICATION STYLE)\n# -----------------------------------------------------------\nfig = plt.figure(figsize=(10, 7), dpi=300)\n\ngs = gridspec.GridSpec(\n    2, 2,\n    width_ratios=[1.0, 1.0],\n    height_ratios=[1.0, 1.0],\n    wspace=0.05,\n    hspace=0.05\n)\n\n# (a) Peace River — left column, full height\naxA = fig.add_subplot(gs[:, 0])\naxA.imshow(imgA)\naxA.axis(\"off\")\naxA.text(\n    0.02, 0.98, \"(a)\",\n    transform=axA.transAxes,\n    ha=\"left\", va=\"top\",\n    fontsize=14,\n    bbox=dict(facecolor=\"white\", edgecolor=\"none\", alpha=0.8)\n)\n\n# (b) Caloosahatchee — upper right\naxB = fig.add_subplot(gs[0, 1])\naxB.imshow(imgB)\naxB.axis(\"off\")\naxB.text(\n    0.02, 0.98, \"(b)\",\n    transform=axB.transAxes,\n    ha=\"left\", va=\"top\",\n    fontsize=14,\n    bbox=dict(facecolor=\"white\", edgecolor=\"none\", alpha=0.8)\n)\n\n# Bottom-right intentionally blank (clean composition)\nax_blank = fig.add_subplot(gs[1, 1])\nax_blank.axis(\"off\")\n\n# -----------------------------------------------------------\n# SAVE HIGH-RES FIGURE\n# -----------------------------------------------------------\nplt.savefig(out_png, dpi=600, bbox_inches=\"tight\")\nplt.show()\n\nprint(\"Saved publication figure to:\")\nprint(out_png)","key":"uoDN0tfgNx"},{"type":"outputs","id":"totCzfGJGLZA2umqY0C_p","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"613cc96ccaa7c622e2c03e31701a49e8","path":"/build/613cc96ccaa7c622e2c03e31701a49e8.png"},"text/plain":{"content":"\u003cFigure size 3000x2100 with 3 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"SSCE989n6i"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Saved publication figure to:\nC:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Figure_1_Study_Area_Peace_Caloosa_PUBLICATION.png\n"},"children":[],"key":"XlNUavMccS"}],"key":"If0nQfDzro"}],"key":"HIfao11uZO"}],"key":"R77VFG9Hol"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Data Integration for Southwest Florida","url":"/data-swfl-combined","group":"Red Tide Data and Modeling Book"},"next":{"title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","url":"/ml-model-swfl-with-tampa","group":"Red Tide Data and Modeling Book"}}},"domain":"http://localhost:3000"},"project":{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/build/manifest-86A905A4.js";
import * as route0 from "/build/root-CXYA7X5D.js";
import * as route1 from "/build/routes/$-JRBPULBO.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/build/entry.client-PCJPW7TK.js");</script></body></html>