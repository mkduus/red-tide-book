<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Data Integration for Southwest Florida - Red Tide Data and Modeling Book</title><meta property="og:title" content="Data Integration for Southwest Florida - Red Tide Data and Modeling Book"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><link rel="stylesheet" href="/red-tide-book//build/_assets/app-AIT5GAEP.css"/><link rel="stylesheet" href="/red-tide-book//build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/red-tide-book//favicon.ico"/><link rel="stylesheet" href="/red-tide-book//myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100vw;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/red-tide-book//"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="Red Tide Data and Modeling Book" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/red-tide-book//">Red Tide Data and Modeling Book</a><a title="Data Integration for Southwest Florida" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/red-tide-book//data-swfl-combined">Data Integration for Southwest Florida</a><a title="Watershed Study Area" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/red-tide-book//watershed-graphics">Watershed Study Area</a><a title="Machine Learning Model for Combined Peace River and Caloosahatchee River" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/red-tide-book//ml-model-swfl-with-tampa">Machine Learning Model for Combined Peace River and Caloosahatchee River</a></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"></div><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Data Integration for Southwest Florida</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">Matthew Duus</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="VtdoVWIF2S" class="myst-jp-nb-block relative group/block"><h2 id="id-1-discharge-monitoring-at-s-r-79-on-the-caloosahatchee-river" class="relative group"><span class="heading-text">1. Discharge Monitoring at S.R.-79 on the Caloosahatchee River</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-discharge-monitoring-at-s-r-79-on-the-caloosahatchee-river" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="yhOpBLusT1" class="myst-jp-nb-block relative group/block"><h3 id="id-1-1-selecting-discharge-station-on-caloosahatchee-river" class="relative group"><span class="heading-text">1.1 Selecting Discharge Station on Caloosahatchee River</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-1-selecting-discharge-station-on-caloosahatchee-river" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="iXkgvbqqvO" class="myst-jp-nb-block relative group/block"><p>The USGS site number 02292900 corresponds to the streamflow monitoring station at the Caloosahatchee River at S.R.-79 near Olga, Florida. This station, also known as the Franklin Lock and Dam (S-79), has been operational since 1966 and is a key point for monitoring freshwater flow into the Caloosahatchee Estuary.</p><p>This site is managed by the U.S. Geological Survey (USGS) and provides real-time and historical data on streamflow, which is crucial for water resource management, ecological studies, and flood forecasting.</p><p>USGS site data: <a target="_blank" rel="noreferrer" href="https://waterdata.usgs.gov/nwis/inventory?site_no=02292900" class="">https://<wbr/>waterdata<wbr/>.usgs<wbr/>.gov<wbr/>/nwis<wbr/>/inventory<wbr/>?site<wbr/>_no<wbr/>=<wbr/>02292900</a></p></div><div id="JN9qo3Knvw" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd
import os
import pandas as pd
import requests
import zipfile
from io import BytesIO
import shutil

df_dis = pd.read_csv(&#x27;USGS Data Science Project.csv&#x27;)
df_dis</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="OOSCfuO9AIjO_0mzrbzbK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="K2zM0VIzSG" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df_dis.Date = pd.to_datetime(df_dis.Date)
df_dis.Date.dtypes</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Ko1qmhht1HrEld_A4KQ4J" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-text" class="font-mono text-sm whitespace-pre-wrap myst-jp-safe-output-text"><code><span>dtype(&#x27;&lt;M8[ns]&#x27;)</span></code></div></div></div><div id="tbecjQXsSW" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">columns = [&#x27;Source&#x27;, &#x27;Site Number&#x27;, &#x27;Date&#x27;, &#x27;Discharge&#x27;]
df_dis = df_dis[columns]
df_dis</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="h5R3p2haotnmdgT-WahSq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="srg3UOFXRN" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Data cleaned
df_dis_clean = df_dis.dropna()

parameters = [&#x27;Discharge&#x27;]
units = [&#x27;cfs&#x27;]

metadata = {
    &#x27;Discharge&#x27;: {&#x27;Unit&#x27;: &#x27;cfs&#x27;}
}

summary_data = []

for column in df_dis.columns:
    if column not in metadata:
        continue

    col_data = df_dis[column].dropna()
    stats = {
        &#x27;Parameter&#x27;: column,
        &#x27;Unit&#x27;: metadata[column][&#x27;Unit&#x27;],
        &#x27;Min&#x27;: round(col_data.min(), 2),
        &#x27;Mean&#x27;: round(col_data.mean(), 2),
        &#x27;Median&#x27;: round(col_data.median(), 2),
        &#x27;Max&#x27;: round(col_data.max(), 2)
    }
    summary_data.append(stats)

df_dis_summary = pd.DataFrame(summary_data)
display(df_dis_summary)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Ga9dQCMk8m0FFPuJm9P2G" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="OTlYiOeTjl" class="myst-jp-nb-block relative group/block"><h3 id="id-1-2-caloosahatchee-river-discharge" class="relative group"><span class="heading-text">1.2 Caloosahatchee River Discharge</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-2-caloosahatchee-river-discharge" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="uqxpaetEy1" class="myst-jp-nb-block relative group/block"><p>This section processes discharge data from the Caloosahatchee River at the S-79 structure, obtained from the USGS. The data is filtered to retain daily mean discharge values, and timestamps are converted to datetime format for alignment with other environmental datasets. The section ensures the discharge values are numeric and drops any rows with missing data.</p></div><div id="LzpWJutcq6" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import matplotlib.dates as mdates

# Line plot of discharge
df_dis[[&#x27;Discharge&#x27;]].plot(
    color=[&#x27;blue&#x27;],
    linewidth=1,
    xlabel=&#x27;Date&#x27;,
    ylabel=&#x27;Discharge_Dis [cfs]&#x27;,
    figsize=(16, 7),
    title=&#x27;Caloosahatchee River Discharge&#x27;,
    grid=False,
    legend=True,
    style=[&#x27;-&#x27;],
    alpha=0.8,
    rot=0,
    fontsize=12,
);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="rmsGF_aa8dM1W9y4hlccF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/0ba468079c62eb95a24398120a09c217.png" alt="&lt;Figure size 1600x700 with 1 Axes&gt;"/></div></div></div><div id="IptkqgbDUR" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">max_discharge_dis = df_dis[&#x27;Discharge&#x27;].max()
print(max_discharge_dis)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="yCt3vvtYUNCzJT2cRlgm3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>25300.0
</span></code></pre></div></div></div></div><div id="ZgEMslCsus" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">avg_discharge_dis = df_dis[&#x27;Discharge&#x27;].mean()
print(avg_discharge_dis)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="4ylrY8xPfHarL9i85-aLA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>2104.5010027425437
</span></code></pre></div></div></div></div><div id="ueLB3q7S1I" class="myst-jp-nb-block relative group/block"><h3 id="id-1-3-creating-a-continuous-discharge-record" class="relative group"><span class="heading-text">1.3 Creating a Continuous Discharge Record</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-3-creating-a-continuous-discharge-record" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="NvOmdODhC0" class="myst-jp-nb-block relative group/block"><p>This section addresses gaps in the Caloosahatchee River discharge dataset by applying interpolation and filling techniques. Missing discharge values are first replaced with NaNs, then interpolated linearly to estimate intermediate values. Any remaining missing values at the start or end of the series are filled using forward and backward fill methods. The cleaned and gap-filled dataset is then visualized in a time series plot spanning from 1993 to 2025, showing the long-term variability in daily discharge rates. This step ensures a continuous discharge record for use in later modeling and analysis.</p></div><div id="QxbgenJ5O5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Replace 0s with NaN in &#x27;Discharge&#x27; column
df_dis.loc[:, &#x27;Discharge&#x27;] = df_dis[&#x27;Discharge&#x27;].replace(0, pd.NA)

# Interpolate missing values linearly
df_dis.loc[:, &#x27;Discharge&#x27;] = df_dis[&#x27;Discharge&#x27;].interpolate(method=&#x27;linear&#x27;)

# Fill remaining NaNs at the start/end using forward/backward fill
df_dis.loc[:, &#x27;Discharge&#x27;] = df_dis[&#x27;Discharge&#x27;].ffill().bfill()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="yjI3yLYvUYPg9AZQKx1mf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\2941276119.py:2: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value &#x27;[14.0 160.0 820.0 ... 1050.0 849.0 1050.0]&#x27; has dtype incompatible with float64, please explicitly cast to a compatible dtype first.
  df_dis.loc[:, &#x27;Discharge&#x27;] = df_dis[&#x27;Discharge&#x27;].replace(0, pd.NA)
C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\2941276119.py:5: FutureWarning: Series.interpolate with object dtype is deprecated and will raise in a future version. Call obj.infer_objects(copy=False) before interpolating instead.
  df_dis.loc[:, &#x27;Discharge&#x27;] = df_dis[&#x27;Discharge&#x27;].interpolate(method=&#x27;linear&#x27;)
C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\2941276119.py:8: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option(&#x27;future.no_silent_downcasting&#x27;, True)`
  df_dis.loc[:, &#x27;Discharge&#x27;] = df_dis[&#x27;Discharge&#x27;].ffill().bfill()
</span></code></pre></div></div></div></div><div id="ImQmJXxpqo" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import matplotlib.dates as mdates

# Ensure &#x27;Date&#x27; is datetime
df_dis[&#x27;Date&#x27;] = pd.to_datetime(df_dis[&#x27;Date&#x27;])

# Create plot
plt.figure(num=18, figsize=(16, 7))
plt.plot(df_dis[&#x27;Date&#x27;], df_dis[&#x27;Discharge&#x27;], color=&#x27;blue&#x27;, linewidth=1, linestyle=&#x27;-&#x27;, alpha=0.8, label=&#x27;Discharge&#x27;)

# Format x-axis
plt.gca().xaxis.set_major_locator(mdates.YearLocator())
plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(&#x27;%Y&#x27;))
plt.xlim(df_dis[&#x27;Date&#x27;].min(), df_dis[&#x27;Date&#x27;].max())

# Add horizontal line at 0
plt.axhline(y=0, color=&#x27;black&#x27;, linestyle=&#x27;--&#x27;, linewidth=1)

# Labels and formatting
plt.xlabel(&#x27;Date&#x27;, fontsize=12)
plt.ylabel(&#x27;Discharge [cfs]&#x27;, fontsize=12)
plt.title(&#x27;Caloosahatchee River Discharge&#x27;, fontsize=20)
plt.legend()
plt.grid(True)
plt.xticks(rotation=0)
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Anl6oK6G1O7zyNavwZDFm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\3119331194.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_dis[&#x27;Date&#x27;] = pd.to_datetime(df_dis[&#x27;Date&#x27;])
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/595400aaedc6c60c02b6065e67fed51b.png" alt="&lt;Figure size 1600x700 with 1 Axes&gt;"/></div></div></div><div id="xAlPDuKy1S" class="myst-jp-nb-block relative group/block"><h3 id="id-1-4-discharge-with-hurricane-season-noted" class="relative group"><span class="heading-text">1.4 Discharge With Hurricane Season Noted</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-4-discharge-with-hurricane-season-noted" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="hzNyjF2luY" class="myst-jp-nb-block relative group/block"><p>This section enhances the Caloosahatchee River discharge time series by visually marking the Atlantic hurricane season (June 1 to November 30) for each year in the dataset. Using a loop, shaded bands are dynamically added to the plot for every hurricane season between 1993 and 2025. This contextual overlay allows for a clearer visual association between periods of heightened tropical activity and observed discharge spikes. By highlighting these seasonal windows, the plot provides insight into how discharge patterns may be influenced by rainfall and runoff associated with hurricanes and tropical storms, which are relevant for nutrient loading and potential HAB triggers.</p></div><div id="fesJt1gt6K" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from datetime import datetime

plt.figure(num=19, figsize=(16, 7))
plt.plot(df_dis[&#x27;Date&#x27;], df_dis[&#x27;Discharge&#x27;], color=&#x27;blue&#x27;, linewidth=1, linestyle=&#x27;-&#x27;, alpha=0.8, label=&#x27;Discharge&#x27;)

plt.gca().xaxis.set_major_locator(mdates.YearLocator())
plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(&#x27;%Y&#x27;))
plt.xlim(df_dis[&#x27;Date&#x27;].min(), df_dis[&#x27;Date&#x27;].max())

# Highlight hurricane season
years = df_dis[&#x27;Date&#x27;].dt.year.unique()
for year in years:
    start = pd.Timestamp(f&quot;{year}-06-01&quot;)
    end = pd.Timestamp(f&quot;{year}-11-30&quot;)
    plt.axvspan(start, end, color=&#x27;orange&#x27;, alpha=0.125, label=&#x27;Hurricane Season&#x27; if year == years[0] else &quot;&quot;)

plt.xlabel(&#x27;Date&#x27;, fontsize=12)
plt.ylabel(&#x27;Discharge [cfs]&#x27;, fontsize=12)
plt.title(&#x27;Caloosahatchee River Discharge with Hurricane Season Indicated&#x27;, fontsize=16)
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="00YaQ796Gy9P4QOJKv34H" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/c9288cf8ee2fd9d534489be8335b6e23.png" alt="&lt;Figure size 1600x700 with 1 Axes&gt;"/></div></div></div><div id="ZwURjVWVYl" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plt.figure(num=20, figsize=(16, 7))
plt.plot(df_dis[&#x27;Date&#x27;], df_dis[&#x27;Discharge&#x27;], color=&#x27;blue&#x27;, linewidth=1, linestyle=&#x27;-&#x27;, alpha=0.8, label=&#x27;Discharge&#x27;)

plt.gca().xaxis.set_major_locator(mdates.YearLocator())
plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(&#x27;%Y&#x27;))
plt.xlim(df_dis[&#x27;Date&#x27;].min(), df_dis[&#x27;Date&#x27;].max())

# Shade hurricane season for each year
for year in df_dis[&#x27;Date&#x27;].dt.year.unique():
    start = pd.Timestamp(f&quot;{year}-06-01&quot;)
    end = pd.Timestamp(f&quot;{year}-11-30&quot;)
    plt.axvspan(start, end, color=&#x27;orange&#x27;, alpha=0.1, label=&#x27;Hurricane Season&#x27; if year == df_dis[&#x27;Date&#x27;].dt.year.unique()[0] else &quot;&quot;)

plt.xlabel(&#x27;Date&#x27;, fontsize=12)
plt.ylabel(&#x27;Discharge [cfs]&#x27;, fontsize=12)
plt.title(&#x27;Caloosahatchee River Discharge with Hurricane Season Indicated&#x27;, fontsize=12)
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Vf6F52NETGmVCr1_8sjAm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/4f7c7bccde3ef382c5e699a5ff85c4a2.png" alt="&lt;Figure size 1600x700 with 1 Axes&gt;"/></div></div></div><div id="ENl7NSvmZl" class="myst-jp-nb-block relative group/block"><h2 id="id-2-nutrient-data-for-the-caloosahatchee-river-tn-and-tp-monitoring" class="relative group"><span class="heading-text">2. Nutrient Data for the Caloosahatchee River: TN and TP Monitoring</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-nutrient-data-for-the-caloosahatchee-river-tn-and-tp-monitoring" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="Fo8C3jvHkz" class="myst-jp-nb-block relative group/block"><p>The Total Nitrogen (TN) and Total Phosphorus (TP) data for both the upper and lower Caloosahatchee River were obtained from Florida’s STORET repository, a state-managed version of the EPA’s national water quality database. These records include monitoring results from agencies like the Florida Department of Environmental Protection and Lee County’s Environmental Laboratory.</p><p>The dataset provides time-stamped, geolocated measurements of nutrient concentrations, which are essential for assessing eutrophication risk and forecasting red tide conditions driven by land-based nutrient runoff.</p><p>Water Atlas data site: <a target="_blank" rel="noreferrer" href="https://chnep.wateratlas.usf.edu/" class="">https://<wbr/>chnep<wbr/>.wateratlas<wbr/>.usf<wbr/>.edu/</a></p></div><div id="tXjEnUhaif" class="myst-jp-nb-block relative group/block"><h3 id="id-2-1-nutrient-data-upper-caloosahatchee-olga-fl" class="relative group"><span class="heading-text">2.1 Nutrient Data: Upper Caloosahatchee (Olga, FL)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-1-nutrient-data-upper-caloosahatchee-olga-fl" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="EWJsdwxqmU" class="myst-jp-nb-block relative group/block"><p>This section loads nutrient monitoring data from the upper Caloosahatchee River at the S.R. 79 (Olga) station and prepares it for analysis. The dataset is filtered to extract relevant nutrient parameters and converted to datetime format for alignment with other variables.</p></div><div id="y1w2ofqz3B" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd

# Load the Caloosahatchee nutrient data
nutrient_data = pd.read_csv(&quot;TN_TP_Caloosa.csv&quot;)

# Preview the dataset
nutrient_data.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="rUQf8RSws0npQc8Nek-rx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="mMSpiwD2AB" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Convert sample date to datetime
nutrient_data[&#x27;SampleDate&#x27;] = pd.to_datetime(nutrient_data[&#x27;SampleDate&#x27;], errors=&#x27;coerce&#x27;)

# Filter by nutrient type for Upper Caloosahatchee
tp_data_upper = nutrient_data[nutrient_data[&#x27;Parameter&#x27;] == &#x27;TP_mg/l&#x27;]
tn_data_upper = nutrient_data[nutrient_data[&#x27;Parameter&#x27;] == &#x27;TN_mg/l&#x27;]

nutrient_data</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="R3FwpU7XColtHgZ0WLiOf" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="R6psfWuXZo" class="myst-jp-nb-block relative group/block"><h3 id="id-2-2-total-phosphorous-over-time-outliers-removed" class="relative group"><span class="heading-text">2.2 Total Phosphorous Over Time (Outliers Removed)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-2-total-phosphorous-over-time-outliers-removed" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="eZosTDf4XE" class="myst-jp-nb-block relative group/block"><p>This section filters and visualizes TP data at the Olga station, removing outliers using the interquartile range (IQR) method. After converting values to numeric format and dropping any missing entries, the code calculates the lower and upper bounds for acceptable values and filters out extreme outliers. The cleaned data is then plotted as a time series.</p><p>The resulting chart shows TP concentrations over time from approximately 1999 to 2024. The data appears sparse before 2015 but becomes more densely sampled in recent years. Most values cluster between 0.05 and 0.15 mg/L, with a slight downward trend and reduced variability over time—possibly reflecting changes in land use, management practices, or sampling consistency.</p></div><div id="zFEtxq3Jlu" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd
import matplotlib.pyplot as plt

# --- 1. Load and Prepare Nutrient Data (Upper Caloosahatchee - Olga, FL) ---
nutrient_data = pd.read_csv(&quot;TN_TP_Caloosa.csv&quot;)  # or your local path
nutrient_data[&#x27;SampleDate&#x27;] = pd.to_datetime(nutrient_data[&#x27;SampleDate&#x27;], errors=&#x27;coerce&#x27;)

# Filter by correct nutrient labels (check spelling)
tp_data_upper = nutrient_data[nutrient_data[&#x27;Parameter&#x27;] == &#x27;TP_mgl&#x27;]
tn_data_upper = nutrient_data[nutrient_data[&#x27;Parameter&#x27;] == &#x27;TN_mgl&#x27;]

# --- 2. Clean and Filter TP Data ---
tp_data_upper[&#x27;Result_Value&#x27;] = pd.to_numeric(tp_data_upper[&#x27;Result_Value&#x27;], errors=&#x27;coerce&#x27;)
tp_clean_upper = tp_data_upper.dropna(subset=[&#x27;Result_Value&#x27;])

# Detect and filter out outliers using IQR
Q1_tp = tp_clean_upper[&#x27;Result_Value&#x27;].quantile(0.25)
Q3_tp = tp_clean_upper[&#x27;Result_Value&#x27;].quantile(0.75)
IQR_tp = Q3_tp - Q1_tp

tp_filtered_upper = tp_clean_upper[
    (tp_clean_upper[&#x27;Result_Value&#x27;] &gt;= Q1_tp - 1.5 * IQR_tp) &amp;
    (tp_clean_upper[&#x27;Result_Value&#x27;] &lt;= Q3_tp + 1.5 * IQR_tp)
]

# --- 3. Plot Filtered TP Data ---
plt.figure(figsize=(10, 4))
plt.scatter(tp_filtered_upper[&#x27;SampleDate&#x27;], tp_filtered_upper[&#x27;Result_Value&#x27;],
            alpha=0.5, color=&#x27;blue&#x27;, label=&#x27;Total Phosphorus (Filtered)&#x27;)
plt.title(&#x27;Total Phosphorus (TP) Concentration Over Time (Outliers Removed) - Upper Caloosahatchee&#x27;)
plt.xlabel(&#x27;Sample Date&#x27;)
plt.ylabel(&#x27;TP (mg/L)&#x27;)
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="RB3ytwqaCrQUIUmWt5Ud-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\3999490599.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  tp_data_upper[&#x27;Result_Value&#x27;] = pd.to_numeric(tp_data_upper[&#x27;Result_Value&#x27;], errors=&#x27;coerce&#x27;)
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/f08af60a7f2bc30cd0e56ea9346aba3d.png" alt="&lt;Figure size 1000x400 with 1 Axes&gt;"/></div></div></div><div id="ZIr3vCGSz9" class="myst-jp-nb-block relative group/block"><h3 id="id-2-3-total-nitrogen-over-time-outliers-removed" class="relative group"><span class="heading-text">2.3 Total Nitrogen Over Time (Outliers Removed)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-3-total-nitrogen-over-time-outliers-removed" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="Iy9WIHbkT8" class="myst-jp-nb-block relative group/block"><p>This section processes TN data at the Olga station by converting result values to numeric format, dropping missing entries, and removing statistical outliers using the interquartile range (IQR) method. The filtered dataset is then plotted to visualize trends over time.</p><p>The resulting chart displays TN concentrations from the late 1990s through 2024. Like the phosphorus dataset, early records are sparse, with sampling density increasing significantly after 2015. Most values range between 1.0 and 1.6 mg/L. There is no obvious long-term trend, but a tighter clustering of values in more recent years may reflect improved monitoring consistency or reduced variability in nutrient inputs.</p></div><div id="vutvme0ktN" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import numpy as np

# Convert TN values to float
tn_data_upper[&#x27;Result_Value&#x27;] = pd.to_numeric(tn_data_upper[&#x27;Result_Value&#x27;], errors=&#x27;coerce&#x27;)

# Remove NaNs
tn_clean_upper = tn_data_upper.dropna(subset=[&#x27;Result_Value&#x27;])

# Detect outliers using IQR
Q1 = tn_clean_upper[&#x27;Result_Value&#x27;].quantile(0.25)
Q3 = tn_clean_upper[&#x27;Result_Value&#x27;].quantile(0.75)
IQR = Q3 - Q1

# Filter out outliers
tn_filtered_upper = tn_clean_upper[
    (tn_clean_upper[&#x27;Result_Value&#x27;] &gt;= Q1 - 1.5 * IQR) &amp;
    (tn_clean_upper[&#x27;Result_Value&#x27;] &lt;= Q3 + 1.5 * IQR)
]

# Plot filtered TN data
plt.figure(figsize=(10, 4))
plt.scatter(tn_filtered_upper[&#x27;SampleDate&#x27;], tn_filtered_upper[&#x27;Result_Value&#x27;],
            alpha=0.5, color=&#x27;green&#x27;, label=&#x27;Total Nitrogen (Filtered)&#x27;)
plt.title(&#x27;Total Nitrogen (TN) Concentration Over Time (Outliers Removed) - Upper Caloosahatchee&#x27;)
plt.xlabel(&#x27;Sample Date&#x27;)
plt.ylabel(&#x27;TN (mg/L)&#x27;)
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="kLG_-Uqc9EJGuF9lZq2zE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\468480445.py:5: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  tn_data_upper[&#x27;Result_Value&#x27;] = pd.to_numeric(tn_data_upper[&#x27;Result_Value&#x27;], errors=&#x27;coerce&#x27;)
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/5daddfc6b79a0f7f1641555a07ec0bc5.png" alt="&lt;Figure size 1000x400 with 1 Axes&gt;"/></div></div></div><div id="bEPX2l0Ep8" class="myst-jp-nb-block relative group/block"><h3 id="id-2-4-combined-tn-and-tp-trendline-olga-fl-outliers-removed" class="relative group"><span class="heading-text">2.4 Combined TN and TP Trendline, Olga, FL (Outliers Removed)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-4-combined-tn-and-tp-trendline-olga-fl-outliers-removed" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="Xib6iMfeIj" class="myst-jp-nb-block relative group/block"><p>This section aggregates the cleaned nutrient data into monthly averages to reveal long-term trends in nitrogen and phosphorus concentrations at the Olga monitoring site. Missing months are interpolated to produce continuous time series for both parameters. The data is visualized in two synchronized subplots sharing the same time axis.</p><p>The top plot shows a monthly trend of TN concentrations, which fluctuate but show a general decline in variability and magnitude over the past two decades. The bottom plot illustrates the TP trend, which is more seasonally variable and features sharper peaks, especially in the mid-2000s and late 2010s. Together, these plots highlight nutrient dynamics over time and provide context for understanding their potential role in fueling algal blooms downstream.</p></div><div id="i1SEvVo1nb" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Resample monthly and interpolate missing months
tn_monthly_upper = tn_filtered_upper.set_index(&#x27;SampleDate&#x27;)[&#x27;Result_Value&#x27;].resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()
tp_monthly_upper = tp_filtered_upper.set_index(&#x27;SampleDate&#x27;)[&#x27;Result_Value&#x27;].resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="8-32NYvzKlSdXn8Zn0hMC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\2975870262.py:2: FutureWarning: &#x27;M&#x27; is deprecated and will be removed in a future version, please use &#x27;ME&#x27; instead.
  tn_monthly_upper = tn_filtered_upper.set_index(&#x27;SampleDate&#x27;)[&#x27;Result_Value&#x27;].resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()
C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\2975870262.py:3: FutureWarning: &#x27;M&#x27; is deprecated and will be removed in a future version, please use &#x27;ME&#x27; instead.
  tp_monthly_upper = tp_filtered_upper.set_index(&#x27;SampleDate&#x27;)[&#x27;Result_Value&#x27;].resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()
</span></code></pre></div></div></div></div><div id="f8KBxEBpo9" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt

# Plot TN and TP on two subplots (shared x-axis)
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 8), sharex=True)

# Plot TN
ax1.plot(tn_monthly_upper.index, tn_monthly_upper.values, color=&#x27;green&#x27;, label=&#x27;Total Nitrogen (TN)&#x27;, linewidth=2)
ax1.set_ylabel(&#x27;TN (mg/L)&#x27;)
ax1.set_title(&#x27;Monthly Trend of Total Nitrogen (Upper Caloosahatchee)&#x27;)
ax1.grid(True)
ax1.legend()

# Plot TP
ax2.plot(tp_monthly_upper.index, tp_monthly_upper.values, color=&#x27;blue&#x27;, label=&#x27;Total Phosphorus (TP)&#x27;, linewidth=2)
ax2.set_ylabel(&#x27;TP (mg/L)&#x27;)
ax2.set_title(&#x27;Monthly Trend of Total Phosphorus (Upper Caloosahatchee)&#x27;)
ax2.set_xlabel(&#x27;Date&#x27;)
ax2.grid(True)
ax2.legend()

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="BwS2Ioj-Aco22NWsK8rvD" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/b1b0746f7f61f5d4a11b30e0c446d5d4.png" alt="&lt;Figure size 1400x800 with 2 Axes&gt;"/></div></div></div><div id="UzgFiSaBgj" class="myst-jp-nb-block relative group/block"><h3 id="id-2-5-nutrient-data-lower-caloosahatchee-fort-myers-fl" class="relative group"><span class="heading-text">2.5 Nutrient Data: Lower Caloosahatchee (Fort Myers, FL)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-5-nutrient-data-lower-caloosahatchee-fort-myers-fl" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="L9Y61vBMrb" class="myst-jp-nb-block relative group/block"><p>This section loads nutrient monitoring data for the tidal portion of the Caloosahatchee River near Fort Myers. As with the upper river data, this dataset includes TN and TP measurements and is used to complement the upstream records. Including this site allows the analysis to capture nutrient movement downstream, offering a fuller picture of how concentrations evolve as water flows from the Olga station toward the Gulf of Mexico.</p></div><div id="yJmn2q7cUY" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd

# Load the Caloosahatchee nutrient data
nutrient_tidal = pd.read_csv(&quot;TN_TP_Tidal_Caloosa.csv&quot;)

# Preview the dataset
nutrient_tidal.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="jpDzEMRHgbx4gWyqw5bff" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="TS9dcExcBB" class="myst-jp-nb-block relative group/block"><h3 id="id-2-6-total-phosphorous-over-time-outliers-removed" class="relative group"><span class="heading-text">2.6 Total Phosphorous Over Time (Outliers Removed)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-6-total-phosphorous-over-time-outliers-removed" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="mtXMQUT858" class="myst-jp-nb-block relative group/block"><p>This section repeats the methods of Section 2.2 for the tidal Caloosahatchee River.</p></div><div id="o8dYr1qrf5" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import pandas as pd
import numpy as np

# Strip any trailing/leading whitespace from column names
nutrient_tidal.columns = nutrient_tidal.columns.str.strip()

# --- Convert TP values to numeric ---
tp_data_tidal = nutrient_tidal[nutrient_tidal[&#x27;Parameter&#x27;] == &#x27;TP_mgl&#x27;].copy()
tp_data_tidal[&#x27;Result_Value&#x27;] = pd.to_numeric(tp_data_tidal[&#x27;Result_Value&#x27;], errors=&#x27;coerce&#x27;)
tp_data_tidal[&#x27;SampleDate&#x27;] = pd.to_datetime(tp_data_tidal[&#x27;SampleDate&#x27;], errors=&#x27;coerce&#x27;)

# --- Remove NaNs ---
tp_clean_tidal = tp_data_tidal.dropna(subset=[&#x27;Result_Value&#x27;])

# --- Detect outliers using IQR ---
Q1_tp = tp_clean_tidal[&#x27;Result_Value&#x27;].quantile(0.25)
Q3_tp = tp_clean_tidal[&#x27;Result_Value&#x27;].quantile(0.75)
IQR_tp = Q3_tp - Q1_tp

# --- Filter out outliers ---
tp_filtered_tidal = tp_clean_tidal[
    (tp_clean_tidal[&#x27;Result_Value&#x27;] &gt;= Q1_tp - 1.5 * IQR_tp) &amp;
    (tp_clean_tidal[&#x27;Result_Value&#x27;] &lt;= Q3_tp + 1.5 * IQR_tp)
]

# --- Plot Filtered TP data ---
plt.figure(figsize=(10, 4))
plt.scatter(tp_filtered_tidal[&#x27;SampleDate&#x27;], tp_filtered_tidal[&#x27;Result_Value&#x27;], 
            alpha=0.5, color=&#x27;blue&#x27;, label=&#x27;Total Phosphorus (Filtered)&#x27;)
plt.title(&#x27;Total Phosphorus (TP) Concentration Over Time (Outliers Removed) - Tidal Caloosahatchee&#x27;)
plt.xlabel(&#x27;Sample Date&#x27;)
plt.ylabel(&#x27;TP (mg/L)&#x27;)
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="oidJ5IGDnNDZk-8D7CaBo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/a3be7f318b0f0fca77ab517aa68da786.png" alt="&lt;Figure size 1000x400 with 1 Axes&gt;"/></div></div></div><div id="rmWraLx1k6" class="myst-jp-nb-block relative group/block"><h3 id="id-2-7-total-nitrogen-over-time-outliers-removed" class="relative group"><span class="heading-text">2.7 Total Nitrogen Over Time (Outliers Removed)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-7-total-nitrogen-over-time-outliers-removed" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="acQQ0Nwqbc" class="myst-jp-nb-block relative group/block"><p>This section repeats the methods of Section 2.3 for the tidal Caloosahatchee River.</p></div><div id="ntdhgxpahd" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt
import numpy as np

# Filter and convert TN values
tn_data_tidal = nutrient_tidal[nutrient_tidal[&#x27;Parameter&#x27;] == &#x27;TN_mgl&#x27;].copy()
tn_data_tidal[&#x27;Result_Value&#x27;] = pd.to_numeric(tn_data_tidal[&#x27;Result_Value&#x27;], errors=&#x27;coerce&#x27;)
tn_data_tidal[&#x27;SampleDate&#x27;] = pd.to_datetime(tn_data_tidal[&#x27;SampleDate&#x27;], errors=&#x27;coerce&#x27;)

# Remove NaNs
tn_clean_tidal = tn_data_tidal.dropna(subset=[&#x27;Result_Value&#x27;])

# Detect outliers using IQR
Q1_tn_tidal = tn_clean_tidal[&#x27;Result_Value&#x27;].quantile(0.25)
Q3_tn_tidal = tn_clean_tidal[&#x27;Result_Value&#x27;].quantile(0.75)
IQR_tn_tidal = Q3_tn_tidal - Q1_tn_tidal

# Filter out outliers
tn_filtered_tidal = tn_clean_tidal[
    (tn_clean_tidal[&#x27;Result_Value&#x27;] &gt;= Q1_tn_tidal - 1.5 * IQR_tn_tidal) &amp;
    (tn_clean_tidal[&#x27;Result_Value&#x27;] &lt;= Q3_tn_tidal + 1.5 * IQR_tn_tidal)
]

# Plot Filtered TN data
plt.figure(figsize=(10, 4))
plt.scatter(tn_filtered_tidal[&#x27;SampleDate&#x27;], tn_filtered_tidal[&#x27;Result_Value&#x27;], 
            alpha=0.5, color=&#x27;green&#x27;, label=&#x27;Total Nitrogen (Filtered)&#x27;)
plt.title(&#x27;Total Nitrogen (TN) Concentration Over Time (Outliers Removed) - Tidal Caloosahatchee&#x27;)
plt.xlabel(&#x27;Sample Date&#x27;)
plt.ylabel(&#x27;TN (mg/L)&#x27;)
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="d9j0vz-OXlyxlZDrfq_3C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/7b91cdb1188f6aafc68a91d878c46b9f.png" alt="&lt;Figure size 1000x400 with 1 Axes&gt;"/></div></div></div><div id="rZOjnWYSLj" class="myst-jp-nb-block relative group/block"><h3 id="id-2-8-combined-tn-and-tp-trendline-fort-myers-outliers-removed" class="relative group"><span class="heading-text">2.8 Combined TN and TP Trendline, Fort Myers (Outliers Removed)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-8-combined-tn-and-tp-trendline-fort-myers-outliers-removed" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="uVQ7QZbtoV" class="myst-jp-nb-block relative group/block"><p>This section repeats the methods of Section 2.4 for the tidal Caloosahatchee River.</p></div><div id="T2jP0OcMAJ" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># --- Resample monthly and interpolate missing months for Tidal Caloosahatchee ---
tn_monthly_tidal = tn_filtered_tidal.set_index(&#x27;SampleDate&#x27;)[&#x27;Result_Value&#x27;] \
    .resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()

tp_monthly_tidal = tp_filtered_tidal.set_index(&#x27;SampleDate&#x27;)[&#x27;Result_Value&#x27;] \
    .resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="9uucC7nYKocpYWve8yejn" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\4036337590.py:3: FutureWarning: &#x27;M&#x27; is deprecated and will be removed in a future version, please use &#x27;ME&#x27; instead.
  .resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()
C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\4036337590.py:6: FutureWarning: &#x27;M&#x27; is deprecated and will be removed in a future version, please use &#x27;ME&#x27; instead.
  .resample(&#x27;M&#x27;).mean().asfreq(&#x27;M&#x27;).interpolate()
</span></code></pre></div></div></div></div><div id="vD6umZooOV" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt

# --- Plot TN and TP trends for Tidal Caloosahatchee in stacked subplots ---
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 8), sharex=True)

# TN plot
ax1.plot(tn_monthly_tidal.index, tn_monthly_tidal.values, color=&#x27;green&#x27;, linewidth=2, label=&#x27;Total Nitrogen (TN)&#x27;)
ax1.set_ylabel(&#x27;TN (mg/L)&#x27;)
ax1.set_title(&#x27;Monthly Trend of Total Nitrogen (Tidal Caloosahatchee)&#x27;)
ax1.grid(True)
ax1.legend()

# TP plot
ax2.plot(tp_monthly_tidal.index, tp_monthly_tidal.values, color=&#x27;blue&#x27;, linewidth=2, label=&#x27;Total Phosphorus (TP)&#x27;)
ax2.set_ylabel(&#x27;TP (mg/L)&#x27;)
ax2.set_title(&#x27;Monthly Trend of Total Phosphorus (Tidal Caloosahatchee)&#x27;)
ax2.set_xlabel(&#x27;Date&#x27;)
ax2.grid(True)
ax2.legend()

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="DcYK8o3qxq3S7A_swtAOS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/c569154706f47f7f1725206640f5f995.png" alt="&lt;Figure size 1400x800 with 2 Axes&gt;"/></div></div></div><div id="nKjmNyqjXR" class="myst-jp-nb-block relative group/block"><h3 id="id-2-9-combined-and-averaged-time-series-for-the-caloosahatchee-river" class="relative group"><span class="heading-text">2.9 Combined and Averaged Time Series for the Caloosahatchee River</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-9-combined-and-averaged-time-series-for-the-caloosahatchee-river" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="HTFGKOUccM" class="myst-jp-nb-block relative group/block"><p>To better support the machine learning analysis, we combined the TN and TP data from both the upper (Olga) and lower (Fort Myers) Caloosahatchee River sites.</p><p>This was done by averaging the monthly resampled and interpolated TN and TP concentrations from both locations. The result is a single, unified timeseries for TN and TP that represents the average nutrient concentrations flowing out of the Caloosahatchee River.</p><p>This provides a more comprehensive and simplified input for evaluating how nutrient levels may correlate with harmful algal bloom (HAB) activity in downstream coastal waters.</p></div><div id="CLRpXntqFH" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># --- Combine and average monthly TN and TP data from upper and tidal Caloosahatchee ---

# First align the date indices to ensure no mismatch
tn_monthly_upper = tn_monthly_upper.sort_index()
tp_monthly_upper = tp_monthly_upper.sort_index()
tn_monthly_tidal = tn_monthly_tidal.sort_index()
tp_monthly_tidal = tp_monthly_tidal.sort_index()

# Align on same monthly date index (outer join, then take average where both exist)
combined_tn = pd.concat([tn_monthly_upper, tn_monthly_tidal], axis=1)
combined_tp = pd.concat([tp_monthly_upper, tp_monthly_tidal], axis=1)

# Rename columns for clarity
combined_tn.columns = [&#x27;TN_Upper&#x27;, &#x27;TN_Tidal&#x27;]
combined_tp.columns = [&#x27;TP_Upper&#x27;, &#x27;TP_Tidal&#x27;]

# Take the average (will ignore NaN if one side is missing)
combined_tn[&#x27;TN_Avg&#x27;] = combined_tn.mean(axis=1)
combined_tp[&#x27;TP_Avg&#x27;] = combined_tp.mean(axis=1)

# Extract final single-column Series for modeling
tn_avg = combined_tn[&#x27;TN_Avg&#x27;]
tp_avg = combined_tp[&#x27;TP_Avg&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="qOHBvQn9IzKR8f8dYOizy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vewA0Oy4Gz" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import matplotlib.pyplot as plt

# Create side-by-side subplots
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 8), sharex=True)

# Plot TN
ax1.plot(tn_avg.index, tn_avg.values, color=&#x27;green&#x27;, linewidth=2, label=&#x27;Avg Total Nitrogen (TN)&#x27;)
ax1.set_ylabel(&#x27;TN (mg/L)&#x27;)
ax1.set_title(&#x27;Monthly Average Total Nitrogen from Caloosahatchee River&#x27;)
ax1.grid(True)
ax1.legend()

# Plot TP
ax2.plot(tp_avg.index, tp_avg.values, color=&#x27;blue&#x27;, linewidth=2, label=&#x27;Avg Total Phosphorus (TP)&#x27;)
ax2.set_ylabel(&#x27;TP (mg/L)&#x27;)
ax2.set_title(&#x27;Monthly Average Total Phosphorus from Caloosahatchee River&#x27;)
ax2.set_xlabel(&#x27;Date&#x27;)
ax2.grid(True)
ax2.legend()

plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="lTsRCky8Qv85K2DWjWGDF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/0c7764694db0f4a8b19c9b934e921196.png" alt="&lt;Figure size 1400x800 with 2 Axes&gt;"/></div></div></div><div id="rQBxv94Awv" class="myst-jp-nb-block relative group/block"><h2 id="id-3-resampling-caloosahatchee-tn-and-tp-to-match-peace-river" class="relative group"><span class="heading-text">3. Resampling Caloosahatchee TN and TP to Match Peace River</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-resampling-caloosahatchee-tn-and-tp-to-match-peace-river" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="A3hEpiy1ST" class="myst-jp-nb-block relative group/block"><p>There are discrepancies between the Peace River and Caloosahatchee River TN and TP datasets. Namely, the Peace River TN and TP is sampled daily and is measured in ugl, while the Caloosahatchee River TN and TP is averaged monthly and measured in mgl. The following code updates the Caloosahatchee River data to match the Peace River data in preparation for creating a feature file to be used in the Peace River code.</p></div><div id="TpHMgvyxom" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd

# --- Load upper and tidal nutrient data ---
df_upper = pd.read_csv(&quot;TN_TP_Caloosa.csv&quot;)
df_tidal = pd.read_csv(&quot;TN_TP_Tidal_Caloosa.csv&quot;)

def prepare_daily_nutrient_series(df, tn_code=&#x27;TN_mgl&#x27;, tp_code=&#x27;TP_mgl&#x27;):
    df = df.copy()

    # Convert to datetime
    df[&#x27;SampleDate&#x27;] = pd.to_datetime(df[&#x27;SampleDate&#x27;])

    # Filter for TN and TP
    df_tn = df[df[&#x27;Parameter&#x27;] == tn_code][[&#x27;SampleDate&#x27;, &#x27;Result_Value&#x27;]].copy()
    df_tp = df[df[&#x27;Parameter&#x27;] == tp_code][[&#x27;SampleDate&#x27;, &#x27;Result_Value&#x27;]].copy()

    # Convert mg/L to µg/L
    df_tn[&#x27;Result_Value&#x27;] *= 1000
    df_tp[&#x27;Result_Value&#x27;] *= 1000

    # Group by date and average if more than one reading per day
    tn_daily = df_tn.groupby(&#x27;SampleDate&#x27;).mean()
    tp_daily = df_tp.groupby(&#x27;SampleDate&#x27;).mean()

    # Reindex to full date range and interpolate missing days
    full_range = pd.date_range(start=df[&#x27;SampleDate&#x27;].min(), end=df[&#x27;SampleDate&#x27;].max(), freq=&#x27;D&#x27;)
    tn_daily = tn_daily.reindex(full_range).interpolate()
    tp_daily = tp_daily.reindex(full_range).interpolate()

    # Rename columns for clarity
    tn_daily.columns = [&#x27;TN&#x27;]
    tp_daily.columns = [&#x27;TP&#x27;]

    return tn_daily, tp_daily

# --- Prepare upper and tidal separately ---
tn_upper, tp_upper = prepare_daily_nutrient_series(df_upper)
tn_tidal, tp_tidal = prepare_daily_nutrient_series(df_tidal)

# --- Combine and average across stations ---
combined_tn = pd.concat([tn_upper, tn_tidal], axis=1)
combined_tp = pd.concat([tp_upper, tp_tidal], axis=1)

combined_tn.columns = [&#x27;TN_Upper&#x27;, &#x27;TN_Tidal&#x27;]
combined_tp.columns = [&#x27;TP_Upper&#x27;, &#x27;TP_Tidal&#x27;]

# Take the daily average (ignores NaN if only one site sampled)
combined_tn[&#x27;TN_Avg&#x27;] = combined_tn.mean(axis=1)
combined_tp[&#x27;TP_Avg&#x27;] = combined_tp.mean(axis=1)

# Extract final time series
tn_avg = combined_tn[[&#x27;TN_Avg&#x27;]]
tp_avg = combined_tp[[&#x27;TP_Avg&#x27;]]

# Optional: merge into one DataFrame
df_nutrients_daily = pd.concat([tn_avg, tp_avg], axis=1)

# View result
print(df_nutrients_daily.head())
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Gw_lFdS3cKaLXgQaZYDV-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>                 TN_Avg  TP_Avg
1990-10-16  1270.000000   160.0
1990-10-17  1503.333333   156.0
1990-10-18  1736.666667   152.0
1990-10-19  1970.000000   148.0
1990-10-20  2203.333333   144.0
</span></code></pre></div></div></div></div><div id="r3XelE03rS" class="myst-jp-nb-block relative group/block"><h2 id="id-4-combine-discharge-and-tn-tp-data-frames" class="relative group"><span class="heading-text">4. Combine Discharge and TN/TP Data Frames</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-combine-discharge-and-tn-tp-data-frames" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="hAVJvTPKtk" class="myst-jp-nb-block relative group/block"><p>Below, we combined daily-averaged discharge, total nitrogen, and total phosphorus data into a unified feature set. Discharge was downsampled to match the monthly resolution of the nutrient data. This dataset captures key flow and nutrient conditions from the Caloosahatchee River system and is structured to match the Peace River format for ML modeling.</p></div><div id="s6ZB9kkgCd" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print(df_dis.index)
print(df_nutrients_daily.index)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="TibZX4rZoCCcPcItmR4tG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>RangeIndex(start=0, stop=11783, step=1)
DatetimeIndex([&#x27;1990-10-16&#x27;, &#x27;1990-10-17&#x27;, &#x27;1990-10-18&#x27;, &#x27;1990-10-19&#x27;,
               &#x27;1990-10-20&#x27;, &#x27;1990-10-21&#x27;, &#x27;1990-10-22&#x27;, &#x27;1990-10-23&#x27;,
               &#x27;1990-10-24&#x27;, &#x27;1990-10-25&#x27;,
               ...
               &#x27;2025-01-04&#x27;, &#x27;2025-01-05&#x27;, &#x27;2025-01-06&#x27;, &#x27;2025-01-07&#x27;,
               &#x27;2025-01-08&#x27;, &#x27;2025-01-09&#x27;, &#x27;2025-01-10&#x27;, &#x27;2025-01-11&#x27;,
               &#x27;2025-01-12&#x27;, &#x27;2025-01-13&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, length=12509, freq=&#x27;D&#x27;)
</span></code></pre></div></div></div></div><div id="IIEBbS6lLN" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Convert df_dis[&#x27;Date&#x27;] to datetime and set it as index
df_dis[&#x27;Date&#x27;] = pd.to_datetime(df_dis[&#x27;Date&#x27;])
df_dis.set_index(&#x27;Date&#x27;, inplace=True)

# Make sure df_nutrients_daily index is also datetime (you&#x27;ve already done this)
df_nutrients_daily.index = pd.to_datetime(df_nutrients_daily.index)

# Now safely concatenate based on the datetime index
df_combined = pd.concat([df_dis, df_nutrients_daily], axis=1, join=&#x27;inner&#x27;)  # only keeps overlapping dates

# Drop any remaining NaNs if needed
df_combined.dropna(inplace=True)

# Check results
print(df_combined.head())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="XPb_gk2_AIPGzePKHLXgC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>           Source  Site Number Discharge       TN_Avg  TP_Avg
1993-01-01   USGS      2292900      14.0  1126.071429    70.0
1993-01-02   USGS      2292900     160.0  1076.428571    70.0
1993-01-03   USGS      2292900     820.0  1026.785714    70.0
1993-01-04   USGS      2292900      11.0   977.142857    70.0
1993-01-05   USGS      2292900       9.2   927.500000    70.0
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\534825520.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_dis[&#x27;Date&#x27;] = pd.to_datetime(df_dis[&#x27;Date&#x27;])
</span></code></pre></div></div></div></div><div id="K5QAW8OlRh" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Ensure Date column is present and set as datetime index for df_dis
df_dis = df_dis.copy()
if df_dis.index.name == &#x27;Date&#x27;:
    df_dis.reset_index(inplace=True)  # brings &#x27;Date&#x27; back as a column

df_dis[&#x27;Date&#x27;] = pd.to_datetime(df_dis[&#x27;Date&#x27;])  # ensure datetime format
df_dis.set_index(&#x27;Date&#x27;, inplace=True)  # set as index for alignment

# Ensure df_nutrients_daily index is datetime
df_nutrients_daily.index = pd.to_datetime(df_nutrients_daily.index)

# Concatenate on aligned datetime index
df_combined = pd.concat([df_dis, df_nutrients_daily], axis=1, join=&#x27;inner&#x27;)

# Rename nutrient columns to match ML features
df_combined.rename(columns={
    &#x27;TN_Avg&#x27;: &#x27;caloosa_total_nitrogen&#x27;,
    &#x27;TP_Avg&#x27;: &#x27;caloosa_total_phosphorus&#x27;
}, inplace=True)

# Drop rows with missing data
df_combined.dropna(inplace=True)

# Reset index so &#x27;Date&#x27; becomes a column again
df_combined.reset_index(inplace=True)

# Confirm the column is actually named &#x27;Date&#x27;
print(df_combined.columns)

# Save to CSV (no need to reselect columns if they&#x27;re already right)
df_combined.to_csv(&#x27;caloosa_features.csv&#x27;, index=False)

# View result
print(df_combined.head())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="4wiij0Cfdtk0yP0h1QCB0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Index([&#x27;index&#x27;, &#x27;Source&#x27;, &#x27;Site Number&#x27;, &#x27;Discharge&#x27;, &#x27;caloosa_total_nitrogen&#x27;,
       &#x27;caloosa_total_phosphorus&#x27;],
      dtype=&#x27;object&#x27;)
       index Source  Site Number Discharge  caloosa_total_nitrogen  \
0 1993-01-01   USGS      2292900      14.0             1126.071429   
1 1993-01-02   USGS      2292900     160.0             1076.428571   
2 1993-01-03   USGS      2292900     820.0             1026.785714   
3 1993-01-04   USGS      2292900      11.0              977.142857   
4 1993-01-05   USGS      2292900       9.2              927.500000   

   caloosa_total_phosphorus  
0                      70.0  
1                      70.0  
2                      70.0  
3                      70.0  
4                      70.0  
</span></code></pre></div></div></div></div><div id="eiWm9qUDV6" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Reset index so &#x27;Date&#x27; becomes a column again
df_combined.reset_index(inplace=True)

# Rename the index column to &#x27;Date&#x27; explicitly
df_combined.rename(columns={&#x27;index&#x27;: &#x27;Date&#x27;}, inplace=True)

# Optional: reorder columns
df_combined = df_combined[[&#x27;Date&#x27;, &#x27;Discharge&#x27;, &#x27;caloosa_total_nitrogen&#x27;, &#x27;caloosa_total_phosphorus&#x27;]]

# Save to CSV
df_combined.to_csv(&#x27;caloosa_features.csv&#x27;, index=False)

# Preview
print(df_combined.head())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ZWrBNIFXbHhnRjYDYv_Vl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>        Date Discharge  caloosa_total_nitrogen  caloosa_total_phosphorus
0 1993-01-01      14.0             1126.071429                      70.0
1 1993-01-02     160.0             1076.428571                      70.0
2 1993-01-03     820.0             1026.785714                      70.0
3 1993-01-04      11.0              977.142857                      70.0
4 1993-01-05       9.2              927.500000                      70.0
</span></code></pre></div></div></div></div><div id="WcMwis00S3" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Rename &#x27;Discharge&#x27; to match naming convention
df_combined.rename(columns={&#x27;Discharge&#x27;: &#x27;caloosa_discharge&#x27;}, inplace=True)
df_combined.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="kD_Vn5lcq1TCDUV9yc8j_" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="mkQEjB0kGw" class="myst-jp-nb-block relative group/block"><h2 id="id-4-create-caloosahatchee-features-file" class="relative group"><span class="heading-text">4. Create Caloosahatchee Features File</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-4-create-caloosahatchee-features-file" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="PBHeV3e4Vk" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Restore date column for resampling
df_combined = pd.read_csv(&#x27;caloosa_features.csv&#x27;)  # Reload if needed
df_combined[&#x27;Date&#x27;] = pd.to_datetime(df_combined[&#x27;Date&#x27;])  # Ensure proper datetime type
df_combined.set_index(&#x27;Date&#x27;, inplace=True)  # Set Date as index for resampling
# Rename &#x27;Discharge&#x27; to match naming convention
df_combined.rename(columns={&#x27;Discharge&#x27;: &#x27;caloosa_discharge&#x27;}, inplace=True)
df_combined.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Tg6J1gZ4-w6cnns522L11" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="SBSKqyMtIp" class="myst-jp-nb-block relative group/block"><h2 id="id-5-resample-caloosahatchee-data-to-weekly" class="relative group"><span class="heading-text">5. Resample Caloosahatchee Data to Weekly</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-resample-caloosahatchee-data-to-weekly" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="aKoNpkym9X" class="myst-jp-nb-block relative group/block"><p>The final data for the Peace River parameters is interpolated weekly, so we need to resample the Calooshatchee data to weekly.</p></div><div id="yxlwXI3GY2" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Resample to weekly (Monday start) using mean for each variable
df_caloosa_weekly = df_combined.resample(&#x27;W-MON&#x27;).mean()

# Optional: check the result
print(df_caloosa_weekly.head())

# Save as a new weekly file to match the professor&#x27;s format
df_caloosa_weekly.to_csv(&#x27;caloosa_weekly.csv&#x27;)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="XNyQU-e5RfHB30urhWhp8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>            caloosa_discharge  caloosa_total_nitrogen  \
Date                                                    
1993-01-04         251.250000             1051.607143   
1993-01-11        1528.600000              778.571429   
1993-01-18        3398.571429              792.936508   
1993-01-25        2687.000000              798.333333   
1993-02-01        2979.142857              765.925926   

            caloosa_total_phosphorus  
Date                                  
1993-01-04                 70.000000  
1993-01-11                 70.000000  
1993-01-18                 67.142857  
1993-01-25                 58.000000  
1993-02-01                 48.666667  
</span></code></pre></div></div></div></div><div id="clZqjpm8jG" class="myst-jp-nb-block relative group/block"><h3 id="id-5-1-add-time-column-to-caloosahatchee-dataset" class="relative group"><span class="heading-text">5.1 Add Time Column to Caloosahatchee Dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-1-add-time-column-to-caloosahatchee-dataset" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="vggTjMSqXk" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd

# Load Caloosahatchee data with datetime index
df_caloosa = pd.read_csv(&#x27;caloosa_weekly.csv&#x27;, index_col=0, parse_dates=True)

# Add &#x27;time&#x27; column from index
df_caloosa[&#x27;time&#x27;] = df_caloosa.index

# Optional: move &#x27;time&#x27; to the front
df_caloosa = df_caloosa[[&#x27;time&#x27;, &#x27;caloosa_discharge&#x27;, &#x27;caloosa_total_nitrogen&#x27;, &#x27;caloosa_total_phosphorus&#x27;]]

# Save updated file
df_caloosa.to_csv(&#x27;caloosa_weekly_with_time.csv&#x27;, index=False)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="PJW4AGLkH61Za0lSEXJ5L" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="hg1Ci1DuWH" class="myst-jp-nb-block relative group/block"><h3 id="id-5-2-convert-caloosa-tn-and-tp-to-mg-l" class="relative group"><span class="heading-text">5.2 Convert Caloosa TN and TP to mg/L</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-5-2-convert-caloosa-tn-and-tp-to-mg-l" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="CAVFSUOlJT" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load Caloosahatchee features with time column
df_caloosa = pd.read_csv(&quot;caloosa_weekly_with_time.csv&quot;, parse_dates=[&#x27;time&#x27;])

# Convert TN and TP from µg/L to mg/L
df_caloosa[&#x27;caloosa_total_nitrogen&#x27;] = df_caloosa[&#x27;caloosa_total_nitrogen&#x27;] / 1000
df_caloosa[&#x27;caloosa_total_phosphorus&#x27;] = df_caloosa[&#x27;caloosa_total_phosphorus&#x27;] / 1000

# Save updated version (overwrites file with corrected units)
df_caloosa.to_csv(&quot;caloosa_weekly_with_time.csv&quot;, index=False)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="Rkr7q3Cei6KhcylwZJ9FC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WnyO7v9jv7" class="myst-jp-nb-block relative group/block"><h2 id="id-6-merge-with-peace-river-data" class="relative group"><span class="heading-text">6. Merge with Peace River Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-6-merge-with-peace-river-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="VNADtraGDn" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load Peace River + atmospheric + ocean features
df_peace = pd.read_csv(&#x27;data_weekly_intepolated.csv&#x27;, parse_dates=[&#x27;time&#x27;])

# Load Caloosahatchee features
df_caloosa = pd.read_csv(&#x27;caloosa_weekly_with_time.csv&#x27;, parse_dates=[&#x27;time&#x27;])

# Merge on &#x27;time&#x27; column
df_swfl_merged = pd.merge(df_peace, df_caloosa, on=&#x27;time&#x27;, how=&#x27;outer&#x27;)

# Drop rows with missing values
df_swfl_merged.dropna(inplace=True)

# Save merged dataset
df_swfl_merged.to_csv(&#x27;swfl_merged_features.csv&#x27;, index=False)

# Preview merged dataset (optional)
df_swfl_merged.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="gH29XVSJ4kF9V0Z75G_ba" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="aQ2T1R60Uq" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df_swfl_merged.tail()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="ArQGYoWyJ-Z8KAXA9v4C3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="b6zTK66hjz" class="myst-jp-nb-block relative group/block"><h2 id="id-7-add-tampa-kb-counts" class="relative group"><span class="heading-text">7. Add Tampa KB Counts</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-7-add-tampa-kb-counts" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="Mmg0hk6pIK" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd

# Load SWFL merged features
df_swfl = pd.read_csv(&#x27;swfl_merged_features.csv&#x27;, parse_dates=[&#x27;time&#x27;])

# Load full HABSOS dataset
df_tampa = pd.read_csv(&#x27;habsos_20240430.csv&#x27;, parse_dates=[&#x27;SAMPLE_DATE&#x27;])

# Filter to Tampa Bay region using your specified bounding box
df_tampa = df_tampa[
    (df_tampa[&#x27;LATITUDE&#x27;].between(27.4, 28.2)) &amp;
    (df_tampa[&#x27;LONGITUDE&#x27;].between(-83.0, -82.3))
]

# Rename columns for clarity
df_tampa.rename(columns={&#x27;SAMPLE_DATE&#x27;: &#x27;time&#x27;, &#x27;CELLCOUNT&#x27;: &#x27;kb_tampa&#x27;}, inplace=True)

# Group by date to get daily average KB concentration for Tampa region
df_tampa_daily = df_tampa.groupby(&#x27;time&#x27;, as_index=False)[&#x27;kb_tampa&#x27;].mean()

# Merge with the existing SWFL dataset on &#x27;time&#x27;
df_swfl_tampa = pd.merge(df_swfl, df_tampa_daily, on=&#x27;time&#x27;, how=&#x27;left&#x27;)

# Save to new CSV file
df_swfl_tampa.to_csv(&#x27;swfl_merged_features_tampa.csv&#x27;, index=False)

# Optional: preview the result
df_swfl_tampa.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="_08Zrpy1roV4_YUbewY_5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\3940744265.py:7: DtypeWarning: Columns (21,24) have mixed types. Specify dtype option on import or set low_memory=False.
  df_tampa = pd.read_csv(&#x27;habsos_20240430.csv&#x27;, parse_dates=[&#x27;SAMPLE_DATE&#x27;])
</span></code></pre></div></div><div><div class="p-2.5">Loading...</div></div></div></div><div id="NLb7aeeKr6" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df_swfl_tampa[&#x27;kb_tampa&#x27;] = df_swfl_tampa[&#x27;kb_tampa&#x27;].fillna(0)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="9q8it0qORvIGeFFEJBU27" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BI6y2WfbYs" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df_swfl_tampa.to_csv(&#x27;swfl_merged_features_tampa.csv&#x27;, index=False)
df_swfl_tampa.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="yoM8mq1eZuvsoU_tUuX2T" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="wIE6cCum6h" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Add kb_tampa values to kb
df_swfl_tampa[&#x27;kb&#x27;] = df_swfl_tampa[&#x27;kb&#x27;] + df_swfl_tampa[&#x27;kb_tampa&#x27;]

# Drop the kb_tampa column
df_swfl_tampa.drop(columns=[&#x27;kb_tampa&#x27;], inplace=True)
df_swfl_tampa.to_csv(&#x27;swfl_merged_features_tampa.csv&#x27;, index=False)
df_swfl_tampa.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="H9nW86S1VD6w3jdQ0-NQi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="YD4rcSRu7b" class="myst-jp-nb-block relative group/block"><h2 id="id-8-create-combined-data-series" class="relative group"><span class="heading-text">8. Create Combined Data Series</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-8-create-combined-data-series" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="yqPBs4OAhA" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import os
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.dates as mdates

# -----------------------------
# Load merged weekly dataset
# -----------------------------
# If df_swfl_tampa already exists in your notebook, you can comment this out.
df = df_swfl_tampa.copy()

# Ensure time is datetime + sorted
df[&quot;time&quot;] = pd.to_datetime(df[&quot;time&quot;])
df = df.sort_values(&quot;time&quot;)

# Keep only columns we need (and coerce to numeric where applicable)
cols = [
    &quot;time&quot;,
    &quot;kb&quot;,
    &quot;zos&quot;,
    &quot;salinity&quot;,
    &quot;water_temp&quot;,
    &quot;wind_direction&quot;,
    &quot;wind_speed&quot;,
    &quot;peace_discharge&quot;,
    &quot;caloosa_discharge&quot;,
    &quot;peace_TN&quot;,
    &quot;caloosa_total_nitrogen&quot;,
    &quot;peace_TP&quot;,
    &quot;caloosa_total_phosphorus&quot;,
]
df_plot = df[cols].copy()

for c in cols:
    if c != &quot;time&quot;:
        df_plot[c] = pd.to_numeric(df_plot[c], errors=&quot;coerce&quot;)

# -----------------------------
# Optional: match ML-ready behavior (drop rows with missing values)
# -----------------------------
df_plot = df_plot.dropna()

# -----------------------------
# Output path
# -----------------------------
out_dir = r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Parameters&quot;
os.makedirs(out_dir, exist_ok=True)
out_path = os.path.join(out_dir, &quot;stacked_parameters_9panel.png&quot;)

# -----------------------------
# Plot setup (9 stacked panels)
# -----------------------------
fig, axes = plt.subplots(
    nrows=9,
    ncols=1,
    figsize=(14, 22),
    sharex=True,
    constrained_layout=True
)

# 1) Karenia brevis Cell Count
axes[0].plot(df_plot[&quot;time&quot;], df_plot[&quot;kb&quot;], linewidth=1.0)
axes[0].set_title(&quot;K.brevis Cell Count&quot;)
axes[0].set_ylabel(&quot;Cells L$^{-1}$&quot;)

# 2) Sea Surface Height (zos)
axes[1].plot(df_plot[&quot;time&quot;], df_plot[&quot;zos&quot;], linewidth=1.0)
axes[1].set_title(&quot;Sea Surface Height Anomaly (zos)&quot;)
axes[1].set_ylabel(&quot;SSH (m)&quot;)

# 3) Salinity
axes[2].plot(df_plot[&quot;time&quot;], df_plot[&quot;salinity&quot;], linewidth=1.0)
axes[2].set_title(&quot;Salinity&quot;)
axes[2].set_ylabel(&quot;Salinity (PSU)&quot;)

# 4) Water Temperature
axes[3].plot(df_plot[&quot;time&quot;], df_plot[&quot;water_temp&quot;], linewidth=1.0)
axes[3].set_title(&quot;Water Temperature&quot;)
axes[3].set_ylabel(&quot;Temp (°C)&quot;)

# 5) Wind Direction
axes[4].plot(df_plot[&quot;time&quot;], df_plot[&quot;wind_direction&quot;], linewidth=1.0)
axes[4].set_title(&quot;Wind Direction&quot;)
axes[4].set_ylabel(&quot;Direction (°)&quot;)
axes[4].set_ylim(0, 360)

# 6) Wind Speed
axes[5].plot(df_plot[&quot;time&quot;], df_plot[&quot;wind_speed&quot;], linewidth=1.0)
axes[5].set_title(&quot;Wind Speed&quot;)
axes[5].set_ylabel(&quot;Speed (m s$^{-1}$)&quot;)

# 7) Peace + Caloosa Discharge (cfs)
axes[6].plot(df_plot[&quot;time&quot;], df_plot[&quot;peace_discharge&quot;], linewidth=1.0, label=&quot;Peace River&quot;)
axes[6].plot(df_plot[&quot;time&quot;], df_plot[&quot;caloosa_discharge&quot;], linewidth=1.0, label=&quot;Caloosahatchee River&quot;)
axes[6].set_title(&quot;River Discharge&quot;)
axes[6].set_ylabel(&quot;Discharge (cfs)&quot;)
axes[6].legend(loc=&quot;upper left&quot;, frameon=False)

# 8) Peace + Caloosa Total Nitrogen (mg/L)
axes[7].plot(df_plot[&quot;time&quot;], df_plot[&quot;peace_TN&quot;], linewidth=1.0, label=&quot;Peace River TN&quot;)
axes[7].plot(df_plot[&quot;time&quot;], df_plot[&quot;caloosa_total_nitrogen&quot;], linewidth=1.0, label=&quot;Caloosahatchee TN&quot;)
axes[7].set_title(&quot;Total Nitrogen&quot;)
axes[7].set_ylabel(&quot;TN (mg/L)&quot;)
axes[7].legend(loc=&quot;upper left&quot;, frameon=False)

# 9) Peace + Caloosa Total Phosphorus (mg/L)
axes[8].plot(df_plot[&quot;time&quot;], df_plot[&quot;peace_TP&quot;], linewidth=1.0, label=&quot;Peace River TP&quot;)
axes[8].plot(df_plot[&quot;time&quot;], df_plot[&quot;caloosa_total_phosphorus&quot;], linewidth=1.0, label=&quot;Caloosahatchee TP&quot;)
axes[8].set_title(&quot;Total Phosphorus&quot;)
axes[8].set_ylabel(&quot;TP (mg/L)&quot;)
axes[8].legend(loc=&quot;upper left&quot;, frameon=False)

# -----------------------------
# X-axis formatting
# -----------------------------
axes[8].set_xlabel(&quot;Time&quot;)
axes[8].xaxis.set_major_locator(mdates.YearLocator(base=2))
axes[8].xaxis.set_major_formatter(mdates.DateFormatter(&quot;%Y&quot;))

for ax in axes:
    ax.grid(True, linewidth=0.5)

# -----------------------------
# Save figure
# -----------------------------
fig.suptitle(&quot;Combined Environmental Drivers&quot;, y=1.01, fontsize=14)
plt.savefig(out_path, dpi=300, bbox_inches=&quot;tight&quot;)
plt.show()

print(f&quot;Saved figure to: {out_path}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="5FNQw3WR6w5d4gkXJjaik" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-image"><img src="/red-tide-book//build/e538796ac0462dcad1212d024fc2b46d.png" alt="&lt;Figure size 1400x2200 with 9 Axes&gt;"/></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Saved figure to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Parameters\stacked_parameters_9panel.png
</span></code></pre></div></div></div></div><div id="ZJD4vLhL52" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">df_swfl_tampa[[&#x27;time&#x27;, &#x27;caloosa_total_nitrogen&#x27;]] \
    .sort_values(&#x27;caloosa_total_nitrogen&#x27;, ascending=False) \
    .head(5)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="hnGDlPRRReJqV__xM3bC4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="Se2K8iRFix" class="myst-jp-nb-block relative group/block"><h2 id="id-9-plot-study-area" class="relative group"><span class="heading-text">9. Plot Study Area</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-9-plot-study-area" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><div id="AxclXdZ6J3" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import pandas as pd

# --------------------------------------------------
# Load HABsOS bloom observation dataset
# --------------------------------------------------
df_hab = pd.read_csv(
    &quot;habsos_20240430.csv&quot;,
    parse_dates=[&quot;SAMPLE_DATE&quot;]
)

print(&quot;Initial HABsOS shape:&quot;, df_hab.shape)

# --------------------------------------------------
# Filter to Karenia brevis only
# --------------------------------------------------
df_hab = df_hab[
    (df_hab[&#x27;GENUS&#x27;] == &#x27;Karenia&#x27;) &amp;
    (df_hab[&#x27;SPECIES&#x27;] == &#x27;brevis&#x27;)
]

print(&quot;After filtering to Karenia brevis:&quot;, df_hab.shape)

# --------------------------------------------------
# Filter to SWFL + Tampa Bay spatial domain
# --------------------------------------------------
df_hab_swfl = df_hab[
    (df_hab[&#x27;LATITUDE&#x27;].between(24.5, 28.5)) &amp;    # SWFL → Tampa Bay
    (df_hab[&#x27;LONGITUDE&#x27;].between(-84.5, -80.0)) &amp;
    (df_hab[&#x27;SAMPLE_DATE&#x27;] &gt;= &#x27;1992-01-01&#x27;)
]

print(&quot;After spatial/temporal filtering:&quot;, df_hab_swfl.shape)

# --------------------------------------------------
# Create bloom intensity subsets for plotting
# --------------------------------------------------
high = df_hab_swfl[df_hab_swfl[&#x27;CELLCOUNT&#x27;] &gt;= 1e6]

medium = df_hab_swfl[
    (df_hab_swfl[&#x27;CELLCOUNT&#x27;] &gt;= 1e5) &amp;
    (df_hab_swfl[&#x27;CELLCOUNT&#x27;] &lt; 1e6)
]

low = df_hab_swfl[
    (df_hab_swfl[&#x27;CELLCOUNT&#x27;] &gt;= 1e4) &amp;
    (df_hab_swfl[&#x27;CELLCOUNT&#x27;] &lt; 1e5)
]

# --------------------------------------------------
# Sanity checks
# --------------------------------------------------
print(&quot;\nBloom category counts:&quot;)
print(f&quot;  High (≥1e6): {len(high)}&quot;)
print(f&quot;  Medium (1e5–1e6): {len(medium)}&quot;)
print(f&quot;  Low (1e4–1e5): {len(low)}&quot;)

print(&quot;\nCELLCOUNT summary:&quot;)
print(df_hab_swfl[&#x27;CELLCOUNT&#x27;].describe())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="bJjZy-P9bEeA984OP_8hU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\AppData\Local\Temp\ipykernel_112204\1022535847.py:6: DtypeWarning: Columns (21,24) have mixed types. Specify dtype option on import or set low_memory=False.
  df_hab = pd.read_csv(
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Initial HABsOS shape: (211834, 28)
After filtering to Karenia brevis: (211834, 28)
After spatial/temporal filtering: (143120, 28)

Bloom category counts:
  High (≥1e6): 2665
  Medium (1e5–1e6): 7882
  Low (1e4–1e5): 8879

CELLCOUNT summary:
count    1.431200e+05
mean     1.359387e+05
std      2.403858e+06
min      0.000000e+00
25%      0.000000e+00
50%      0.000000e+00
75%      0.000000e+00
max      3.884000e+08
Name: CELLCOUNT, dtype: float64
</span></code></pre></div></div></div></div><div id="gUIOnQ3aws" class="myst-jp-nb-block relative group/block"><div class="myst-jp-nb-block-spinner flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="myst-jp-nb-block sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute -top-[12px] right-0 flex flex-row rounded bg-white dark:bg-slate-800"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Recreate KB (Karenia brevis) cellcount map up to Tampa Bay (Cartopy)
# Assumes you already have df_hab loaded (HABsOS) with at least:
# [&#x27;LATITUDE&#x27;,&#x27;LONGITUDE&#x27;,&#x27;SAMPLE_DATE&#x27;,&#x27;CELLCOUNT&#x27;,&#x27;GENUS&#x27;,&#x27;SPECIES&#x27;].
# If df_hab is not in memory yet, load it first like we did earlier.

import os
from pathlib import Path
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

import cartopy.crs as ccrs
import cartopy.feature as cfeature
from matplotlib.patches import Rectangle

# -----------------------
# 0) Output folder
# -----------------------
output_dir = Path(r&quot;C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Tampa_Data_Graphics&quot;)
output_dir.mkdir(parents=True, exist_ok=True)

# -----------------------
# 1) Map extent + focus box (SWFL-&gt;Tampa)
# -----------------------
# Big Gulf view (similar feel to advisor figure)
extent = [-98, -79, 22, 30]  # [Lon_W, Lon_E, Lat_S, Lat_N]

# Focus box you can tweak (covers Naples -&gt; Tampa Bay)
box_lon_w, box_lon_e = -83.6, -81.1
box_lat_s, box_lat_n = 25.3, 28.4

# -----------------------
# 2) Filter HABsOS to K. brevis + time + focus region (for plotting points)
# -----------------------
df_plot = df_hab.copy()

# Ensure datetime
df_plot[&quot;SAMPLE_DATE&quot;] = pd.to_datetime(df_plot[&quot;SAMPLE_DATE&quot;], errors=&quot;coerce&quot;)

# Keep Karenia brevis only (robust to case/spacing)
df_plot = df_plot[
    df_plot[&quot;GENUS&quot;].astype(str).str.strip().str.lower().eq(&quot;karenia&quot;) &amp;
    df_plot[&quot;SPECIES&quot;].astype(str).str.strip().str.lower().eq(&quot;brevis&quot;)
].copy()

# Time filter (matches your earlier workflow)
df_plot = df_plot[df_plot[&quot;SAMPLE_DATE&quot;] &gt;= pd.to_datetime(&quot;1992-01-01&quot;)].copy()

# Keep only points inside the focus box (so we don’t paint the whole Gulf with dots)
df_plot = df_plot[
    (df_plot[&quot;LONGITUDE&quot;].between(box_lon_w, box_lon_e)) &amp;
    (df_plot[&quot;LATITUDE&quot;].between(box_lat_s, box_lat_n))
].copy()

# Make sure CELLCOUNT is numeric
df_plot[&quot;CELLCOUNT&quot;] = pd.to_numeric(df_plot[&quot;CELLCOUNT&quot;], errors=&quot;coerce&quot;).fillna(0)

# Categories
high = df_plot[df_plot[&quot;CELLCOUNT&quot;] &gt;= 1e6]
medium = df_plot[(df_plot[&quot;CELLCOUNT&quot;] &gt;= 1e5) &amp; (df_plot[&quot;CELLCOUNT&quot;] &lt; 1e6)]
low = df_plot[(df_plot[&quot;CELLCOUNT&quot;] &gt;= 1e4) &amp; (df_plot[&quot;CELLCOUNT&quot;] &lt; 1e5)]

# -----------------------
# 3) Build map
# -----------------------
proj = ccrs.PlateCarree()
fig = plt.figure(figsize=(11, 8.5))
ax = plt.subplot(1, 1, 1, projection=proj)
ax.set_extent(extent, crs=proj)

# Background / features
ax.set_facecolor(cfeature.COLORS[&quot;water&quot;])
ax.add_feature(cfeature.LAKES.with_scale(&quot;10m&quot;), color=&quot;aqua&quot;, zorder=2)
ax.add_feature(cfeature.COASTLINE.with_scale(&quot;10m&quot;), color=&quot;gray&quot;, zorder=3)
ax.add_feature(cfeature.BORDERS, edgecolor=&quot;red&quot;, facecolor=&quot;none&quot;, linewidth=1.5, zorder=3)
ax.stock_img()

ax.add_feature(
    cfeature.NaturalEarthFeature(
        &quot;physical&quot;, &quot;rivers_lake_centerlines&quot;, scale=&quot;10m&quot;, edgecolor=&quot;blue&quot;, facecolor=&quot;none&quot;
    ),
    zorder=3,
)
ax.add_feature(
    cfeature.NaturalEarthFeature(
        &quot;physical&quot;, &quot;rivers_north_america&quot;, scale=&quot;10m&quot;, edgecolor=&quot;blue&quot;, facecolor=&quot;none&quot;, alpha=0.4
    ),
    zorder=3,
)

# Gridlines
gl = ax.gridlines(
    draw_labels=True,
    xlocs=np.arange(extent[0], extent[1] + 1, 5),
    ylocs=np.arange(extent[2], extent[3] + 1, 5),
    linewidth=1,
    color=&quot;gray&quot;,
    alpha=0.5,
    linestyle=&quot;--&quot;,
    zorder=10,
)
gl.right_labels = False
gl.top_labels = False
gl.xlabel_style = {&quot;size&quot;: 10}
gl.ylabel_style = {&quot;size&quot;: 10}

# Bathymetry “bands” (Natural Earth)
bathymetry_names = [
    &quot;bathymetry_L_0&quot;,
    &quot;bathymetry_K_200&quot;,
    &quot;bathymetry_J_1000&quot;,
    &quot;bathymetry_I_2000&quot;,
    &quot;bathymetry_H_3000&quot;,
    &quot;bathymetry_G_4000&quot;,
]
# Very light -&gt; darker blue
bath_colors = [
    (0.90, 0.95, 1.00),
    (0.75, 0.88, 1.00),
    (0.60, 0.80, 1.00),
    (0.45, 0.72, 1.00),
    (0.25, 0.62, 1.00),
    (0.05, 0.52, 1.00),
]
for name, col in zip(bathymetry_names, bath_colors):
    ax.add_feature(
        cfeature.NaturalEarthFeature(
            category=&quot;physical&quot;,
            name=name,
            scale=&quot;10m&quot;,
            edgecolor=&quot;none&quot;,
            facecolor=col,
        ),
        zorder=1,
    )

# Focus box rectangle
rect = Rectangle(
    (box_lon_w, box_lat_s),
    box_lon_e - box_lon_w,
    box_lat_n - box_lat_s,
    fill=False,
    linewidth=1.5,
    edgecolor=&quot;black&quot;,
    transform=proj,
    zorder=20,
)
ax.add_patch(rect)

# Cities + buoy
locations = {
    &quot;Tampa&quot;: (27.9506, -82.4572),
    &quot;Naples&quot;: (26.1420, -81.7948),
}
for name, (lat, lon) in locations.items():
    ax.plot(lon, lat, marker=&quot;o&quot;, color=&quot;black&quot;, markersize=3, transform=proj, zorder=30)
    ax.text(lon + 0.15, lat + 0.10, name, transform=proj, fontsize=9, color=&quot;black&quot;, zorder=30)

buoys = {&quot;Buoy 42003&quot;: (25.9253, -85.6161)}
for name, (lat, lon) in buoys.items():
    ax.plot(lon, lat, marker=&quot;o&quot;, color=&quot;black&quot;, markersize=3, transform=proj, zorder=30)
    ax.text(lon - 2.0, lat + 0.10, name, transform=proj, fontsize=9, color=&quot;black&quot;, zorder=30)

# -----------------------
# 4) Plot KB points (cellcount bins)
# -----------------------
sc_high = ax.scatter(
    high[&quot;LONGITUDE&quot;], high[&quot;LATITUDE&quot;],
    s=10, color=&quot;red&quot;, edgecolor=&quot;none&quot;,
    transform=proj, zorder=40
)
sc_med = ax.scatter(
    medium[&quot;LONGITUDE&quot;], medium[&quot;LATITUDE&quot;],
    s=10, color=&quot;orange&quot;, edgecolor=&quot;none&quot;,
    transform=proj, zorder=39
)
sc_low = ax.scatter(
    low[&quot;LONGITUDE&quot;], low[&quot;LATITUDE&quot;],
    s=10, color=&quot;yellow&quot;, edgecolor=&quot;none&quot;,
    transform=proj, zorder=38
)

legend = ax.legend(
    handles=[sc_high, sc_med, sc_low],
    labels=[&quot;Cellcount ≥ 1e6&quot;, &quot;1e5 ≤ Cellcount &lt; 1e6&quot;, &quot;1e4 ≤ Cellcount &lt; 1e5&quot;],
    loc=&quot;upper left&quot;,
    fontsize=9,
    frameon=True,
)
legend.set_zorder(50)

# -----------------------
# 5) Save + show
# -----------------------
fname = f&quot;KB_cellcount_SWFL_Tampa_{pd.Timestamp.now():%Y-%m-%d_%H-%M-%S}.png&quot;
outpath = output_dir / fname
plt.savefig(outpath, dpi=300, bbox_inches=&quot;tight&quot;)
print(f&quot;Figure saved to: {outpath}&quot;)

plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-name="outputs-container" data-mdast-node-id="MdexFj86yqjmpVKu95fMd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>C:\Users\mkduu\miniconda3\Lib\site-packages\cartopy\mpl\feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as &quot;never&quot;.
  warnings.warn(&#x27;facecolor will have no effect as it has been &#x27;
</span></code></pre></div></div><div data-name="safe-output-stream"><div><pre class="myst-jp-stream-output text-sm font-thin font-system"><code><span>Figure saved to: C:\Users\mkduu\OneDrive\Documents\FGCU docs\Summer 25 Red Tide Project\Graphics\Tampa_Data_Graphics\KB_cellcount_SWFL_Tampa_2025-12-29_15-58-53.png
</span></code></pre></div></div><div data-name="safe-output-image"><img src="/red-tide-book//build/d58140171c0b2c16f04b898b36a2c84f.png" alt="&lt;Figure size 1100x850 with 1 Axes&gt;"/></div></div></div><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/red-tide-book//"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Red Tide Data and Modeling Book</div>Red Tide Data and Modeling Book</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/red-tide-book//watershed-graphics"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Red Tide Data and Modeling Book</div>Watershed Study Area</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/red-tide-book//build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-OYMW4E3D.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/red-tide-book//build/root-CXYA7X5D.js"/><link rel="modulepreload" href="/red-tide-book//build/_shared/chunk-DATP5P2X.js"/><link rel="modulepreload" href="/red-tide-book//build/routes/$-JRBPULBO.js"/><script>window.__remixContext = {"url":"/data-swfl-combined","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.7.1","options":{},"nav":[],"actions":[],"projects":[{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/red-tide-book/"},"routes/$":{"config":{"version":3,"myst":"1.7.1","options":{},"nav":[],"actions":[],"projects":[{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":3,"kind":"Notebook","sha256":"01147fd6daec826086ebd784ea59ddb379939cc860e5376bca078d209ddcf570","slug":"data-swfl-combined","location":"/Data_SWFL_Combined.ipynb","dependencies":[],"frontmatter":{"title":"Data Integration for Southwest Florida","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"exports":[{"format":"ipynb","filename":"Data_SWFL_Combined.ipynb","url":"/red-tide-book//build/Data_SWFL_Combined-4cc57a96cf5221853079af1807aeae6b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Discharge Monitoring at S.R.-79 on the Caloosahatchee River","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TZpI530tNK"}],"identifier":"id-1-discharge-monitoring-at-s-r-79-on-the-caloosahatchee-river","label":"1. Discharge Monitoring at S.R.-79 on the Caloosahatchee River","html_id":"id-1-discharge-monitoring-at-s-r-79-on-the-caloosahatchee-river","implicit":true,"key":"w0IqKOgZhC"}],"key":"VtdoVWIF2S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.1 Selecting Discharge Station on Caloosahatchee River","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h5hJzHR3CH"}],"identifier":"id-1-1-selecting-discharge-station-on-caloosahatchee-river","label":"1.1 Selecting Discharge Station on Caloosahatchee River","html_id":"id-1-1-selecting-discharge-station-on-caloosahatchee-river","implicit":true,"key":"EEgXeC91b2"}],"key":"yhOpBLusT1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The USGS site number 02292900 corresponds to the streamflow monitoring station at the Caloosahatchee River at S.R.-79 near Olga, Florida. This station, also known as the Franklin Lock and Dam (S-79), has been operational since 1966 and is a key point for monitoring freshwater flow into the Caloosahatchee Estuary.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AqnMMW2RSa"}],"key":"F2sFXIYUWh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This site is managed by the U.S. Geological Survey (USGS) and provides real-time and historical data on streamflow, which is crucial for water resource management, ecological studies, and flood forecasting.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wlUPhIxY4w"}],"key":"stsk9HQDLY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"USGS site data: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yZTqCKOBjq"},{"type":"link","url":"https://waterdata.usgs.gov/nwis/inventory?site_no=02292900","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​waterdata​.usgs​.gov​/nwis​/inventory​?site​_no​=​02292900","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jDtmMvVzVw"}],"urlSource":"https://waterdata.usgs.gov/nwis/inventory?site_no=02292900","key":"HtE7ORJukp"}],"key":"TtTqGjAiFU"}],"key":"iXkgvbqqvO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport os\nimport pandas as pd\nimport requests\nimport zipfile\nfrom io import BytesIO\nimport shutil\n\ndf_dis = pd.read_csv('USGS Data Science Project.csv')\ndf_dis","key":"SR35Ntc7gj"},{"type":"outputs","id":"OOSCfuO9AIjO_0mzrbzbK","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":1,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eSource\u003c/th\u003e\n      \u003cth\u003eSite Number\u003c/th\u003e\n      \u003cth\u003eDate\u003c/th\u003e\n      \u003cth\u003eDischarge\u003c/th\u003e\n      \u003cth\u003eQualification\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1/1/1993\u003c/td\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n      \u003ctd\u003eA\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1/2/1993\u003c/td\u003e\n      \u003ctd\u003e160.0\u003c/td\u003e\n      \u003ctd\u003eA\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1/3/1993\u003c/td\u003e\n      \u003ctd\u003e820.0\u003c/td\u003e\n      \u003ctd\u003eA\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1/4/1993\u003c/td\u003e\n      \u003ctd\u003e11.0\u003c/td\u003e\n      \u003ctd\u003eA\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1/5/1993\u003c/td\u003e\n      \u003ctd\u003e9.2\u003c/td\u003e\n      \u003ctd\u003eA\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11778\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e4/1/2025\u003c/td\u003e\n      \u003ctd\u003e1870.0\u003c/td\u003e\n      \u003ctd\u003eP\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11779\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e4/2/2025\u003c/td\u003e\n      \u003ctd\u003e1390.0\u003c/td\u003e\n      \u003ctd\u003eP\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11780\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e4/3/2025\u003c/td\u003e\n      \u003ctd\u003e1050.0\u003c/td\u003e\n      \u003ctd\u003eP\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11781\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e4/4/2025\u003c/td\u003e\n      \u003ctd\u003e849.0\u003c/td\u003e\n      \u003ctd\u003eP\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11782\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e4/5/2025\u003c/td\u003e\n      \u003ctd\u003e1050.0\u003c/td\u003e\n      \u003ctd\u003eP\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e11783 rows × 5 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"      Source  Site Number      Date  Discharge Qualification\n0       USGS      2292900  1/1/1993       14.0             A\n1       USGS      2292900  1/2/1993      160.0             A\n2       USGS      2292900  1/3/1993      820.0             A\n3       USGS      2292900  1/4/1993       11.0             A\n4       USGS      2292900  1/5/1993        9.2             A\n...      ...          ...       ...        ...           ...\n11778   USGS      2292900  4/1/2025     1870.0             P\n11779   USGS      2292900  4/2/2025     1390.0             P\n11780   USGS      2292900  4/3/2025     1050.0             P\n11781   USGS      2292900  4/4/2025      849.0             P\n11782   USGS      2292900  4/5/2025     1050.0             P\n\n[11783 rows x 5 columns]","content_type":"text/plain"}}},"children":[],"key":"zjErZtelwi"}],"key":"VtddlDSHXi"}],"key":"JN9qo3Knvw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_dis.Date = pd.to_datetime(df_dis.Date)\ndf_dis.Date.dtypes","key":"EilLTk9Zx7"},{"type":"outputs","id":"Ko1qmhht1HrEld_A4KQ4J","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"dtype('\u003cM8[ns]')","content_type":"text/plain"}}},"children":[],"key":"wfewwp1Mlx"}],"key":"hN6NIm0qJ3"}],"key":"K2zM0VIzSG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"columns = ['Source', 'Site Number', 'Date', 'Discharge']\ndf_dis = df_dis[columns]\ndf_dis","key":"qFCpTEmted"},{"type":"outputs","id":"h5R3p2haotnmdgT-WahSq","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eSource\u003c/th\u003e\n      \u003cth\u003eSite Number\u003c/th\u003e\n      \u003cth\u003eDate\u003c/th\u003e\n      \u003cth\u003eDischarge\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1993-01-01\u003c/td\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1993-01-02\u003c/td\u003e\n      \u003ctd\u003e160.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1993-01-03\u003c/td\u003e\n      \u003ctd\u003e820.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1993-01-04\u003c/td\u003e\n      \u003ctd\u003e11.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e1993-01-05\u003c/td\u003e\n      \u003ctd\u003e9.2\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11778\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e2025-04-01\u003c/td\u003e\n      \u003ctd\u003e1870.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11779\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e2025-04-02\u003c/td\u003e\n      \u003ctd\u003e1390.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11780\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e2025-04-03\u003c/td\u003e\n      \u003ctd\u003e1050.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11781\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e2025-04-04\u003c/td\u003e\n      \u003ctd\u003e849.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e11782\u003c/th\u003e\n      \u003ctd\u003eUSGS\u003c/td\u003e\n      \u003ctd\u003e2292900\u003c/td\u003e\n      \u003ctd\u003e2025-04-05\u003c/td\u003e\n      \u003ctd\u003e1050.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e11783 rows × 4 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"      Source  Site Number       Date  Discharge\n0       USGS      2292900 1993-01-01       14.0\n1       USGS      2292900 1993-01-02      160.0\n2       USGS      2292900 1993-01-03      820.0\n3       USGS      2292900 1993-01-04       11.0\n4       USGS      2292900 1993-01-05        9.2\n...      ...          ...        ...        ...\n11778   USGS      2292900 2025-04-01     1870.0\n11779   USGS      2292900 2025-04-02     1390.0\n11780   USGS      2292900 2025-04-03     1050.0\n11781   USGS      2292900 2025-04-04      849.0\n11782   USGS      2292900 2025-04-05     1050.0\n\n[11783 rows x 4 columns]","content_type":"text/plain"}}},"children":[],"key":"qLJR2Vw6Xm"}],"key":"FFS2HnfSsW"}],"key":"tbecjQXsSW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Data cleaned\ndf_dis_clean = df_dis.dropna()\n\nparameters = ['Discharge']\nunits = ['cfs']\n\nmetadata = {\n    'Discharge': {'Unit': 'cfs'}\n}\n\nsummary_data = []\n\nfor column in df_dis.columns:\n    if column not in metadata:\n        continue\n\n    col_data = df_dis[column].dropna()\n    stats = {\n        'Parameter': column,\n        'Unit': metadata[column]['Unit'],\n        'Min': round(col_data.min(), 2),\n        'Mean': round(col_data.mean(), 2),\n        'Median': round(col_data.median(), 2),\n        'Max': round(col_data.max(), 2)\n    }\n    summary_data.append(stats)\n\ndf_dis_summary = pd.DataFrame(summary_data)\ndisplay(df_dis_summary)","key":"noVJHQ2fSK"},{"type":"outputs","id":"Ga9dQCMk8m0FFPuJm9P2G","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eParameter\u003c/th\u003e\n      \u003cth\u003eUnit\u003c/th\u003e\n      \u003cth\u003eMin\u003c/th\u003e\n      \u003cth\u003eMean\u003c/th\u003e\n      \u003cth\u003eMedian\u003c/th\u003e\n      \u003cth\u003eMax\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003eDischarge\u003c/td\u003e\n      \u003ctd\u003ecfs\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e2104.5\u003c/td\u003e\n      \u003ctd\u003e1220.0\u003c/td\u003e\n      \u003ctd\u003e25300.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"   Parameter Unit  Min    Mean  Median      Max\n0  Discharge  cfs  0.0  2104.5  1220.0  25300.0","content_type":"text/plain"}}},"children":[],"key":"vUQx8GbPzL"}],"key":"jY99al62JV"}],"key":"srg3UOFXRN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.2 Caloosahatchee River Discharge","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"poY9rcC0Ot"}],"identifier":"id-1-2-caloosahatchee-river-discharge","label":"1.2 Caloosahatchee River Discharge","html_id":"id-1-2-caloosahatchee-river-discharge","implicit":true,"key":"Vr7zhoaAQM"}],"key":"OTlYiOeTjl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section processes discharge data from the Caloosahatchee River at the S-79 structure, obtained from the USGS. The data is filtered to retain daily mean discharge values, and timestamps are converted to datetime format for alignment with other environmental datasets. The section ensures the discharge values are numeric and drops any rows with missing data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tANxdHhtDz"}],"key":"DuOxvf0wRS"}],"key":"uqxpaetEy1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport matplotlib.dates as mdates\n\n# Line plot of discharge\ndf_dis[['Discharge']].plot(\n    color=['blue'],\n    linewidth=1,\n    xlabel='Date',\n    ylabel='Discharge_Dis [cfs]',\n    figsize=(16, 7),\n    title='Caloosahatchee River Discharge',\n    grid=False,\n    legend=True,\n    style=['-'],\n    alpha=0.8,\n    rot=0,\n    fontsize=12,\n);","key":"Ato30Uyait"},{"type":"outputs","id":"rmsGF_aa8dM1W9y4hlccF","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0ba468079c62eb95a24398120a09c217","path":"/red-tide-book//build/0ba468079c62eb95a24398120a09c217.png"},"text/plain":{"content":"\u003cFigure size 1600x700 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"mXkAmJ9ifO"}],"key":"JSQGNG67Nz"}],"key":"LzpWJutcq6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"max_discharge_dis = df_dis['Discharge'].max()\nprint(max_discharge_dis)","key":"bX3Nr8u1WC"},{"type":"outputs","id":"yCt3vvtYUNCzJT2cRlgm3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"25300.0\n"},"children":[],"key":"Rip7e1bxNy"}],"key":"lC0kfRrJcb"}],"key":"IptkqgbDUR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"avg_discharge_dis = df_dis['Discharge'].mean()\nprint(avg_discharge_dis)","key":"yrU03aNH0T"},{"type":"outputs","id":"4ylrY8xPfHarL9i85-aLA","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"2104.5010027425437\n"},"children":[],"key":"VQXuEYn88Q"}],"key":"H3l35AvkLf"}],"key":"ZgEMslCsus"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.3 Creating a Continuous Discharge Record","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RunVrrgrWt"}],"identifier":"id-1-3-creating-a-continuous-discharge-record","label":"1.3 Creating a Continuous Discharge Record","html_id":"id-1-3-creating-a-continuous-discharge-record","implicit":true,"key":"luEHLXS0wR"}],"key":"ueLB3q7S1I"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section addresses gaps in the Caloosahatchee River discharge dataset by applying interpolation and filling techniques. Missing discharge values are first replaced with NaNs, then interpolated linearly to estimate intermediate values. Any remaining missing values at the start or end of the series are filled using forward and backward fill methods. The cleaned and gap-filled dataset is then visualized in a time series plot spanning from 1993 to 2025, showing the long-term variability in daily discharge rates. This step ensures a continuous discharge record for use in later modeling and analysis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gRhrmmgM8Z"}],"key":"Rq3x6Fmptb"}],"key":"NvOmdODhC0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Replace 0s with NaN in 'Discharge' column\ndf_dis.loc[:, 'Discharge'] = df_dis['Discharge'].replace(0, pd.NA)\n\n# Interpolate missing values linearly\ndf_dis.loc[:, 'Discharge'] = df_dis['Discharge'].interpolate(method='linear')\n\n# Fill remaining NaNs at the start/end using forward/backward fill\ndf_dis.loc[:, 'Discharge'] = df_dis['Discharge'].ffill().bfill()","key":"Hkd0PnqKsv"},{"type":"outputs","id":"yjI3yLYvUYPg9AZQKx1mf","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\2941276119.py:2: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise in a future error of pandas. Value '[14.0 160.0 820.0 ... 1050.0 849.0 1050.0]' has dtype incompatible with float64, please explicitly cast to a compatible dtype first.\n  df_dis.loc[:, 'Discharge'] = df_dis['Discharge'].replace(0, pd.NA)\nC:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\2941276119.py:5: FutureWarning: Series.interpolate with object dtype is deprecated and will raise in a future version. Call obj.infer_objects(copy=False) before interpolating instead.\n  df_dis.loc[:, 'Discharge'] = df_dis['Discharge'].interpolate(method='linear')\nC:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\2941276119.py:8: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`\n  df_dis.loc[:, 'Discharge'] = df_dis['Discharge'].ffill().bfill()\n"},"children":[],"key":"KHEOSp4EOX"}],"key":"N36AqbFsIZ"}],"key":"QxbgenJ5O5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport matplotlib.dates as mdates\n\n# Ensure 'Date' is datetime\ndf_dis['Date'] = pd.to_datetime(df_dis['Date'])\n\n# Create plot\nplt.figure(num=18, figsize=(16, 7))\nplt.plot(df_dis['Date'], df_dis['Discharge'], color='blue', linewidth=1, linestyle='-', alpha=0.8, label='Discharge')\n\n# Format x-axis\nplt.gca().xaxis.set_major_locator(mdates.YearLocator())\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\nplt.xlim(df_dis['Date'].min(), df_dis['Date'].max())\n\n# Add horizontal line at 0\nplt.axhline(y=0, color='black', linestyle='--', linewidth=1)\n\n# Labels and formatting\nplt.xlabel('Date', fontsize=12)\nplt.ylabel('Discharge [cfs]', fontsize=12)\nplt.title('Caloosahatchee River Discharge', fontsize=20)\nplt.legend()\nplt.grid(True)\nplt.xticks(rotation=0)\nplt.tight_layout()\nplt.show()","key":"kiURVefNzK"},{"type":"outputs","id":"Anl6oK6G1O7zyNavwZDFm","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\3119331194.py:5: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  df_dis['Date'] = pd.to_datetime(df_dis['Date'])\n"},"children":[],"key":"pwTPzArQO3"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"595400aaedc6c60c02b6065e67fed51b","path":"/red-tide-book//build/595400aaedc6c60c02b6065e67fed51b.png"},"text/plain":{"content":"\u003cFigure size 1600x700 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"KlP5eB3r5u"}],"key":"vhFwXmd0sJ"}],"key":"ImQmJXxpqo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1.4 Discharge With Hurricane Season Noted","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZRCRYuSaxT"}],"identifier":"id-1-4-discharge-with-hurricane-season-noted","label":"1.4 Discharge With Hurricane Season Noted","html_id":"id-1-4-discharge-with-hurricane-season-noted","implicit":true,"key":"jApUEmJiEz"}],"key":"xAlPDuKy1S"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section enhances the Caloosahatchee River discharge time series by visually marking the Atlantic hurricane season (June 1 to November 30) for each year in the dataset. Using a loop, shaded bands are dynamically added to the plot for every hurricane season between 1993 and 2025. This contextual overlay allows for a clearer visual association between periods of heightened tropical activity and observed discharge spikes. By highlighting these seasonal windows, the plot provides insight into how discharge patterns may be influenced by rainfall and runoff associated with hurricanes and tropical storms, which are relevant for nutrient loading and potential HAB triggers.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kvbu1u4ukm"}],"key":"jPrj4PMKxo"}],"key":"hzNyjF2luY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime\n\nplt.figure(num=19, figsize=(16, 7))\nplt.plot(df_dis['Date'], df_dis['Discharge'], color='blue', linewidth=1, linestyle='-', alpha=0.8, label='Discharge')\n\nplt.gca().xaxis.set_major_locator(mdates.YearLocator())\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\nplt.xlim(df_dis['Date'].min(), df_dis['Date'].max())\n\n# Highlight hurricane season\nyears = df_dis['Date'].dt.year.unique()\nfor year in years:\n    start = pd.Timestamp(f\"{year}-06-01\")\n    end = pd.Timestamp(f\"{year}-11-30\")\n    plt.axvspan(start, end, color='orange', alpha=0.125, label='Hurricane Season' if year == years[0] else \"\")\n\nplt.xlabel('Date', fontsize=12)\nplt.ylabel('Discharge [cfs]', fontsize=12)\nplt.title('Caloosahatchee River Discharge with Hurricane Season Indicated', fontsize=16)\nplt.grid(True)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"oFktxqG2aR"},{"type":"outputs","id":"00YaQ796Gy9P4QOJKv34H","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c9288cf8ee2fd9d534489be8335b6e23","path":"/red-tide-book//build/c9288cf8ee2fd9d534489be8335b6e23.png"},"text/plain":{"content":"\u003cFigure size 1600x700 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"nNXBqPx15v"}],"key":"GBdyNWIIwW"}],"key":"fesJt1gt6K"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(num=20, figsize=(16, 7))\nplt.plot(df_dis['Date'], df_dis['Discharge'], color='blue', linewidth=1, linestyle='-', alpha=0.8, label='Discharge')\n\nplt.gca().xaxis.set_major_locator(mdates.YearLocator())\nplt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\nplt.xlim(df_dis['Date'].min(), df_dis['Date'].max())\n\n# Shade hurricane season for each year\nfor year in df_dis['Date'].dt.year.unique():\n    start = pd.Timestamp(f\"{year}-06-01\")\n    end = pd.Timestamp(f\"{year}-11-30\")\n    plt.axvspan(start, end, color='orange', alpha=0.1, label='Hurricane Season' if year == df_dis['Date'].dt.year.unique()[0] else \"\")\n\nplt.xlabel('Date', fontsize=12)\nplt.ylabel('Discharge [cfs]', fontsize=12)\nplt.title('Caloosahatchee River Discharge with Hurricane Season Indicated', fontsize=12)\nplt.grid(True)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"PgSrMjpKl1"},{"type":"outputs","id":"Vf6F52NETGmVCr1_8sjAm","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4f7c7bccde3ef382c5e699a5ff85c4a2","path":"/red-tide-book//build/4f7c7bccde3ef382c5e699a5ff85c4a2.png"},"text/plain":{"content":"\u003cFigure size 1600x700 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"v4CRSB1WOC"}],"key":"zJuNiq9Lnb"}],"key":"ZwURjVWVYl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Nutrient Data for the Caloosahatchee River: TN and TP Monitoring","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L8iRSf7iFH"}],"identifier":"id-2-nutrient-data-for-the-caloosahatchee-river-tn-and-tp-monitoring","label":"2. Nutrient Data for the Caloosahatchee River: TN and TP Monitoring","html_id":"id-2-nutrient-data-for-the-caloosahatchee-river-tn-and-tp-monitoring","implicit":true,"key":"X85D7CHesu"}],"key":"ENl7NSvmZl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Total Nitrogen (TN) and Total Phosphorus (TP) data for both the upper and lower Caloosahatchee River were obtained from Florida’s STORET repository, a state-managed version of the EPA’s national water quality database. These records include monitoring results from agencies like the Florida Department of Environmental Protection and Lee County’s Environmental Laboratory.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cYcypZq2RN"}],"key":"TECy8slb8S"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The dataset provides time-stamped, geolocated measurements of nutrient concentrations, which are essential for assessing eutrophication risk and forecasting red tide conditions driven by land-based nutrient runoff.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yvRd4DvzL6"}],"key":"h6hMFsxvey"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Water Atlas data site: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YekLH2pl2i"},{"type":"link","url":"https://chnep.wateratlas.usf.edu/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"https://​chnep​.wateratlas​.usf​.edu/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"riCB5gTgiP"}],"urlSource":"https://chnep.wateratlas.usf.edu/","key":"uu3rviMyEt"}],"key":"U717NdwO1M"}],"key":"Fo8C3jvHkz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.1 Nutrient Data: Upper Caloosahatchee (Olga, FL)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q3uRR69KkM"}],"identifier":"id-2-1-nutrient-data-upper-caloosahatchee-olga-fl","label":"2.1 Nutrient Data: Upper Caloosahatchee (Olga, FL)","html_id":"id-2-1-nutrient-data-upper-caloosahatchee-olga-fl","implicit":true,"key":"ZlwTPsqMNk"}],"key":"tXjEnUhaif"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section loads nutrient monitoring data from the upper Caloosahatchee River at the S.R. 79 (Olga) station and prepares it for analysis. The dataset is filtered to extract relevant nutrient parameters and converted to datetime format for alignment with other variables.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CVD5wykSSq"}],"key":"UVI55Jy1RZ"}],"key":"EWJsdwxqmU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\n\n# Load the Caloosahatchee nutrient data\nnutrient_data = pd.read_csv(\"TN_TP_Caloosa.csv\")\n\n# Preview the dataset\nnutrient_data.head()","key":"ocptQIsA5p"},{"type":"outputs","id":"rUQf8RSws0npQc8Nek-rx","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eWBodyID\u003c/th\u003e\n      \u003cth\u003eWaterBodyName\u003c/th\u003e\n      \u003cth\u003eDataSource\u003c/th\u003e\n      \u003cth\u003eStationID\u003c/th\u003e\n      \u003cth\u003eStationName\u003c/th\u003e\n      \u003cth\u003eActual_StationID\u003c/th\u003e\n      \u003cth\u003eActual_Latitude\u003c/th\u003e\n      \u003cth\u003eActual_Longitude\u003c/th\u003e\n      \u003cth\u003eDEP_WBID\u003c/th\u003e\n      \u003cth\u003eSampleDate\u003c/th\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003cth\u003eDepthUnits\u003c/th\u003e\n      \u003cth\u003eParameter\u003c/th\u003e\n      \u003cth\u003eCharacteristic\u003c/th\u003e\n      \u003cth\u003eSample_Fraction\u003c/th\u003e\n      \u003cth\u003eResult_Value\u003c/th\u003e\n      \u003cth\u003eResult_Unit\u003c/th\u003e\n      \u003cth\u003eQACode\u003c/th\u003e\n      \u003cth\u003eResult_Comment\u003c/th\u003e\n      \u003cth\u003eOriginal_Result_Value\u003c/th\u003e\n      \u003cth\u003eOriginal_Result_Unit\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.7212\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e4/29/1999 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.096\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.096\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.7212\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e4/29/1999 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.099\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.099\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.7212\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e4/29/1999 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.498\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eWater Institute Calculated\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.7212\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e5/24/1999 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.170\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eJQ\u003c/td\u003e\n      \u003ctd\u003e**JQ** The precision was outside the QC limit....\u003c/td\u003e\n      \u003ctd\u003e0.170\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.7212\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e5/24/1999 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.600\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eWater Institute Calculated\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e5 rows × 21 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"   WBodyID         WaterBodyName     DataSource  StationID  \\\n0   300081  Caloosahatchee River  STORET_21FLGW       3568   \n1   300081  Caloosahatchee River  STORET_21FLGW       3568   \n2   300081  Caloosahatchee River  STORET_21FLGW       3568   \n3   300081  Caloosahatchee River  STORET_21FLGW       3568   \n4   300081  Caloosahatchee River  STORET_21FLGW       3568   \n\n                                  StationName  Actual_StationID  \\\n0   CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n1   CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n2   CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n3   CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n4   CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n\n   Actual_Latitude  Actual_Longitude DEP_WBID      SampleDate  ...  \\\n0          26.7212        -81.693248    3235A  4/29/1999 0:00  ...   \n1          26.7212        -81.693248    3235A  4/29/1999 0:00  ...   \n2          26.7212        -81.693248    3235A  4/29/1999 0:00  ...   \n3          26.7212        -81.693248    3235A  5/24/1999 0:00  ...   \n4          26.7212        -81.693248    3235A  5/24/1999 0:00  ...   \n\n   DepthUnits Parameter   Characteristic Sample_Fraction Result_Value  \\\n0           m    TP_mgl  Phosphorus as P           Total        0.096   \n1           m    TP_mgl  Phosphorus as P           Total        0.099   \n2           m    TN_mgl         Nitrogen             NaN        1.498   \n3           m    TP_mgl  Phosphorus as P           Total        0.170   \n4           m    TN_mgl         Nitrogen             NaN        1.600   \n\n   Result_Unit QACode                                     Result_Comment  \\\n0         mg/l    NaN                                                NaN   \n1         mg/l    NaN                                                NaN   \n2         mg/l    NaN                         Water Institute Calculated   \n3         mg/l     JQ  **JQ** The precision was outside the QC limit....   \n4         mg/l    NaN                         Water Institute Calculated   \n\n  Original_Result_Value  Original_Result_Unit  \n0                 0.096                  mg/l  \n1                 0.099                  mg/l  \n2                   NaN                   NaN  \n3                 0.170                  mg/l  \n4                   NaN                   NaN  \n\n[5 rows x 21 columns]","content_type":"text/plain"}}},"children":[],"key":"LtWyWzdRDk"}],"key":"tktuMbRb6V"}],"key":"y1w2ofqz3B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert sample date to datetime\nnutrient_data['SampleDate'] = pd.to_datetime(nutrient_data['SampleDate'], errors='coerce')\n\n# Filter by nutrient type for Upper Caloosahatchee\ntp_data_upper = nutrient_data[nutrient_data['Parameter'] == 'TP_mg/l']\ntn_data_upper = nutrient_data[nutrient_data['Parameter'] == 'TN_mg/l']\n\nnutrient_data","key":"bN07Wu1mQk"},{"type":"outputs","id":"R3FwpU7XColtHgZ0WLiOf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eWBodyID\u003c/th\u003e\n      \u003cth\u003eWaterBodyName\u003c/th\u003e\n      \u003cth\u003eDataSource\u003c/th\u003e\n      \u003cth\u003eStationID\u003c/th\u003e\n      \u003cth\u003eStationName\u003c/th\u003e\n      \u003cth\u003eActual_StationID\u003c/th\u003e\n      \u003cth\u003eActual_Latitude\u003c/th\u003e\n      \u003cth\u003eActual_Longitude\u003c/th\u003e\n      \u003cth\u003eDEP_WBID\u003c/th\u003e\n      \u003cth\u003eSampleDate\u003c/th\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003cth\u003eDepthUnits\u003c/th\u003e\n      \u003cth\u003eParameter\u003c/th\u003e\n      \u003cth\u003eCharacteristic\u003c/th\u003e\n      \u003cth\u003eSample_Fraction\u003c/th\u003e\n      \u003cth\u003eResult_Value\u003c/th\u003e\n      \u003cth\u003eResult_Unit\u003c/th\u003e\n      \u003cth\u003eQACode\u003c/th\u003e\n      \u003cth\u003eResult_Comment\u003c/th\u003e\n      \u003cth\u003eOriginal_Result_Value\u003c/th\u003e\n      \u003cth\u003eOriginal_Result_Unit\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.721200\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e1999-04-29\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.096\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.096\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.721200\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e1999-04-29\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.099\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.099\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.721200\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e1999-04-29\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.498\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eWater Institute Calculated\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.721200\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e1999-05-24\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.170\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eJQ\u003c/td\u003e\n      \u003ctd\u003e**JQ** The precision was outside the QC limit....\u003c/td\u003e\n      \u003ctd\u003e0.170\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLGW\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003eCALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA\u003c/td\u003e\n      \u003ctd\u003e3568\u003c/td\u003e\n      \u003ctd\u003e26.721200\u003c/td\u003e\n      \u003ctd\u003e-81.693248\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e1999-05-24\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.600\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eWater Institute Calculated\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1743\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eWIN_21FLSFWM\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003eS79\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003e26.722735\u003c/td\u003e\n      \u003ctd\u003e-81.691019\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e2025-01-06\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.111\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.111\u003c/td\u003e\n      \u003ctd\u003emg/L\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1744\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eWIN_21FLSFWM\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003eS79\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003e26.722735\u003c/td\u003e\n      \u003ctd\u003e-81.691019\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e2025-01-06\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eDissolved\u003c/td\u003e\n      \u003ctd\u003e1.100\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.100\u003c/td\u003e\n      \u003ctd\u003emg/L\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1745\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eWIN_21FLSFWM\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003eS79\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003e26.722735\u003c/td\u003e\n      \u003ctd\u003e-81.691019\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e2025-01-06\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e1.260\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.260\u003c/td\u003e\n      \u003ctd\u003emg/L\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1746\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eWIN_21FLSFWM\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003eS79\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003e26.722735\u003c/td\u003e\n      \u003ctd\u003e-81.691019\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e2025-01-13\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.096\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.096\u003c/td\u003e\n      \u003ctd\u003emg/L\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1747\u003c/th\u003e\n      \u003ctd\u003e300081\u003c/td\u003e\n      \u003ctd\u003eCaloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eWIN_21FLSFWM\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003eS79\u003c/td\u003e\n      \u003ctd\u003e18245\u003c/td\u003e\n      \u003ctd\u003e26.722735\u003c/td\u003e\n      \u003ctd\u003e-81.691019\u003c/td\u003e\n      \u003ctd\u003e3235A\u003c/td\u003e\n      \u003ctd\u003e2025-01-13\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e1.290\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e1.290\u003c/td\u003e\n      \u003ctd\u003emg/L\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e1748 rows × 21 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"      WBodyID         WaterBodyName     DataSource  StationID  \\\n0      300081  Caloosahatchee River  STORET_21FLGW       3568   \n1      300081  Caloosahatchee River  STORET_21FLGW       3568   \n2      300081  Caloosahatchee River  STORET_21FLGW       3568   \n3      300081  Caloosahatchee River  STORET_21FLGW       3568   \n4      300081  Caloosahatchee River  STORET_21FLGW       3568   \n...       ...                   ...            ...        ...   \n1743   300081  Caloosahatchee River   WIN_21FLSFWM      18245   \n1744   300081  Caloosahatchee River   WIN_21FLSFWM      18245   \n1745   300081  Caloosahatchee River   WIN_21FLSFWM      18245   \n1746   300081  Caloosahatchee River   WIN_21FLSFWM      18245   \n1747   300081  Caloosahatchee River   WIN_21FLSFWM      18245   \n\n                                     StationName  Actual_StationID  \\\n0      CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n1      CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n2      CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n3      CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n4      CALOOSAHATCHEE RIVER AT S.R. 79 NEAR OLGA              3568   \n...                                          ...               ...   \n1743                                         S79             18245   \n1744                                         S79             18245   \n1745                                         S79             18245   \n1746                                         S79             18245   \n1747                                         S79             18245   \n\n      Actual_Latitude  Actual_Longitude DEP_WBID SampleDate  ...  DepthUnits  \\\n0           26.721200        -81.693248    3235A 1999-04-29  ...           m   \n1           26.721200        -81.693248    3235A 1999-04-29  ...           m   \n2           26.721200        -81.693248    3235A 1999-04-29  ...           m   \n3           26.721200        -81.693248    3235A 1999-05-24  ...           m   \n4           26.721200        -81.693248    3235A 1999-05-24  ...           m   \n...               ...               ...      ...        ...  ...         ...   \n1743        26.722735        -81.691019    3235A 2025-01-06  ...           m   \n1744        26.722735        -81.691019    3235A 2025-01-06  ...           m   \n1745        26.722735        -81.691019    3235A 2025-01-06  ...           m   \n1746        26.722735        -81.691019    3235A 2025-01-13  ...           m   \n1747        26.722735        -81.691019    3235A 2025-01-13  ...           m   \n\n     Parameter   Characteristic Sample_Fraction Result_Value  Result_Unit  \\\n0       TP_mgl  Phosphorus as P           Total        0.096         mg/l   \n1       TP_mgl  Phosphorus as P           Total        0.099         mg/l   \n2       TN_mgl         Nitrogen             NaN        1.498         mg/l   \n3       TP_mgl  Phosphorus as P           Total        0.170         mg/l   \n4       TN_mgl         Nitrogen             NaN        1.600         mg/l   \n...        ...              ...             ...          ...          ...   \n1743    TP_mgl  Phosphorus as P           Total        0.111         mg/l   \n1744    TN_mgl         Nitrogen       Dissolved        1.100         mg/l   \n1745    TN_mgl         Nitrogen           Total        1.260         mg/l   \n1746    TP_mgl  Phosphorus as P           Total        0.096         mg/l   \n1747    TN_mgl         Nitrogen           Total        1.290         mg/l   \n\n     QACode                                     Result_Comment  \\\n0       NaN                                                NaN   \n1       NaN                                                NaN   \n2       NaN                         Water Institute Calculated   \n3        JQ  **JQ** The precision was outside the QC limit....   \n4       NaN                         Water Institute Calculated   \n...     ...                                                ...   \n1743    NaN                                                NaN   \n1744    NaN                                                NaN   \n1745    NaN                                                NaN   \n1746    NaN                                                NaN   \n1747    NaN                                                NaN   \n\n     Original_Result_Value  Original_Result_Unit  \n0                    0.096                  mg/l  \n1                    0.099                  mg/l  \n2                      NaN                   NaN  \n3                    0.170                  mg/l  \n4                      NaN                   NaN  \n...                    ...                   ...  \n1743                 0.111                  mg/L  \n1744                 1.100                  mg/L  \n1745                 1.260                  mg/L  \n1746                 0.096                  mg/L  \n1747                 1.290                  mg/L  \n\n[1748 rows x 21 columns]","content_type":"text/plain"}}},"children":[],"key":"CkclLSKBFW"}],"key":"rdCpcwwwjn"}],"key":"mMSpiwD2AB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.2 Total Phosphorous Over Time (Outliers Removed)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qkmFW82uB2"}],"identifier":"id-2-2-total-phosphorous-over-time-outliers-removed","label":"2.2 Total Phosphorous Over Time (Outliers Removed)","html_id":"id-2-2-total-phosphorous-over-time-outliers-removed","implicit":true,"key":"rr1mogkXA0"}],"key":"R6psfWuXZo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section filters and visualizes TP data at the Olga station, removing outliers using the interquartile range (IQR) method. After converting values to numeric format and dropping any missing entries, the code calculates the lower and upper bounds for acceptable values and filters out extreme outliers. The cleaned data is then plotted as a time series.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vcoyZmbWmG"}],"key":"O7OOwAHNuX"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The resulting chart shows TP concentrations over time from approximately 1999 to 2024. The data appears sparse before 2015 but becomes more densely sampled in recent years. Most values cluster between 0.05 and 0.15 mg/L, with a slight downward trend and reduced variability over time—possibly reflecting changes in land use, management practices, or sampling consistency.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PPhbltX2oD"}],"key":"JaoemKxowF"}],"key":"eZosTDf4XE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport matplotlib.pyplot as plt\n\n# --- 1. Load and Prepare Nutrient Data (Upper Caloosahatchee - Olga, FL) ---\nnutrient_data = pd.read_csv(\"TN_TP_Caloosa.csv\")  # or your local path\nnutrient_data['SampleDate'] = pd.to_datetime(nutrient_data['SampleDate'], errors='coerce')\n\n# Filter by correct nutrient labels (check spelling)\ntp_data_upper = nutrient_data[nutrient_data['Parameter'] == 'TP_mgl']\ntn_data_upper = nutrient_data[nutrient_data['Parameter'] == 'TN_mgl']\n\n# --- 2. Clean and Filter TP Data ---\ntp_data_upper['Result_Value'] = pd.to_numeric(tp_data_upper['Result_Value'], errors='coerce')\ntp_clean_upper = tp_data_upper.dropna(subset=['Result_Value'])\n\n# Detect and filter out outliers using IQR\nQ1_tp = tp_clean_upper['Result_Value'].quantile(0.25)\nQ3_tp = tp_clean_upper['Result_Value'].quantile(0.75)\nIQR_tp = Q3_tp - Q1_tp\n\ntp_filtered_upper = tp_clean_upper[\n    (tp_clean_upper['Result_Value'] \u003e= Q1_tp - 1.5 * IQR_tp) \u0026\n    (tp_clean_upper['Result_Value'] \u003c= Q3_tp + 1.5 * IQR_tp)\n]\n\n# --- 3. Plot Filtered TP Data ---\nplt.figure(figsize=(10, 4))\nplt.scatter(tp_filtered_upper['SampleDate'], tp_filtered_upper['Result_Value'],\n            alpha=0.5, color='blue', label='Total Phosphorus (Filtered)')\nplt.title('Total Phosphorus (TP) Concentration Over Time (Outliers Removed) - Upper Caloosahatchee')\nplt.xlabel('Sample Date')\nplt.ylabel('TP (mg/L)')\nplt.grid(True)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"XK7lq6qrnz"},{"type":"outputs","id":"RB3ytwqaCrQUIUmWt5Ud-","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\3999490599.py:13: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  tp_data_upper['Result_Value'] = pd.to_numeric(tp_data_upper['Result_Value'], errors='coerce')\n"},"children":[],"key":"UOI0Qyjnaw"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f08af60a7f2bc30cd0e56ea9346aba3d","path":"/red-tide-book//build/f08af60a7f2bc30cd0e56ea9346aba3d.png"},"text/plain":{"content":"\u003cFigure size 1000x400 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"IRzTs7Fwjj"}],"key":"iG1C70jC9X"}],"key":"zFEtxq3Jlu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.3 Total Nitrogen Over Time (Outliers Removed)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UETXtx8qdN"}],"identifier":"id-2-3-total-nitrogen-over-time-outliers-removed","label":"2.3 Total Nitrogen Over Time (Outliers Removed)","html_id":"id-2-3-total-nitrogen-over-time-outliers-removed","implicit":true,"key":"EBFMDLgKZ3"}],"key":"ZIr3vCGSz9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section processes TN data at the Olga station by converting result values to numeric format, dropping missing entries, and removing statistical outliers using the interquartile range (IQR) method. The filtered dataset is then plotted to visualize trends over time.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I33HaKK5Ju"}],"key":"Gh4R74xTyD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The resulting chart displays TN concentrations from the late 1990s through 2024. Like the phosphorus dataset, early records are sparse, with sampling density increasing significantly after 2015. Most values range between 1.0 and 1.6 mg/L. There is no obvious long-term trend, but a tighter clustering of values in more recent years may reflect improved monitoring consistency or reduced variability in nutrient inputs.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rl0VWkTzGW"}],"key":"UsCEjKacmg"}],"key":"Iy9WIHbkT8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\n\n# Convert TN values to float\ntn_data_upper['Result_Value'] = pd.to_numeric(tn_data_upper['Result_Value'], errors='coerce')\n\n# Remove NaNs\ntn_clean_upper = tn_data_upper.dropna(subset=['Result_Value'])\n\n# Detect outliers using IQR\nQ1 = tn_clean_upper['Result_Value'].quantile(0.25)\nQ3 = tn_clean_upper['Result_Value'].quantile(0.75)\nIQR = Q3 - Q1\n\n# Filter out outliers\ntn_filtered_upper = tn_clean_upper[\n    (tn_clean_upper['Result_Value'] \u003e= Q1 - 1.5 * IQR) \u0026\n    (tn_clean_upper['Result_Value'] \u003c= Q3 + 1.5 * IQR)\n]\n\n# Plot filtered TN data\nplt.figure(figsize=(10, 4))\nplt.scatter(tn_filtered_upper['SampleDate'], tn_filtered_upper['Result_Value'],\n            alpha=0.5, color='green', label='Total Nitrogen (Filtered)')\nplt.title('Total Nitrogen (TN) Concentration Over Time (Outliers Removed) - Upper Caloosahatchee')\nplt.xlabel('Sample Date')\nplt.ylabel('TN (mg/L)')\nplt.grid(True)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"W289sMHraD"},{"type":"outputs","id":"kLG_-Uqc9EJGuF9lZq2zE","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\468480445.py:5: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  tn_data_upper['Result_Value'] = pd.to_numeric(tn_data_upper['Result_Value'], errors='coerce')\n"},"children":[],"key":"gmjTPbCMEB"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5daddfc6b79a0f7f1641555a07ec0bc5","path":"/red-tide-book//build/5daddfc6b79a0f7f1641555a07ec0bc5.png"},"text/plain":{"content":"\u003cFigure size 1000x400 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"Dg6Ru18jWi"}],"key":"Er6u8XC10h"}],"key":"vutvme0ktN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.4 Combined TN and TP Trendline, Olga, FL (Outliers Removed)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oINvIPbq49"}],"identifier":"id-2-4-combined-tn-and-tp-trendline-olga-fl-outliers-removed","label":"2.4 Combined TN and TP Trendline, Olga, FL (Outliers Removed)","html_id":"id-2-4-combined-tn-and-tp-trendline-olga-fl-outliers-removed","implicit":true,"key":"nLDLjcD7cH"}],"key":"bEPX2l0Ep8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section aggregates the cleaned nutrient data into monthly averages to reveal long-term trends in nitrogen and phosphorus concentrations at the Olga monitoring site. Missing months are interpolated to produce continuous time series for both parameters. The data is visualized in two synchronized subplots sharing the same time axis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jDjdKNxBKU"}],"key":"zVibpPAYDb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The top plot shows a monthly trend of TN concentrations, which fluctuate but show a general decline in variability and magnitude over the past two decades. The bottom plot illustrates the TP trend, which is more seasonally variable and features sharper peaks, especially in the mid-2000s and late 2010s. Together, these plots highlight nutrient dynamics over time and provide context for understanding their potential role in fueling algal blooms downstream.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OePMb15vsy"}],"key":"Uo0cXfs4H6"}],"key":"Xib6iMfeIj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Resample monthly and interpolate missing months\ntn_monthly_upper = tn_filtered_upper.set_index('SampleDate')['Result_Value'].resample('M').mean().asfreq('M').interpolate()\ntp_monthly_upper = tp_filtered_upper.set_index('SampleDate')['Result_Value'].resample('M').mean().asfreq('M').interpolate()","key":"V3LNjZAMQ2"},{"type":"outputs","id":"8-32NYvzKlSdXn8Zn0hMC","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\2975870262.py:2: FutureWarning: 'M' is deprecated and will be removed in a future version, please use 'ME' instead.\n  tn_monthly_upper = tn_filtered_upper.set_index('SampleDate')['Result_Value'].resample('M').mean().asfreq('M').interpolate()\nC:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\2975870262.py:3: FutureWarning: 'M' is deprecated and will be removed in a future version, please use 'ME' instead.\n  tp_monthly_upper = tp_filtered_upper.set_index('SampleDate')['Result_Value'].resample('M').mean().asfreq('M').interpolate()\n"},"children":[],"key":"sMPZ9AJet4"}],"key":"aDumh7uFBW"}],"key":"i1SEvVo1nb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Plot TN and TP on two subplots (shared x-axis)\nfig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 8), sharex=True)\n\n# Plot TN\nax1.plot(tn_monthly_upper.index, tn_monthly_upper.values, color='green', label='Total Nitrogen (TN)', linewidth=2)\nax1.set_ylabel('TN (mg/L)')\nax1.set_title('Monthly Trend of Total Nitrogen (Upper Caloosahatchee)')\nax1.grid(True)\nax1.legend()\n\n# Plot TP\nax2.plot(tp_monthly_upper.index, tp_monthly_upper.values, color='blue', label='Total Phosphorus (TP)', linewidth=2)\nax2.set_ylabel('TP (mg/L)')\nax2.set_title('Monthly Trend of Total Phosphorus (Upper Caloosahatchee)')\nax2.set_xlabel('Date')\nax2.grid(True)\nax2.legend()\n\nplt.tight_layout()\nplt.show()","key":"UvbvTlt042"},{"type":"outputs","id":"BwS2Ioj-Aco22NWsK8rvD","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b1b0746f7f61f5d4a11b30e0c446d5d4","path":"/red-tide-book//build/b1b0746f7f61f5d4a11b30e0c446d5d4.png"},"text/plain":{"content":"\u003cFigure size 1400x800 with 2 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"qb0ac2XuZG"}],"key":"gHdeSqprEC"}],"key":"f8KBxEBpo9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.5 Nutrient Data: Lower Caloosahatchee (Fort Myers, FL)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wrnyw6BTsS"}],"identifier":"id-2-5-nutrient-data-lower-caloosahatchee-fort-myers-fl","label":"2.5 Nutrient Data: Lower Caloosahatchee (Fort Myers, FL)","html_id":"id-2-5-nutrient-data-lower-caloosahatchee-fort-myers-fl","implicit":true,"key":"PpCLsofvQx"}],"key":"UzgFiSaBgj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section loads nutrient monitoring data for the tidal portion of the Caloosahatchee River near Fort Myers. As with the upper river data, this dataset includes TN and TP measurements and is used to complement the upstream records. Including this site allows the analysis to capture nutrient movement downstream, offering a fuller picture of how concentrations evolve as water flows from the Olga station toward the Gulf of Mexico.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"feJ34j5Lab"}],"key":"OmkjPj6x1j"}],"key":"L9Y61vBMrb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\n\n# Load the Caloosahatchee nutrient data\nnutrient_tidal = pd.read_csv(\"TN_TP_Tidal_Caloosa.csv\")\n\n# Preview the dataset\nnutrient_tidal.head()","key":"hjuw0YdtMW"},{"type":"outputs","id":"jpDzEMRHgbx4gWyqw5bff","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eWBodyID\u003c/th\u003e\n      \u003cth\u003eWaterBodyName\u003c/th\u003e\n      \u003cth\u003eDataSource\u003c/th\u003e\n      \u003cth\u003eStationID\u003c/th\u003e\n      \u003cth\u003eStationName\u003c/th\u003e\n      \u003cth\u003eActual_StationID\u003c/th\u003e\n      \u003cth\u003eActual_Latitude\u003c/th\u003e\n      \u003cth\u003eActual_Longitude\u003c/th\u003e\n      \u003cth\u003eDEP_WBID\u003c/th\u003e\n      \u003cth\u003eSampleDate\u003c/th\u003e\n      \u003cth\u003e...\u003c/th\u003e\n      \u003cth\u003eDepthUnits\u003c/th\u003e\n      \u003cth\u003eParameter\u003c/th\u003e\n      \u003cth\u003eCharacteristic\u003c/th\u003e\n      \u003cth\u003eSample_Fraction\u003c/th\u003e\n      \u003cth\u003eResult_Value\u003c/th\u003e\n      \u003cth\u003eResult_Unit\u003c/th\u003e\n      \u003cth\u003eQACode\u003c/th\u003e\n      \u003cth\u003eResult_Comment\u003c/th\u003e\n      \u003cth\u003eOriginal_Result_Value\u003c/th\u003e\n      \u003cth\u003eOriginal_Result_Unit\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e9000108\u003c/td\u003e\n      \u003ctd\u003eLower Tidal Caloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLEECO\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003eDEEP LAGOON- McGregor Blvd.\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003e26.53932\u003c/td\u003e\n      \u003ctd\u003e-81.9188\u003c/td\u003e\n      \u003ctd\u003e3240A\u003c/td\u003e\n      \u003ctd\u003e10/16/1990 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.16\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.16\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e9000108\u003c/td\u003e\n      \u003ctd\u003eLower Tidal Caloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLEECO\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003eDEEP LAGOON- McGregor Blvd.\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003e26.53932\u003c/td\u003e\n      \u003ctd\u003e-81.9188\u003c/td\u003e\n      \u003ctd\u003e3240A\u003c/td\u003e\n      \u003ctd\u003e10/16/1990 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e1.27\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eWater Institute Calculated: TKN + NOx\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e9000108\u003c/td\u003e\n      \u003ctd\u003eLower Tidal Caloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLEECO\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003eDEEP LAGOON- McGregor Blvd.\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003e26.53932\u003c/td\u003e\n      \u003ctd\u003e-81.9188\u003c/td\u003e\n      \u003ctd\u003e3240A\u003c/td\u003e\n      \u003ctd\u003e10/31/1990 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTN_mgl\u003c/td\u003e\n      \u003ctd\u003eNitrogen\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e4.77\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eWater Institute Calculated: TKN + NOx\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e9000108\u003c/td\u003e\n      \u003ctd\u003eLower Tidal Caloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLEECO\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003eDEEP LAGOON- McGregor Blvd.\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003e26.53932\u003c/td\u003e\n      \u003ctd\u003e-81.9188\u003c/td\u003e\n      \u003ctd\u003e3240A\u003c/td\u003e\n      \u003ctd\u003e10/31/1990 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.10\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.10\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e9000108\u003c/td\u003e\n      \u003ctd\u003eLower Tidal Caloosahatchee River\u003c/td\u003e\n      \u003ctd\u003eSTORET_21FLEECO\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003eDEEP LAGOON- McGregor Blvd.\u003c/td\u003e\n      \u003ctd\u003eDEEPGR10\u003c/td\u003e\n      \u003ctd\u003e26.53932\u003c/td\u003e\n      \u003ctd\u003e-81.9188\u003c/td\u003e\n      \u003ctd\u003e3240A\u003c/td\u003e\n      \u003ctd\u003e11/19/1990 0:00\u003c/td\u003e\n      \u003ctd\u003e...\u003c/td\u003e\n      \u003ctd\u003em\u003c/td\u003e\n      \u003ctd\u003eTP_mgl\u003c/td\u003e\n      \u003ctd\u003ePhosphorus as P\u003c/td\u003e\n      \u003ctd\u003eTotal\u003c/td\u003e\n      \u003ctd\u003e0.11\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n      \u003ctd\u003e0.11\u003c/td\u003e\n      \u003ctd\u003emg/l\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e5 rows × 21 columns\u003c/p\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"   WBodyID                     WaterBodyName       DataSource StationID  \\\n0  9000108  Lower Tidal Caloosahatchee River  STORET_21FLEECO  DEEPGR10   \n1  9000108  Lower Tidal Caloosahatchee River  STORET_21FLEECO  DEEPGR10   \n2  9000108  Lower Tidal Caloosahatchee River  STORET_21FLEECO  DEEPGR10   \n3  9000108  Lower Tidal Caloosahatchee River  STORET_21FLEECO  DEEPGR10   \n4  9000108  Lower Tidal Caloosahatchee River  STORET_21FLEECO  DEEPGR10   \n\n                    StationName Actual_StationID  Actual_Latitude  \\\n0   DEEP LAGOON- McGregor Blvd.         DEEPGR10         26.53932   \n1   DEEP LAGOON- McGregor Blvd.         DEEPGR10         26.53932   \n2   DEEP LAGOON- McGregor Blvd.         DEEPGR10         26.53932   \n3   DEEP LAGOON- McGregor Blvd.         DEEPGR10         26.53932   \n4   DEEP LAGOON- McGregor Blvd.         DEEPGR10         26.53932   \n\n   Actual_Longitude DEP_WBID       SampleDate  ...  DepthUnits Parameter  \\\n0          -81.9188    3240A  10/16/1990 0:00  ...           m    TP_mgl   \n1          -81.9188    3240A  10/16/1990 0:00  ...           m    TN_mgl   \n2          -81.9188    3240A  10/31/1990 0:00  ...           m    TN_mgl   \n3          -81.9188    3240A  10/31/1990 0:00  ...           m    TP_mgl   \n4          -81.9188    3240A  11/19/1990 0:00  ...           m    TP_mgl   \n\n    Characteristic Sample_Fraction Result_Value  Result_Unit QACode  \\\n0  Phosphorus as P           Total         0.16         mg/l    NaN   \n1         Nitrogen           Total         1.27         mg/l    NaN   \n2         Nitrogen           Total         4.77         mg/l    NaN   \n3  Phosphorus as P           Total         0.10         mg/l    NaN   \n4  Phosphorus as P           Total         0.11         mg/l    NaN   \n\n                          Result_Comment Original_Result_Value  \\\n0                                    NaN                  0.16   \n1  Water Institute Calculated: TKN + NOx                   NaN   \n2  Water Institute Calculated: TKN + NOx                   NaN   \n3                                    NaN                  0.10   \n4                                    NaN                  0.11   \n\n   Original_Result_Unit  \n0                  mg/l  \n1                   NaN  \n2                   NaN  \n3                  mg/l  \n4                  mg/l  \n\n[5 rows x 21 columns]","content_type":"text/plain"}}},"children":[],"key":"pxfBubvNBI"}],"key":"iFupRpOMbZ"}],"key":"yJmn2q7cUY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.6 Total Phosphorous Over Time (Outliers Removed)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nfejbLCGZm"}],"identifier":"id-2-6-total-phosphorous-over-time-outliers-removed","label":"2.6 Total Phosphorous Over Time (Outliers Removed)","html_id":"id-2-6-total-phosphorous-over-time-outliers-removed","implicit":true,"key":"Fackp23Lze"}],"key":"TS9dcExcBB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section repeats the methods of Section 2.2 for the tidal Caloosahatchee River.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uPZ62g0AzP"}],"key":"Fdf1j7G2mk"}],"key":"mtXMQUT858"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\n\n# Strip any trailing/leading whitespace from column names\nnutrient_tidal.columns = nutrient_tidal.columns.str.strip()\n\n# --- Convert TP values to numeric ---\ntp_data_tidal = nutrient_tidal[nutrient_tidal['Parameter'] == 'TP_mgl'].copy()\ntp_data_tidal['Result_Value'] = pd.to_numeric(tp_data_tidal['Result_Value'], errors='coerce')\ntp_data_tidal['SampleDate'] = pd.to_datetime(tp_data_tidal['SampleDate'], errors='coerce')\n\n# --- Remove NaNs ---\ntp_clean_tidal = tp_data_tidal.dropna(subset=['Result_Value'])\n\n# --- Detect outliers using IQR ---\nQ1_tp = tp_clean_tidal['Result_Value'].quantile(0.25)\nQ3_tp = tp_clean_tidal['Result_Value'].quantile(0.75)\nIQR_tp = Q3_tp - Q1_tp\n\n# --- Filter out outliers ---\ntp_filtered_tidal = tp_clean_tidal[\n    (tp_clean_tidal['Result_Value'] \u003e= Q1_tp - 1.5 * IQR_tp) \u0026\n    (tp_clean_tidal['Result_Value'] \u003c= Q3_tp + 1.5 * IQR_tp)\n]\n\n# --- Plot Filtered TP data ---\nplt.figure(figsize=(10, 4))\nplt.scatter(tp_filtered_tidal['SampleDate'], tp_filtered_tidal['Result_Value'], \n            alpha=0.5, color='blue', label='Total Phosphorus (Filtered)')\nplt.title('Total Phosphorus (TP) Concentration Over Time (Outliers Removed) - Tidal Caloosahatchee')\nplt.xlabel('Sample Date')\nplt.ylabel('TP (mg/L)')\nplt.grid(True)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"ms7k3x8B21"},{"type":"outputs","id":"oidJ5IGDnNDZk-8D7CaBo","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a3be7f318b0f0fca77ab517aa68da786","path":"/red-tide-book//build/a3be7f318b0f0fca77ab517aa68da786.png"},"text/plain":{"content":"\u003cFigure size 1000x400 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"I9KwMoLbqd"}],"key":"wDDlqjAFsA"}],"key":"o8dYr1qrf5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.7 Total Nitrogen Over Time (Outliers Removed)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fap2kXOpLz"}],"identifier":"id-2-7-total-nitrogen-over-time-outliers-removed","label":"2.7 Total Nitrogen Over Time (Outliers Removed)","html_id":"id-2-7-total-nitrogen-over-time-outliers-removed","implicit":true,"key":"UfDRNGuYIM"}],"key":"rmWraLx1k6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section repeats the methods of Section 2.3 for the tidal Caloosahatchee River.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cmE0Joz2nD"}],"key":"aFLX9L3JiB"}],"key":"acQQ0Nwqbc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\nimport numpy as np\n\n# Filter and convert TN values\ntn_data_tidal = nutrient_tidal[nutrient_tidal['Parameter'] == 'TN_mgl'].copy()\ntn_data_tidal['Result_Value'] = pd.to_numeric(tn_data_tidal['Result_Value'], errors='coerce')\ntn_data_tidal['SampleDate'] = pd.to_datetime(tn_data_tidal['SampleDate'], errors='coerce')\n\n# Remove NaNs\ntn_clean_tidal = tn_data_tidal.dropna(subset=['Result_Value'])\n\n# Detect outliers using IQR\nQ1_tn_tidal = tn_clean_tidal['Result_Value'].quantile(0.25)\nQ3_tn_tidal = tn_clean_tidal['Result_Value'].quantile(0.75)\nIQR_tn_tidal = Q3_tn_tidal - Q1_tn_tidal\n\n# Filter out outliers\ntn_filtered_tidal = tn_clean_tidal[\n    (tn_clean_tidal['Result_Value'] \u003e= Q1_tn_tidal - 1.5 * IQR_tn_tidal) \u0026\n    (tn_clean_tidal['Result_Value'] \u003c= Q3_tn_tidal + 1.5 * IQR_tn_tidal)\n]\n\n# Plot Filtered TN data\nplt.figure(figsize=(10, 4))\nplt.scatter(tn_filtered_tidal['SampleDate'], tn_filtered_tidal['Result_Value'], \n            alpha=0.5, color='green', label='Total Nitrogen (Filtered)')\nplt.title('Total Nitrogen (TN) Concentration Over Time (Outliers Removed) - Tidal Caloosahatchee')\nplt.xlabel('Sample Date')\nplt.ylabel('TN (mg/L)')\nplt.grid(True)\nplt.legend()\nplt.tight_layout()\nplt.show()","key":"Jk9Y36TnnO"},{"type":"outputs","id":"d9j0vz-OXlyxlZDrfq_3C","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7b91cdb1188f6aafc68a91d878c46b9f","path":"/red-tide-book//build/7b91cdb1188f6aafc68a91d878c46b9f.png"},"text/plain":{"content":"\u003cFigure size 1000x400 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"lANSWm5DQp"}],"key":"TlyUmM53xK"}],"key":"ntdhgxpahd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.8 Combined TN and TP Trendline, Fort Myers (Outliers Removed)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xriSGSkQJn"}],"identifier":"id-2-8-combined-tn-and-tp-trendline-fort-myers-outliers-removed","label":"2.8 Combined TN and TP Trendline, Fort Myers (Outliers Removed)","html_id":"id-2-8-combined-tn-and-tp-trendline-fort-myers-outliers-removed","implicit":true,"key":"IvzKZ8XYfL"}],"key":"rZOjnWYSLj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This section repeats the methods of Section 2.4 for the tidal Caloosahatchee River.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dq7SSdbS1D"}],"key":"Ngyr4jAYNO"}],"key":"uVQ7QZbtoV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Resample monthly and interpolate missing months for Tidal Caloosahatchee ---\ntn_monthly_tidal = tn_filtered_tidal.set_index('SampleDate')['Result_Value'] \\\n    .resample('M').mean().asfreq('M').interpolate()\n\ntp_monthly_tidal = tp_filtered_tidal.set_index('SampleDate')['Result_Value'] \\\n    .resample('M').mean().asfreq('M').interpolate()","key":"TGCSmPCIUQ"},{"type":"outputs","id":"9uucC7nYKocpYWve8yejn","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\4036337590.py:3: FutureWarning: 'M' is deprecated and will be removed in a future version, please use 'ME' instead.\n  .resample('M').mean().asfreq('M').interpolate()\nC:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\4036337590.py:6: FutureWarning: 'M' is deprecated and will be removed in a future version, please use 'ME' instead.\n  .resample('M').mean().asfreq('M').interpolate()\n"},"children":[],"key":"dE5bkJKSBl"}],"key":"N9rNZehE6Z"}],"key":"T2jP0OcMAJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# --- Plot TN and TP trends for Tidal Caloosahatchee in stacked subplots ---\nfig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 8), sharex=True)\n\n# TN plot\nax1.plot(tn_monthly_tidal.index, tn_monthly_tidal.values, color='green', linewidth=2, label='Total Nitrogen (TN)')\nax1.set_ylabel('TN (mg/L)')\nax1.set_title('Monthly Trend of Total Nitrogen (Tidal Caloosahatchee)')\nax1.grid(True)\nax1.legend()\n\n# TP plot\nax2.plot(tp_monthly_tidal.index, tp_monthly_tidal.values, color='blue', linewidth=2, label='Total Phosphorus (TP)')\nax2.set_ylabel('TP (mg/L)')\nax2.set_title('Monthly Trend of Total Phosphorus (Tidal Caloosahatchee)')\nax2.set_xlabel('Date')\nax2.grid(True)\nax2.legend()\n\nplt.tight_layout()\nplt.show()","key":"cu4G6JnXEY"},{"type":"outputs","id":"DcYK8o3qxq3S7A_swtAOS","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c569154706f47f7f1725206640f5f995","path":"/red-tide-book//build/c569154706f47f7f1725206640f5f995.png"},"text/plain":{"content":"\u003cFigure size 1400x800 with 2 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"k9LkaN01mf"}],"key":"wISIM8szLS"}],"key":"vD6umZooOV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.9 Combined and Averaged Time Series for the Caloosahatchee River","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"no0Gu9mH1M"}],"identifier":"id-2-9-combined-and-averaged-time-series-for-the-caloosahatchee-river","label":"2.9 Combined and Averaged Time Series for the Caloosahatchee River","html_id":"id-2-9-combined-and-averaged-time-series-for-the-caloosahatchee-river","implicit":true,"key":"K75cGLCgdg"}],"key":"nKjmNyqjXR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To better support the machine learning analysis, we combined the TN and TP data from both the upper (Olga) and lower (Fort Myers) Caloosahatchee River sites.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WBSM1TQXsQ"}],"key":"xKi3pLtFpQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This was done by averaging the monthly resampled and interpolated TN and TP concentrations from both locations. The result is a single, unified timeseries for TN and TP that represents the average nutrient concentrations flowing out of the Caloosahatchee River.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B6fqUdAxXo"}],"key":"G7ZVh207SO"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This provides a more comprehensive and simplified input for evaluating how nutrient levels may correlate with harmful algal bloom (HAB) activity in downstream coastal waters.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D9zPHYZ8CL"}],"key":"m9PCt26Zbz"}],"key":"HTFGKOUccM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# --- Combine and average monthly TN and TP data from upper and tidal Caloosahatchee ---\n\n# First align the date indices to ensure no mismatch\ntn_monthly_upper = tn_monthly_upper.sort_index()\ntp_monthly_upper = tp_monthly_upper.sort_index()\ntn_monthly_tidal = tn_monthly_tidal.sort_index()\ntp_monthly_tidal = tp_monthly_tidal.sort_index()\n\n# Align on same monthly date index (outer join, then take average where both exist)\ncombined_tn = pd.concat([tn_monthly_upper, tn_monthly_tidal], axis=1)\ncombined_tp = pd.concat([tp_monthly_upper, tp_monthly_tidal], axis=1)\n\n# Rename columns for clarity\ncombined_tn.columns = ['TN_Upper', 'TN_Tidal']\ncombined_tp.columns = ['TP_Upper', 'TP_Tidal']\n\n# Take the average (will ignore NaN if one side is missing)\ncombined_tn['TN_Avg'] = combined_tn.mean(axis=1)\ncombined_tp['TP_Avg'] = combined_tp.mean(axis=1)\n\n# Extract final single-column Series for modeling\ntn_avg = combined_tn['TN_Avg']\ntp_avg = combined_tp['TP_Avg']","key":"NZMdvHBeMi"},{"type":"outputs","id":"qOHBvQn9IzKR8f8dYOizy","children":[],"key":"l5kARy66RO"}],"key":"CLRpXntqFH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Create side-by-side subplots\nfig, (ax1, ax2) = plt.subplots(2, 1, figsize=(14, 8), sharex=True)\n\n# Plot TN\nax1.plot(tn_avg.index, tn_avg.values, color='green', linewidth=2, label='Avg Total Nitrogen (TN)')\nax1.set_ylabel('TN (mg/L)')\nax1.set_title('Monthly Average Total Nitrogen from Caloosahatchee River')\nax1.grid(True)\nax1.legend()\n\n# Plot TP\nax2.plot(tp_avg.index, tp_avg.values, color='blue', linewidth=2, label='Avg Total Phosphorus (TP)')\nax2.set_ylabel('TP (mg/L)')\nax2.set_title('Monthly Average Total Phosphorus from Caloosahatchee River')\nax2.set_xlabel('Date')\nax2.grid(True)\nax2.legend()\n\nplt.tight_layout()\nplt.show()","key":"r26cOZqbl3"},{"type":"outputs","id":"lTsRCky8Qv85K2DWjWGDF","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0c7764694db0f4a8b19c9b934e921196","path":"/red-tide-book//build/0c7764694db0f4a8b19c9b934e921196.png"},"text/plain":{"content":"\u003cFigure size 1400x800 with 2 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"Bpnn52SrFJ"}],"key":"KGDPPY0BU0"}],"key":"vewA0Oy4Gz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. Resampling Caloosahatchee TN and TP to Match Peace River","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OxRHzIzbQ3"}],"identifier":"id-3-resampling-caloosahatchee-tn-and-tp-to-match-peace-river","label":"3. Resampling Caloosahatchee TN and TP to Match Peace River","html_id":"id-3-resampling-caloosahatchee-tn-and-tp-to-match-peace-river","implicit":true,"key":"lNmm4gHRcQ"}],"key":"rQBxv94Awv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are discrepancies between the Peace River and Caloosahatchee River TN and TP datasets. Namely, the Peace River TN and TP is sampled daily and is measured in ugl, while the Caloosahatchee River TN and TP is averaged monthly and measured in mgl. The following code updates the Caloosahatchee River data to match the Peace River data in preparation for creating a feature file to be used in the Peace River code.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o1LctLZ9SO"}],"key":"oCjxwdUWRS"}],"key":"A3hEpiy1ST"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\n\n# --- Load upper and tidal nutrient data ---\ndf_upper = pd.read_csv(\"TN_TP_Caloosa.csv\")\ndf_tidal = pd.read_csv(\"TN_TP_Tidal_Caloosa.csv\")\n\ndef prepare_daily_nutrient_series(df, tn_code='TN_mgl', tp_code='TP_mgl'):\n    df = df.copy()\n\n    # Convert to datetime\n    df['SampleDate'] = pd.to_datetime(df['SampleDate'])\n\n    # Filter for TN and TP\n    df_tn = df[df['Parameter'] == tn_code][['SampleDate', 'Result_Value']].copy()\n    df_tp = df[df['Parameter'] == tp_code][['SampleDate', 'Result_Value']].copy()\n\n    # Convert mg/L to µg/L\n    df_tn['Result_Value'] *= 1000\n    df_tp['Result_Value'] *= 1000\n\n    # Group by date and average if more than one reading per day\n    tn_daily = df_tn.groupby('SampleDate').mean()\n    tp_daily = df_tp.groupby('SampleDate').mean()\n\n    # Reindex to full date range and interpolate missing days\n    full_range = pd.date_range(start=df['SampleDate'].min(), end=df['SampleDate'].max(), freq='D')\n    tn_daily = tn_daily.reindex(full_range).interpolate()\n    tp_daily = tp_daily.reindex(full_range).interpolate()\n\n    # Rename columns for clarity\n    tn_daily.columns = ['TN']\n    tp_daily.columns = ['TP']\n\n    return tn_daily, tp_daily\n\n# --- Prepare upper and tidal separately ---\ntn_upper, tp_upper = prepare_daily_nutrient_series(df_upper)\ntn_tidal, tp_tidal = prepare_daily_nutrient_series(df_tidal)\n\n# --- Combine and average across stations ---\ncombined_tn = pd.concat([tn_upper, tn_tidal], axis=1)\ncombined_tp = pd.concat([tp_upper, tp_tidal], axis=1)\n\ncombined_tn.columns = ['TN_Upper', 'TN_Tidal']\ncombined_tp.columns = ['TP_Upper', 'TP_Tidal']\n\n# Take the daily average (ignores NaN if only one site sampled)\ncombined_tn['TN_Avg'] = combined_tn.mean(axis=1)\ncombined_tp['TP_Avg'] = combined_tp.mean(axis=1)\n\n# Extract final time series\ntn_avg = combined_tn[['TN_Avg']]\ntp_avg = combined_tp[['TP_Avg']]\n\n# Optional: merge into one DataFrame\ndf_nutrients_daily = pd.concat([tn_avg, tp_avg], axis=1)\n\n# View result\nprint(df_nutrients_daily.head())\n","key":"dIPvW3p4sQ"},{"type":"outputs","id":"Gw_lFdS3cKaLXgQaZYDV-","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"                 TN_Avg  TP_Avg\n1990-10-16  1270.000000   160.0\n1990-10-17  1503.333333   156.0\n1990-10-18  1736.666667   152.0\n1990-10-19  1970.000000   148.0\n1990-10-20  2203.333333   144.0\n"},"children":[],"key":"hGhBKHilHP"}],"key":"WRjJiYqveJ"}],"key":"TpHMgvyxom"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Combine Discharge and TN/TP Data Frames","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xxU1Gv2sKD"}],"identifier":"id-4-combine-discharge-and-tn-tp-data-frames","label":"4. Combine Discharge and TN/TP Data Frames","html_id":"id-4-combine-discharge-and-tn-tp-data-frames","implicit":true,"key":"LWE4r1Nolk"}],"key":"r3XelE03rS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Below, we combined daily-averaged discharge, total nitrogen, and total phosphorus data into a unified feature set. Discharge was downsampled to match the monthly resolution of the nutrient data. This dataset captures key flow and nutrient conditions from the Caloosahatchee River system and is structured to match the Peace River format for ML modeling.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uqx4eJogjL"}],"key":"bKxcjHg9g9"}],"key":"hAVJvTPKtk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(df_dis.index)\nprint(df_nutrients_daily.index)","key":"RxoaLUVmyz"},{"type":"outputs","id":"TibZX4rZoCCcPcItmR4tG","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"RangeIndex(start=0, stop=11783, step=1)\nDatetimeIndex(['1990-10-16', '1990-10-17', '1990-10-18', '1990-10-19',\n               '1990-10-20', '1990-10-21', '1990-10-22', '1990-10-23',\n               '1990-10-24', '1990-10-25',\n               ...\n               '2025-01-04', '2025-01-05', '2025-01-06', '2025-01-07',\n               '2025-01-08', '2025-01-09', '2025-01-10', '2025-01-11',\n               '2025-01-12', '2025-01-13'],\n              dtype='datetime64[ns]', length=12509, freq='D')\n"},"children":[],"key":"vDPQ28Wbpw"}],"key":"qF3odBzQHp"}],"key":"s6ZB9kkgCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert df_dis['Date'] to datetime and set it as index\ndf_dis['Date'] = pd.to_datetime(df_dis['Date'])\ndf_dis.set_index('Date', inplace=True)\n\n# Make sure df_nutrients_daily index is also datetime (you've already done this)\ndf_nutrients_daily.index = pd.to_datetime(df_nutrients_daily.index)\n\n# Now safely concatenate based on the datetime index\ndf_combined = pd.concat([df_dis, df_nutrients_daily], axis=1, join='inner')  # only keeps overlapping dates\n\n# Drop any remaining NaNs if needed\ndf_combined.dropna(inplace=True)\n\n# Check results\nprint(df_combined.head())","key":"swpA2yiocw"},{"type":"outputs","id":"XPb_gk2_AIPGzePKHLXgC","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"           Source  Site Number Discharge       TN_Avg  TP_Avg\n1993-01-01   USGS      2292900      14.0  1126.071429    70.0\n1993-01-02   USGS      2292900     160.0  1076.428571    70.0\n1993-01-03   USGS      2292900     820.0  1026.785714    70.0\n1993-01-04   USGS      2292900      11.0   977.142857    70.0\n1993-01-05   USGS      2292900       9.2   927.500000    70.0\n"},"children":[],"key":"Eauq9hX0VH"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\534825520.py:2: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n  df_dis['Date'] = pd.to_datetime(df_dis['Date'])\n"},"children":[],"key":"EWc4nvkmC0"}],"key":"dSKxcV9VOT"}],"key":"IIEBbS6lLN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Ensure Date column is present and set as datetime index for df_dis\ndf_dis = df_dis.copy()\nif df_dis.index.name == 'Date':\n    df_dis.reset_index(inplace=True)  # brings 'Date' back as a column\n\ndf_dis['Date'] = pd.to_datetime(df_dis['Date'])  # ensure datetime format\ndf_dis.set_index('Date', inplace=True)  # set as index for alignment\n\n# Ensure df_nutrients_daily index is datetime\ndf_nutrients_daily.index = pd.to_datetime(df_nutrients_daily.index)\n\n# Concatenate on aligned datetime index\ndf_combined = pd.concat([df_dis, df_nutrients_daily], axis=1, join='inner')\n\n# Rename nutrient columns to match ML features\ndf_combined.rename(columns={\n    'TN_Avg': 'caloosa_total_nitrogen',\n    'TP_Avg': 'caloosa_total_phosphorus'\n}, inplace=True)\n\n# Drop rows with missing data\ndf_combined.dropna(inplace=True)\n\n# Reset index so 'Date' becomes a column again\ndf_combined.reset_index(inplace=True)\n\n# Confirm the column is actually named 'Date'\nprint(df_combined.columns)\n\n# Save to CSV (no need to reselect columns if they're already right)\ndf_combined.to_csv('caloosa_features.csv', index=False)\n\n# View result\nprint(df_combined.head())","key":"eTIoiKWs9L"},{"type":"outputs","id":"4wiij0Cfdtk0yP0h1QCB0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Index(['index', 'Source', 'Site Number', 'Discharge', 'caloosa_total_nitrogen',\n       'caloosa_total_phosphorus'],\n      dtype='object')\n       index Source  Site Number Discharge  caloosa_total_nitrogen  \\\n0 1993-01-01   USGS      2292900      14.0             1126.071429   \n1 1993-01-02   USGS      2292900     160.0             1076.428571   \n2 1993-01-03   USGS      2292900     820.0             1026.785714   \n3 1993-01-04   USGS      2292900      11.0              977.142857   \n4 1993-01-05   USGS      2292900       9.2              927.500000   \n\n   caloosa_total_phosphorus  \n0                      70.0  \n1                      70.0  \n2                      70.0  \n3                      70.0  \n4                      70.0  \n"},"children":[],"key":"rQcoXw2wtw"}],"key":"pyApOCPbey"}],"key":"K5QAW8OlRh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Reset index so 'Date' becomes a column again\ndf_combined.reset_index(inplace=True)\n\n# Rename the index column to 'Date' explicitly\ndf_combined.rename(columns={'index': 'Date'}, inplace=True)\n\n# Optional: reorder columns\ndf_combined = df_combined[['Date', 'Discharge', 'caloosa_total_nitrogen', 'caloosa_total_phosphorus']]\n\n# Save to CSV\ndf_combined.to_csv('caloosa_features.csv', index=False)\n\n# Preview\nprint(df_combined.head())","key":"lLSIgLPoV1"},{"type":"outputs","id":"ZWrBNIFXbHhnRjYDYv_Vl","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"        Date Discharge  caloosa_total_nitrogen  caloosa_total_phosphorus\n0 1993-01-01      14.0             1126.071429                      70.0\n1 1993-01-02     160.0             1076.428571                      70.0\n2 1993-01-03     820.0             1026.785714                      70.0\n3 1993-01-04      11.0              977.142857                      70.0\n4 1993-01-05       9.2              927.500000                      70.0\n"},"children":[],"key":"JqB8FF6eiU"}],"key":"jRMBlqAmDD"}],"key":"eiWm9qUDV6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Rename 'Discharge' to match naming convention\ndf_combined.rename(columns={'Discharge': 'caloosa_discharge'}, inplace=True)\ndf_combined.head()","key":"EfMlUqahFJ"},{"type":"outputs","id":"kD_Vn5lcq1TCDUV9yc8j_","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003eDate\u003c/th\u003e\n      \u003cth\u003ecaloosa_discharge\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_phosphorus\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e1993-01-01\u003c/td\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n      \u003ctd\u003e1126.071429\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e1993-01-02\u003c/td\u003e\n      \u003ctd\u003e160.0\u003c/td\u003e\n      \u003ctd\u003e1076.428571\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e1993-01-03\u003c/td\u003e\n      \u003ctd\u003e820.0\u003c/td\u003e\n      \u003ctd\u003e1026.785714\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e1993-01-04\u003c/td\u003e\n      \u003ctd\u003e11.0\u003c/td\u003e\n      \u003ctd\u003e977.142857\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e1993-01-05\u003c/td\u003e\n      \u003ctd\u003e9.2\u003c/td\u003e\n      \u003ctd\u003e927.500000\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"        Date caloosa_discharge  caloosa_total_nitrogen  \\\n0 1993-01-01              14.0             1126.071429   \n1 1993-01-02             160.0             1076.428571   \n2 1993-01-03             820.0             1026.785714   \n3 1993-01-04              11.0              977.142857   \n4 1993-01-05               9.2              927.500000   \n\n   caloosa_total_phosphorus  \n0                      70.0  \n1                      70.0  \n2                      70.0  \n3                      70.0  \n4                      70.0  ","content_type":"text/plain"}}},"children":[],"key":"cWdK7hD5aO"}],"key":"xaRudKAhTa"}],"key":"WcMwis00S3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"4. Create Caloosahatchee Features File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OKJdnhB5PY"}],"identifier":"id-4-create-caloosahatchee-features-file","label":"4. Create Caloosahatchee Features File","html_id":"id-4-create-caloosahatchee-features-file","implicit":true,"key":"poniSF1A09"}],"key":"mkQEjB0kGw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Restore date column for resampling\ndf_combined = pd.read_csv('caloosa_features.csv')  # Reload if needed\ndf_combined['Date'] = pd.to_datetime(df_combined['Date'])  # Ensure proper datetime type\ndf_combined.set_index('Date', inplace=True)  # Set Date as index for resampling\n# Rename 'Discharge' to match naming convention\ndf_combined.rename(columns={'Discharge': 'caloosa_discharge'}, inplace=True)\ndf_combined.head()","key":"panaPvjFjn"},{"type":"outputs","id":"Tg6J1gZ4-w6cnns522L11","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003ecaloosa_discharge\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_phosphorus\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003eDate\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1993-01-01\u003c/th\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n      \u003ctd\u003e1126.071429\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1993-01-02\u003c/th\u003e\n      \u003ctd\u003e160.0\u003c/td\u003e\n      \u003ctd\u003e1076.428571\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1993-01-03\u003c/th\u003e\n      \u003ctd\u003e820.0\u003c/td\u003e\n      \u003ctd\u003e1026.785714\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1993-01-04\u003c/th\u003e\n      \u003ctd\u003e11.0\u003c/td\u003e\n      \u003ctd\u003e977.142857\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1993-01-05\u003c/th\u003e\n      \u003ctd\u003e9.2\u003c/td\u003e\n      \u003ctd\u003e927.500000\u003c/td\u003e\n      \u003ctd\u003e70.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"            caloosa_discharge  caloosa_total_nitrogen  \\\nDate                                                    \n1993-01-01               14.0             1126.071429   \n1993-01-02              160.0             1076.428571   \n1993-01-03              820.0             1026.785714   \n1993-01-04               11.0              977.142857   \n1993-01-05                9.2              927.500000   \n\n            caloosa_total_phosphorus  \nDate                                  \n1993-01-01                      70.0  \n1993-01-02                      70.0  \n1993-01-03                      70.0  \n1993-01-04                      70.0  \n1993-01-05                      70.0  ","content_type":"text/plain"}}},"children":[],"key":"Cy8yhE0lrw"}],"key":"hINymxHCJM"}],"key":"PBHeV3e4Vk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5. Resample Caloosahatchee Data to Weekly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c7kEQqdE8V"}],"identifier":"id-5-resample-caloosahatchee-data-to-weekly","label":"5. Resample Caloosahatchee Data to Weekly","html_id":"id-5-resample-caloosahatchee-data-to-weekly","implicit":true,"key":"NvFwDAKFAf"}],"key":"SBSKqyMtIp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The final data for the Peace River parameters is interpolated weekly, so we need to resample the Calooshatchee data to weekly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZYJwbAOLNV"}],"key":"ioUGYiuv7T"}],"key":"aKoNpkym9X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Resample to weekly (Monday start) using mean for each variable\ndf_caloosa_weekly = df_combined.resample('W-MON').mean()\n\n# Optional: check the result\nprint(df_caloosa_weekly.head())\n\n# Save as a new weekly file to match the professor's format\ndf_caloosa_weekly.to_csv('caloosa_weekly.csv')\n","key":"az8IlHHQRY"},{"type":"outputs","id":"XNyQU-e5RfHB30urhWhp8","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"            caloosa_discharge  caloosa_total_nitrogen  \\\nDate                                                    \n1993-01-04         251.250000             1051.607143   \n1993-01-11        1528.600000              778.571429   \n1993-01-18        3398.571429              792.936508   \n1993-01-25        2687.000000              798.333333   \n1993-02-01        2979.142857              765.925926   \n\n            caloosa_total_phosphorus  \nDate                                  \n1993-01-04                 70.000000  \n1993-01-11                 70.000000  \n1993-01-18                 67.142857  \n1993-01-25                 58.000000  \n1993-02-01                 48.666667  \n"},"children":[],"key":"y9nh725fxu"}],"key":"G4qxwuyUrh"}],"key":"yxlwXI3GY2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5.1 Add Time Column to Caloosahatchee Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VBq1voSBAW"}],"identifier":"id-5-1-add-time-column-to-caloosahatchee-dataset","label":"5.1 Add Time Column to Caloosahatchee Dataset","html_id":"id-5-1-add-time-column-to-caloosahatchee-dataset","implicit":true,"key":"EkAgHBr7MU"}],"key":"clZqjpm8jG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\n\n# Load Caloosahatchee data with datetime index\ndf_caloosa = pd.read_csv('caloosa_weekly.csv', index_col=0, parse_dates=True)\n\n# Add 'time' column from index\ndf_caloosa['time'] = df_caloosa.index\n\n# Optional: move 'time' to the front\ndf_caloosa = df_caloosa[['time', 'caloosa_discharge', 'caloosa_total_nitrogen', 'caloosa_total_phosphorus']]\n\n# Save updated file\ndf_caloosa.to_csv('caloosa_weekly_with_time.csv', index=False)","key":"NKquKsz8aJ"},{"type":"outputs","id":"PJW4AGLkH61Za0lSEXJ5L","children":[],"key":"VfbTFKze5i"}],"key":"vggTjMSqXk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"5.2 Convert Caloosa TN and TP to mg/L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ki4k7Rzqzq"}],"identifier":"id-5-2-convert-caloosa-tn-and-tp-to-mg-l","label":"5.2 Convert Caloosa TN and TP to mg/L","html_id":"id-5-2-convert-caloosa-tn-and-tp-to-mg-l","implicit":true,"key":"ufOl4hhTja"}],"key":"hg1Ci1DuWH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load Caloosahatchee features with time column\ndf_caloosa = pd.read_csv(\"caloosa_weekly_with_time.csv\", parse_dates=['time'])\n\n# Convert TN and TP from µg/L to mg/L\ndf_caloosa['caloosa_total_nitrogen'] = df_caloosa['caloosa_total_nitrogen'] / 1000\ndf_caloosa['caloosa_total_phosphorus'] = df_caloosa['caloosa_total_phosphorus'] / 1000\n\n# Save updated version (overwrites file with corrected units)\ndf_caloosa.to_csv(\"caloosa_weekly_with_time.csv\", index=False)","key":"vQu5VHaYWK"},{"type":"outputs","id":"Rkr7q3Cei6KhcylwZJ9FC","children":[],"key":"C0XEneQA6j"}],"key":"CAVFSUOlJT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"6. Merge with Peace River Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NYmHCyqn5J"}],"identifier":"id-6-merge-with-peace-river-data","label":"6. Merge with Peace River Data","html_id":"id-6-merge-with-peace-river-data","implicit":true,"key":"PmdPoOBjVP"}],"key":"WnyO7v9jv7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load Peace River + atmospheric + ocean features\ndf_peace = pd.read_csv('data_weekly_intepolated.csv', parse_dates=['time'])\n\n# Load Caloosahatchee features\ndf_caloosa = pd.read_csv('caloosa_weekly_with_time.csv', parse_dates=['time'])\n\n# Merge on 'time' column\ndf_swfl_merged = pd.merge(df_peace, df_caloosa, on='time', how='outer')\n\n# Drop rows with missing values\ndf_swfl_merged.dropna(inplace=True)\n\n# Save merged dataset\ndf_swfl_merged.to_csv('swfl_merged_features.csv', index=False)\n\n# Preview merged dataset (optional)\ndf_swfl_merged.head()","key":"OqdDtWyXXF"},{"type":"outputs","id":"gH29XVSJ4kF9V0Z75G_ba","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003ekb\u003c/th\u003e\n      \u003cth\u003ezos\u003c/th\u003e\n      \u003cth\u003esalinity\u003c/th\u003e\n      \u003cth\u003ewater_temp\u003c/th\u003e\n      \u003cth\u003ewind_direction\u003c/th\u003e\n      \u003cth\u003ewind_speed\u003c/th\u003e\n      \u003cth\u003epeace_discharge\u003c/th\u003e\n      \u003cth\u003epeace_TN\u003c/th\u003e\n      \u003cth\u003epeace_TP\u003c/th\u003e\n      \u003cth\u003ecaloosa_discharge\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_phosphorus\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e1993-01-04\u003c/td\u003e\n      \u003ctd\u003e333.0\u003c/td\u003e\n      \u003ctd\u003e0.012906\u003c/td\u003e\n      \u003ctd\u003e33.043478\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e13.9\u003c/td\u003e\n      \u003ctd\u003e202.0\u003c/td\u003e\n      \u003ctd\u003e8.2000\u003c/td\u003e\n      \u003ctd\u003e1.999091\u003c/td\u003e\n      \u003ctd\u003e251.250000\u003c/td\u003e\n      \u003ctd\u003e1.051607\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e1993-01-11\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.015614\u003c/td\u003e\n      \u003ctd\u003e33.065217\u003c/td\u003e\n      \u003ctd\u003e27.0\u003c/td\u003e\n      \u003ctd\u003e118.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e423.0\u003c/td\u003e\n      \u003ctd\u003e10.1000\u003c/td\u003e\n      \u003ctd\u003e1.934545\u003c/td\u003e\n      \u003ctd\u003e1528.600000\u003c/td\u003e\n      \u003ctd\u003e0.778571\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e1993-01-18\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.021702\u003c/td\u003e\n      \u003ctd\u003e33.086957\u003c/td\u003e\n      \u003ctd\u003e27.1\u003c/td\u003e\n      \u003ctd\u003e108.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e1470.0\u003c/td\u003e\n      \u003ctd\u003e12.0000\u003c/td\u003e\n      \u003ctd\u003e1.870000\u003c/td\u003e\n      \u003ctd\u003e3398.571429\u003c/td\u003e\n      \u003ctd\u003e0.792937\u003c/td\u003e\n      \u003ctd\u003e0.067143\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e1993-01-25\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.015950\u003c/td\u003e\n      \u003ctd\u003e33.108696\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e110.0\u003c/td\u003e\n      \u003ctd\u003e12.6\u003c/td\u003e\n      \u003ctd\u003e1450.0\u003c/td\u003e\n      \u003ctd\u003e10.0475\u003c/td\u003e\n      \u003ctd\u003e1.870500\u003c/td\u003e\n      \u003ctd\u003e2687.000000\u003c/td\u003e\n      \u003ctd\u003e0.798333\u003c/td\u003e\n      \u003ctd\u003e0.058000\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e1993-02-01\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.008977\u003c/td\u003e\n      \u003ctd\u003e33.130435\u003c/td\u003e\n      \u003ctd\u003e26.5\u003c/td\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n      \u003ctd\u003e17.5\u003c/td\u003e\n      \u003ctd\u003e1490.0\u003c/td\u003e\n      \u003ctd\u003e8.0950\u003c/td\u003e\n      \u003ctd\u003e1.871000\u003c/td\u003e\n      \u003ctd\u003e2979.142857\u003c/td\u003e\n      \u003ctd\u003e0.765926\u003c/td\u003e\n      \u003ctd\u003e0.048667\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"        time     kb       zos   salinity  water_temp  wind_direction  \\\n0 1993-01-04  333.0  0.012906  33.043478        26.8            36.0   \n1 1993-01-11  667.0  0.015614  33.065217        27.0           118.0   \n2 1993-01-18  667.0  0.021702  33.086957        27.1           108.0   \n3 1993-01-25    0.0  0.015950  33.108696        26.8           110.0   \n4 1993-02-01    0.0  0.008977  33.130435        26.5            14.0   \n\n   wind_speed  peace_discharge  peace_TN  peace_TP  caloosa_discharge  \\\n0        13.9            202.0    8.2000  1.999091         251.250000   \n1        16.2            423.0   10.1000  1.934545        1528.600000   \n2        16.2           1470.0   12.0000  1.870000        3398.571429   \n3        12.6           1450.0   10.0475  1.870500        2687.000000   \n4        17.5           1490.0    8.0950  1.871000        2979.142857   \n\n   caloosa_total_nitrogen  caloosa_total_phosphorus  \n0                1.051607                  0.070000  \n1                0.778571                  0.070000  \n2                0.792937                  0.067143  \n3                0.798333                  0.058000  \n4                0.765926                  0.048667  ","content_type":"text/plain"}}},"children":[],"key":"pdP3KfQcrd"}],"key":"cvxch1KVBp"}],"key":"VNADtraGDn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_swfl_merged.tail()","key":"sxxcr9ypKB"},{"type":"outputs","id":"ArQGYoWyJ-Z8KAXA9v4C3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003ekb\u003c/th\u003e\n      \u003cth\u003ezos\u003c/th\u003e\n      \u003cth\u003esalinity\u003c/th\u003e\n      \u003cth\u003ewater_temp\u003c/th\u003e\n      \u003cth\u003ewind_direction\u003c/th\u003e\n      \u003cth\u003ewind_speed\u003c/th\u003e\n      \u003cth\u003epeace_discharge\u003c/th\u003e\n      \u003cth\u003epeace_TN\u003c/th\u003e\n      \u003cth\u003epeace_TP\u003c/th\u003e\n      \u003cth\u003ecaloosa_discharge\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_phosphorus\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1612\u003c/th\u003e\n      \u003ctd\u003e2023-11-27\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e-0.005114\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e27.110714\u003c/td\u003e\n      \u003ctd\u003e79.800000\u003c/td\u003e\n      \u003ctd\u003e11.666667\u003c/td\u003e\n      \u003ctd\u003e326.0\u003c/td\u003e\n      \u003ctd\u003e2.0675\u003c/td\u003e\n      \u003ctd\u003e0.8365\u003c/td\u003e\n      \u003ctd\u003e1822.857143\u003c/td\u003e\n      \u003ctd\u003e1.203413\u003c/td\u003e\n      \u003ctd\u003e0.152143\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1613\u003c/th\u003e\n      \u003ctd\u003e2023-12-04\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e-0.003981\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e26.992857\u003c/td\u003e\n      \u003ctd\u003e91.466667\u003c/td\u003e\n      \u003ctd\u003e12.306667\u003c/td\u003e\n      \u003ctd\u003e231.0\u003c/td\u003e\n      \u003ctd\u003e2.1800\u003c/td\u003e\n      \u003ctd\u003e0.8000\u003c/td\u003e\n      \u003ctd\u003e1336.571429\u003c/td\u003e\n      \u003ctd\u003e1.249048\u003c/td\u003e\n      \u003ctd\u003e0.150464\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1614\u003c/th\u003e\n      \u003ctd\u003e2023-12-11\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e-0.009013\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e26.528571\u003c/td\u003e\n      \u003ctd\u003e83.833333\u003c/td\u003e\n      \u003ctd\u003e12.086667\u003c/td\u003e\n      \u003ctd\u003e201.0\u003c/td\u003e\n      \u003ctd\u003e1.8400\u003c/td\u003e\n      \u003ctd\u003e0.7900\u003c/td\u003e\n      \u003ctd\u003e1782.857143\u003c/td\u003e\n      \u003ctd\u003e1.151432\u003c/td\u003e\n      \u003ctd\u003e0.136031\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1615\u003c/th\u003e\n      \u003ctd\u003e2023-12-18\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.005557\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e26.207143\u003c/td\u003e\n      \u003ctd\u003e110.433333\u003c/td\u003e\n      \u003ctd\u003e12.176667\u003c/td\u003e\n      \u003ctd\u003e460.0\u003c/td\u003e\n      \u003ctd\u003e2.2080\u003c/td\u003e\n      \u003ctd\u003e0.9700\u003c/td\u003e\n      \u003ctd\u003e1845.714286\u003c/td\u003e\n      \u003ctd\u003e1.038714\u003c/td\u003e\n      \u003ctd\u003e0.119810\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1616\u003c/th\u003e\n      \u003ctd\u003e2023-12-25\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.001243\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e26.053571\u003c/td\u003e\n      \u003ctd\u003e92.166667\u003c/td\u003e\n      \u003ctd\u003e13.396667\u003c/td\u003e\n      \u003ctd\u003e470.0\u003c/td\u003e\n      \u003ctd\u003e2.2080\u003c/td\u003e\n      \u003ctd\u003e0.9700\u003c/td\u003e\n      \u003ctd\u003e1798.571429\u003c/td\u003e\n      \u003ctd\u003e1.017036\u003c/td\u003e\n      \u003ctd\u003e0.111671\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"           time   kb       zos  salinity  water_temp  wind_direction  \\\n1612 2023-11-27  0.0 -0.005114      36.0   27.110714       79.800000   \n1613 2023-12-04  0.0 -0.003981      36.0   26.992857       91.466667   \n1614 2023-12-11  0.0 -0.009013      36.0   26.528571       83.833333   \n1615 2023-12-18  0.0  0.005557      36.0   26.207143      110.433333   \n1616 2023-12-25  0.0  0.001243      36.0   26.053571       92.166667   \n\n      wind_speed  peace_discharge  peace_TN  peace_TP  caloosa_discharge  \\\n1612   11.666667            326.0    2.0675    0.8365        1822.857143   \n1613   12.306667            231.0    2.1800    0.8000        1336.571429   \n1614   12.086667            201.0    1.8400    0.7900        1782.857143   \n1615   12.176667            460.0    2.2080    0.9700        1845.714286   \n1616   13.396667            470.0    2.2080    0.9700        1798.571429   \n\n      caloosa_total_nitrogen  caloosa_total_phosphorus  \n1612                1.203413                  0.152143  \n1613                1.249048                  0.150464  \n1614                1.151432                  0.136031  \n1615                1.038714                  0.119810  \n1616                1.017036                  0.111671  ","content_type":"text/plain"}}},"children":[],"key":"Ye1h27Mc9h"}],"key":"nncp0yldwE"}],"key":"aQ2T1R60Uq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"7. Add Tampa KB Counts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SxIt9cHhHr"}],"identifier":"id-7-add-tampa-kb-counts","label":"7. Add Tampa KB Counts","html_id":"id-7-add-tampa-kb-counts","implicit":true,"key":"ovnSnjYZPa"}],"key":"b6zTK66hjz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\n\n# Load SWFL merged features\ndf_swfl = pd.read_csv('swfl_merged_features.csv', parse_dates=['time'])\n\n# Load full HABSOS dataset\ndf_tampa = pd.read_csv('habsos_20240430.csv', parse_dates=['SAMPLE_DATE'])\n\n# Filter to Tampa Bay region using your specified bounding box\ndf_tampa = df_tampa[\n    (df_tampa['LATITUDE'].between(27.4, 28.2)) \u0026\n    (df_tampa['LONGITUDE'].between(-83.0, -82.3))\n]\n\n# Rename columns for clarity\ndf_tampa.rename(columns={'SAMPLE_DATE': 'time', 'CELLCOUNT': 'kb_tampa'}, inplace=True)\n\n# Group by date to get daily average KB concentration for Tampa region\ndf_tampa_daily = df_tampa.groupby('time', as_index=False)['kb_tampa'].mean()\n\n# Merge with the existing SWFL dataset on 'time'\ndf_swfl_tampa = pd.merge(df_swfl, df_tampa_daily, on='time', how='left')\n\n# Save to new CSV file\ndf_swfl_tampa.to_csv('swfl_merged_features_tampa.csv', index=False)\n\n# Optional: preview the result\ndf_swfl_tampa.head()","key":"wP4kyrFBjF"},{"type":"outputs","id":"_08Zrpy1roV4_YUbewY_5","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\3940744265.py:7: DtypeWarning: Columns (21,24) have mixed types. Specify dtype option on import or set low_memory=False.\n  df_tampa = pd.read_csv('habsos_20240430.csv', parse_dates=['SAMPLE_DATE'])\n"},"children":[],"key":"V1qLZP6ZMV"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003ekb\u003c/th\u003e\n      \u003cth\u003ezos\u003c/th\u003e\n      \u003cth\u003esalinity\u003c/th\u003e\n      \u003cth\u003ewater_temp\u003c/th\u003e\n      \u003cth\u003ewind_direction\u003c/th\u003e\n      \u003cth\u003ewind_speed\u003c/th\u003e\n      \u003cth\u003epeace_discharge\u003c/th\u003e\n      \u003cth\u003epeace_TN\u003c/th\u003e\n      \u003cth\u003epeace_TP\u003c/th\u003e\n      \u003cth\u003ecaloosa_discharge\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_phosphorus\u003c/th\u003e\n      \u003cth\u003ekb_tampa\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e1993-01-04\u003c/td\u003e\n      \u003ctd\u003e333.0\u003c/td\u003e\n      \u003ctd\u003e0.012906\u003c/td\u003e\n      \u003ctd\u003e33.043478\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e13.9\u003c/td\u003e\n      \u003ctd\u003e202.0\u003c/td\u003e\n      \u003ctd\u003e8.2000\u003c/td\u003e\n      \u003ctd\u003e1.999091\u003c/td\u003e\n      \u003ctd\u003e251.250000\u003c/td\u003e\n      \u003ctd\u003e1.051607\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e1993-01-11\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.015614\u003c/td\u003e\n      \u003ctd\u003e33.065217\u003c/td\u003e\n      \u003ctd\u003e27.0\u003c/td\u003e\n      \u003ctd\u003e118.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e423.0\u003c/td\u003e\n      \u003ctd\u003e10.1000\u003c/td\u003e\n      \u003ctd\u003e1.934545\u003c/td\u003e\n      \u003ctd\u003e1528.600000\u003c/td\u003e\n      \u003ctd\u003e0.778571\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e1993-01-18\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.021702\u003c/td\u003e\n      \u003ctd\u003e33.086957\u003c/td\u003e\n      \u003ctd\u003e27.1\u003c/td\u003e\n      \u003ctd\u003e108.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e1470.0\u003c/td\u003e\n      \u003ctd\u003e12.0000\u003c/td\u003e\n      \u003ctd\u003e1.870000\u003c/td\u003e\n      \u003ctd\u003e3398.571429\u003c/td\u003e\n      \u003ctd\u003e0.792937\u003c/td\u003e\n      \u003ctd\u003e0.067143\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e1993-01-25\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.015950\u003c/td\u003e\n      \u003ctd\u003e33.108696\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e110.0\u003c/td\u003e\n      \u003ctd\u003e12.6\u003c/td\u003e\n      \u003ctd\u003e1450.0\u003c/td\u003e\n      \u003ctd\u003e10.0475\u003c/td\u003e\n      \u003ctd\u003e1.870500\u003c/td\u003e\n      \u003ctd\u003e2687.000000\u003c/td\u003e\n      \u003ctd\u003e0.798333\u003c/td\u003e\n      \u003ctd\u003e0.058000\u003c/td\u003e\n      \u003ctd\u003eNaN\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e1993-02-01\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.008977\u003c/td\u003e\n      \u003ctd\u003e33.130435\u003c/td\u003e\n      \u003ctd\u003e26.5\u003c/td\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n      \u003ctd\u003e17.5\u003c/td\u003e\n      \u003ctd\u003e1490.0\u003c/td\u003e\n      \u003ctd\u003e8.0950\u003c/td\u003e\n      \u003ctd\u003e1.871000\u003c/td\u003e\n      \u003ctd\u003e2979.142857\u003c/td\u003e\n      \u003ctd\u003e0.765926\u003c/td\u003e\n      \u003ctd\u003e0.048667\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"        time     kb       zos   salinity  water_temp  wind_direction  \\\n0 1993-01-04  333.0  0.012906  33.043478        26.8            36.0   \n1 1993-01-11  667.0  0.015614  33.065217        27.0           118.0   \n2 1993-01-18  667.0  0.021702  33.086957        27.1           108.0   \n3 1993-01-25    0.0  0.015950  33.108696        26.8           110.0   \n4 1993-02-01    0.0  0.008977  33.130435        26.5            14.0   \n\n   wind_speed  peace_discharge  peace_TN  peace_TP  caloosa_discharge  \\\n0        13.9            202.0    8.2000  1.999091         251.250000   \n1        16.2            423.0   10.1000  1.934545        1528.600000   \n2        16.2           1470.0   12.0000  1.870000        3398.571429   \n3        12.6           1450.0   10.0475  1.870500        2687.000000   \n4        17.5           1490.0    8.0950  1.871000        2979.142857   \n\n   caloosa_total_nitrogen  caloosa_total_phosphorus  kb_tampa  \n0                1.051607                  0.070000       0.0  \n1                0.778571                  0.070000       NaN  \n2                0.792937                  0.067143       NaN  \n3                0.798333                  0.058000       NaN  \n4                0.765926                  0.048667       0.0  ","content_type":"text/plain"}}},"children":[],"key":"sjyHlaZtNr"}],"key":"E7GYII1Rpw"}],"key":"Mmg0hk6pIK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_swfl_tampa['kb_tampa'] = df_swfl_tampa['kb_tampa'].fillna(0)","key":"ivabxc4Pil"},{"type":"outputs","id":"9q8it0qORvIGeFFEJBU27","children":[],"key":"v2rW01zPyc"}],"key":"NLb7aeeKr6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_swfl_tampa.to_csv('swfl_merged_features_tampa.csv', index=False)\ndf_swfl_tampa.head()","key":"uxzQYdzYja"},{"type":"outputs","id":"yoM8mq1eZuvsoU_tUuX2T","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003ekb\u003c/th\u003e\n      \u003cth\u003ezos\u003c/th\u003e\n      \u003cth\u003esalinity\u003c/th\u003e\n      \u003cth\u003ewater_temp\u003c/th\u003e\n      \u003cth\u003ewind_direction\u003c/th\u003e\n      \u003cth\u003ewind_speed\u003c/th\u003e\n      \u003cth\u003epeace_discharge\u003c/th\u003e\n      \u003cth\u003epeace_TN\u003c/th\u003e\n      \u003cth\u003epeace_TP\u003c/th\u003e\n      \u003cth\u003ecaloosa_discharge\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_phosphorus\u003c/th\u003e\n      \u003cth\u003ekb_tampa\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e1993-01-04\u003c/td\u003e\n      \u003ctd\u003e333.0\u003c/td\u003e\n      \u003ctd\u003e0.012906\u003c/td\u003e\n      \u003ctd\u003e33.043478\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e13.9\u003c/td\u003e\n      \u003ctd\u003e202.0\u003c/td\u003e\n      \u003ctd\u003e8.2000\u003c/td\u003e\n      \u003ctd\u003e1.999091\u003c/td\u003e\n      \u003ctd\u003e251.250000\u003c/td\u003e\n      \u003ctd\u003e1.051607\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e1993-01-11\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.015614\u003c/td\u003e\n      \u003ctd\u003e33.065217\u003c/td\u003e\n      \u003ctd\u003e27.0\u003c/td\u003e\n      \u003ctd\u003e118.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e423.0\u003c/td\u003e\n      \u003ctd\u003e10.1000\u003c/td\u003e\n      \u003ctd\u003e1.934545\u003c/td\u003e\n      \u003ctd\u003e1528.600000\u003c/td\u003e\n      \u003ctd\u003e0.778571\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e1993-01-18\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.021702\u003c/td\u003e\n      \u003ctd\u003e33.086957\u003c/td\u003e\n      \u003ctd\u003e27.1\u003c/td\u003e\n      \u003ctd\u003e108.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e1470.0\u003c/td\u003e\n      \u003ctd\u003e12.0000\u003c/td\u003e\n      \u003ctd\u003e1.870000\u003c/td\u003e\n      \u003ctd\u003e3398.571429\u003c/td\u003e\n      \u003ctd\u003e0.792937\u003c/td\u003e\n      \u003ctd\u003e0.067143\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e1993-01-25\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.015950\u003c/td\u003e\n      \u003ctd\u003e33.108696\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e110.0\u003c/td\u003e\n      \u003ctd\u003e12.6\u003c/td\u003e\n      \u003ctd\u003e1450.0\u003c/td\u003e\n      \u003ctd\u003e10.0475\u003c/td\u003e\n      \u003ctd\u003e1.870500\u003c/td\u003e\n      \u003ctd\u003e2687.000000\u003c/td\u003e\n      \u003ctd\u003e0.798333\u003c/td\u003e\n      \u003ctd\u003e0.058000\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e1993-02-01\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.008977\u003c/td\u003e\n      \u003ctd\u003e33.130435\u003c/td\u003e\n      \u003ctd\u003e26.5\u003c/td\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n      \u003ctd\u003e17.5\u003c/td\u003e\n      \u003ctd\u003e1490.0\u003c/td\u003e\n      \u003ctd\u003e8.0950\u003c/td\u003e\n      \u003ctd\u003e1.871000\u003c/td\u003e\n      \u003ctd\u003e2979.142857\u003c/td\u003e\n      \u003ctd\u003e0.765926\u003c/td\u003e\n      \u003ctd\u003e0.048667\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"        time     kb       zos   salinity  water_temp  wind_direction  \\\n0 1993-01-04  333.0  0.012906  33.043478        26.8            36.0   \n1 1993-01-11  667.0  0.015614  33.065217        27.0           118.0   \n2 1993-01-18  667.0  0.021702  33.086957        27.1           108.0   \n3 1993-01-25    0.0  0.015950  33.108696        26.8           110.0   \n4 1993-02-01    0.0  0.008977  33.130435        26.5            14.0   \n\n   wind_speed  peace_discharge  peace_TN  peace_TP  caloosa_discharge  \\\n0        13.9            202.0    8.2000  1.999091         251.250000   \n1        16.2            423.0   10.1000  1.934545        1528.600000   \n2        16.2           1470.0   12.0000  1.870000        3398.571429   \n3        12.6           1450.0   10.0475  1.870500        2687.000000   \n4        17.5           1490.0    8.0950  1.871000        2979.142857   \n\n   caloosa_total_nitrogen  caloosa_total_phosphorus  kb_tampa  \n0                1.051607                  0.070000       0.0  \n1                0.778571                  0.070000       0.0  \n2                0.792937                  0.067143       0.0  \n3                0.798333                  0.058000       0.0  \n4                0.765926                  0.048667       0.0  ","content_type":"text/plain"}}},"children":[],"key":"kMidK0Am79"}],"key":"sXY7cvKXml"}],"key":"BI6y2WfbYs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Add kb_tampa values to kb\ndf_swfl_tampa['kb'] = df_swfl_tampa['kb'] + df_swfl_tampa['kb_tampa']\n\n# Drop the kb_tampa column\ndf_swfl_tampa.drop(columns=['kb_tampa'], inplace=True)\ndf_swfl_tampa.to_csv('swfl_merged_features_tampa.csv', index=False)\ndf_swfl_tampa.head()","key":"J0T1MRdBxd"},{"type":"outputs","id":"H9nW86S1VD6w3jdQ0-NQi","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003ekb\u003c/th\u003e\n      \u003cth\u003ezos\u003c/th\u003e\n      \u003cth\u003esalinity\u003c/th\u003e\n      \u003cth\u003ewater_temp\u003c/th\u003e\n      \u003cth\u003ewind_direction\u003c/th\u003e\n      \u003cth\u003ewind_speed\u003c/th\u003e\n      \u003cth\u003epeace_discharge\u003c/th\u003e\n      \u003cth\u003epeace_TN\u003c/th\u003e\n      \u003cth\u003epeace_TP\u003c/th\u003e\n      \u003cth\u003ecaloosa_discharge\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_phosphorus\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003e1993-01-04\u003c/td\u003e\n      \u003ctd\u003e333.0\u003c/td\u003e\n      \u003ctd\u003e0.012906\u003c/td\u003e\n      \u003ctd\u003e33.043478\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e36.0\u003c/td\u003e\n      \u003ctd\u003e13.9\u003c/td\u003e\n      \u003ctd\u003e202.0\u003c/td\u003e\n      \u003ctd\u003e8.2000\u003c/td\u003e\n      \u003ctd\u003e1.999091\u003c/td\u003e\n      \u003ctd\u003e251.250000\u003c/td\u003e\n      \u003ctd\u003e1.051607\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003e1993-01-11\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.015614\u003c/td\u003e\n      \u003ctd\u003e33.065217\u003c/td\u003e\n      \u003ctd\u003e27.0\u003c/td\u003e\n      \u003ctd\u003e118.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e423.0\u003c/td\u003e\n      \u003ctd\u003e10.1000\u003c/td\u003e\n      \u003ctd\u003e1.934545\u003c/td\u003e\n      \u003ctd\u003e1528.600000\u003c/td\u003e\n      \u003ctd\u003e0.778571\u003c/td\u003e\n      \u003ctd\u003e0.070000\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003e1993-01-18\u003c/td\u003e\n      \u003ctd\u003e667.0\u003c/td\u003e\n      \u003ctd\u003e0.021702\u003c/td\u003e\n      \u003ctd\u003e33.086957\u003c/td\u003e\n      \u003ctd\u003e27.1\u003c/td\u003e\n      \u003ctd\u003e108.0\u003c/td\u003e\n      \u003ctd\u003e16.2\u003c/td\u003e\n      \u003ctd\u003e1470.0\u003c/td\u003e\n      \u003ctd\u003e12.0000\u003c/td\u003e\n      \u003ctd\u003e1.870000\u003c/td\u003e\n      \u003ctd\u003e3398.571429\u003c/td\u003e\n      \u003ctd\u003e0.792937\u003c/td\u003e\n      \u003ctd\u003e0.067143\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e3\u003c/th\u003e\n      \u003ctd\u003e1993-01-25\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.015950\u003c/td\u003e\n      \u003ctd\u003e33.108696\u003c/td\u003e\n      \u003ctd\u003e26.8\u003c/td\u003e\n      \u003ctd\u003e110.0\u003c/td\u003e\n      \u003ctd\u003e12.6\u003c/td\u003e\n      \u003ctd\u003e1450.0\u003c/td\u003e\n      \u003ctd\u003e10.0475\u003c/td\u003e\n      \u003ctd\u003e1.870500\u003c/td\u003e\n      \u003ctd\u003e2687.000000\u003c/td\u003e\n      \u003ctd\u003e0.798333\u003c/td\u003e\n      \u003ctd\u003e0.058000\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e4\u003c/th\u003e\n      \u003ctd\u003e1993-02-01\u003c/td\u003e\n      \u003ctd\u003e0.0\u003c/td\u003e\n      \u003ctd\u003e0.008977\u003c/td\u003e\n      \u003ctd\u003e33.130435\u003c/td\u003e\n      \u003ctd\u003e26.5\u003c/td\u003e\n      \u003ctd\u003e14.0\u003c/td\u003e\n      \u003ctd\u003e17.5\u003c/td\u003e\n      \u003ctd\u003e1490.0\u003c/td\u003e\n      \u003ctd\u003e8.0950\u003c/td\u003e\n      \u003ctd\u003e1.871000\u003c/td\u003e\n      \u003ctd\u003e2979.142857\u003c/td\u003e\n      \u003ctd\u003e0.765926\u003c/td\u003e\n      \u003ctd\u003e0.048667\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"        time     kb       zos   salinity  water_temp  wind_direction  \\\n0 1993-01-04  333.0  0.012906  33.043478        26.8            36.0   \n1 1993-01-11  667.0  0.015614  33.065217        27.0           118.0   \n2 1993-01-18  667.0  0.021702  33.086957        27.1           108.0   \n3 1993-01-25    0.0  0.015950  33.108696        26.8           110.0   \n4 1993-02-01    0.0  0.008977  33.130435        26.5            14.0   \n\n   wind_speed  peace_discharge  peace_TN  peace_TP  caloosa_discharge  \\\n0        13.9            202.0    8.2000  1.999091         251.250000   \n1        16.2            423.0   10.1000  1.934545        1528.600000   \n2        16.2           1470.0   12.0000  1.870000        3398.571429   \n3        12.6           1450.0   10.0475  1.870500        2687.000000   \n4        17.5           1490.0    8.0950  1.871000        2979.142857   \n\n   caloosa_total_nitrogen  caloosa_total_phosphorus  \n0                1.051607                  0.070000  \n1                0.778571                  0.070000  \n2                0.792937                  0.067143  \n3                0.798333                  0.058000  \n4                0.765926                  0.048667  ","content_type":"text/plain"}}},"children":[],"key":"YtEABRCLRe"}],"key":"uH95B5kt5A"}],"key":"wIE6cCum6h"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"8. Create Combined Data Series","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hNgFPBXR4X"}],"identifier":"id-8-create-combined-data-series","label":"8. Create Combined Data Series","html_id":"id-8-create-combined-data-series","implicit":true,"key":"ja8mzv0fzY"}],"key":"YD4rcSRu7b"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.dates as mdates\n\n# -----------------------------\n# Load merged weekly dataset\n# -----------------------------\n# If df_swfl_tampa already exists in your notebook, you can comment this out.\ndf = df_swfl_tampa.copy()\n\n# Ensure time is datetime + sorted\ndf[\"time\"] = pd.to_datetime(df[\"time\"])\ndf = df.sort_values(\"time\")\n\n# Keep only columns we need (and coerce to numeric where applicable)\ncols = [\n    \"time\",\n    \"kb\",\n    \"zos\",\n    \"salinity\",\n    \"water_temp\",\n    \"wind_direction\",\n    \"wind_speed\",\n    \"peace_discharge\",\n    \"caloosa_discharge\",\n    \"peace_TN\",\n    \"caloosa_total_nitrogen\",\n    \"peace_TP\",\n    \"caloosa_total_phosphorus\",\n]\ndf_plot = df[cols].copy()\n\nfor c in cols:\n    if c != \"time\":\n        df_plot[c] = pd.to_numeric(df_plot[c], errors=\"coerce\")\n\n# -----------------------------\n# Optional: match ML-ready behavior (drop rows with missing values)\n# -----------------------------\ndf_plot = df_plot.dropna()\n\n# -----------------------------\n# Output path\n# -----------------------------\nout_dir = r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Parameters\"\nos.makedirs(out_dir, exist_ok=True)\nout_path = os.path.join(out_dir, \"stacked_parameters_9panel.png\")\n\n# -----------------------------\n# Plot setup (9 stacked panels)\n# -----------------------------\nfig, axes = plt.subplots(\n    nrows=9,\n    ncols=1,\n    figsize=(14, 22),\n    sharex=True,\n    constrained_layout=True\n)\n\n# 1) Karenia brevis Cell Count\naxes[0].plot(df_plot[\"time\"], df_plot[\"kb\"], linewidth=1.0)\naxes[0].set_title(\"K.brevis Cell Count\")\naxes[0].set_ylabel(\"Cells L$^{-1}$\")\n\n# 2) Sea Surface Height (zos)\naxes[1].plot(df_plot[\"time\"], df_plot[\"zos\"], linewidth=1.0)\naxes[1].set_title(\"Sea Surface Height Anomaly (zos)\")\naxes[1].set_ylabel(\"SSH (m)\")\n\n# 3) Salinity\naxes[2].plot(df_plot[\"time\"], df_plot[\"salinity\"], linewidth=1.0)\naxes[2].set_title(\"Salinity\")\naxes[2].set_ylabel(\"Salinity (PSU)\")\n\n# 4) Water Temperature\naxes[3].plot(df_plot[\"time\"], df_plot[\"water_temp\"], linewidth=1.0)\naxes[3].set_title(\"Water Temperature\")\naxes[3].set_ylabel(\"Temp (°C)\")\n\n# 5) Wind Direction\naxes[4].plot(df_plot[\"time\"], df_plot[\"wind_direction\"], linewidth=1.0)\naxes[4].set_title(\"Wind Direction\")\naxes[4].set_ylabel(\"Direction (°)\")\naxes[4].set_ylim(0, 360)\n\n# 6) Wind Speed\naxes[5].plot(df_plot[\"time\"], df_plot[\"wind_speed\"], linewidth=1.0)\naxes[5].set_title(\"Wind Speed\")\naxes[5].set_ylabel(\"Speed (m s$^{-1}$)\")\n\n# 7) Peace + Caloosa Discharge (cfs)\naxes[6].plot(df_plot[\"time\"], df_plot[\"peace_discharge\"], linewidth=1.0, label=\"Peace River\")\naxes[6].plot(df_plot[\"time\"], df_plot[\"caloosa_discharge\"], linewidth=1.0, label=\"Caloosahatchee River\")\naxes[6].set_title(\"River Discharge\")\naxes[6].set_ylabel(\"Discharge (cfs)\")\naxes[6].legend(loc=\"upper left\", frameon=False)\n\n# 8) Peace + Caloosa Total Nitrogen (mg/L)\naxes[7].plot(df_plot[\"time\"], df_plot[\"peace_TN\"], linewidth=1.0, label=\"Peace River TN\")\naxes[7].plot(df_plot[\"time\"], df_plot[\"caloosa_total_nitrogen\"], linewidth=1.0, label=\"Caloosahatchee TN\")\naxes[7].set_title(\"Total Nitrogen\")\naxes[7].set_ylabel(\"TN (mg/L)\")\naxes[7].legend(loc=\"upper left\", frameon=False)\n\n# 9) Peace + Caloosa Total Phosphorus (mg/L)\naxes[8].plot(df_plot[\"time\"], df_plot[\"peace_TP\"], linewidth=1.0, label=\"Peace River TP\")\naxes[8].plot(df_plot[\"time\"], df_plot[\"caloosa_total_phosphorus\"], linewidth=1.0, label=\"Caloosahatchee TP\")\naxes[8].set_title(\"Total Phosphorus\")\naxes[8].set_ylabel(\"TP (mg/L)\")\naxes[8].legend(loc=\"upper left\", frameon=False)\n\n# -----------------------------\n# X-axis formatting\n# -----------------------------\naxes[8].set_xlabel(\"Time\")\naxes[8].xaxis.set_major_locator(mdates.YearLocator(base=2))\naxes[8].xaxis.set_major_formatter(mdates.DateFormatter(\"%Y\"))\n\nfor ax in axes:\n    ax.grid(True, linewidth=0.5)\n\n# -----------------------------\n# Save figure\n# -----------------------------\nfig.suptitle(\"Combined Environmental Drivers\", y=1.01, fontsize=14)\nplt.savefig(out_path, dpi=300, bbox_inches=\"tight\")\nplt.show()\n\nprint(f\"Saved figure to: {out_path}\")","key":"s850kZIQ88"},{"type":"outputs","id":"5FNQw3WR6w5d4gkXJjaik","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e538796ac0462dcad1212d024fc2b46d","path":"/red-tide-book//build/e538796ac0462dcad1212d024fc2b46d.png"},"text/plain":{"content":"\u003cFigure size 1400x2200 with 9 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"lQ4swdMPkk"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Saved figure to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Parameters\\stacked_parameters_9panel.png\n"},"children":[],"key":"gHeboNgnhZ"}],"key":"z479b4P0az"}],"key":"yqPBs4OAhA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df_swfl_tampa[['time', 'caloosa_total_nitrogen']] \\\n    .sort_values('caloosa_total_nitrogen', ascending=False) \\\n    .head(5)","key":"V8uuAONU9G"},{"type":"outputs","id":"hnGDlPRRReJqV__xM3bC4","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\n\u003cstyle scoped\u003e\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n\u003c/style\u003e\n\u003ctable border=\"1\" class=\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style=\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003etime\u003c/th\u003e\n      \u003cth\u003ecaloosa_total_nitrogen\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e351\u003c/th\u003e\n      \u003ctd\u003e1999-09-27\u003c/td\u003e\n      \u003ctd\u003e85.896245\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e350\u003c/th\u003e\n      \u003ctd\u003e1999-09-20\u003c/td\u003e\n      \u003ctd\u003e83.198769\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e349\u003c/th\u003e\n      \u003ctd\u003e1999-09-13\u003c/td\u003e\n      \u003ctd\u003e73.401286\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e348\u003c/th\u003e\n      \u003ctd\u003e1999-09-06\u003c/td\u003e\n      \u003ctd\u003e63.663516\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e352\u003c/th\u003e\n      \u003ctd\u003e1999-10-04\u003c/td\u003e\n      \u003ctd\u003e62.848939\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"          time  caloosa_total_nitrogen\n351 1999-09-27               85.896245\n350 1999-09-20               83.198769\n349 1999-09-13               73.401286\n348 1999-09-06               63.663516\n352 1999-10-04               62.848939","content_type":"text/plain"}}},"children":[],"key":"DWTyQEdl7q"}],"key":"tNFqbHFvQE"}],"key":"ZJD4vLhL52"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"9. Plot Study Area","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PWVJH0HTer"}],"identifier":"id-9-plot-study-area","label":"9. Plot Study Area","html_id":"id-9-plot-study-area","implicit":true,"key":"caJx4Vd7bV"}],"key":"Se2K8iRFix"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\n\n# --------------------------------------------------\n# Load HABsOS bloom observation dataset\n# --------------------------------------------------\ndf_hab = pd.read_csv(\n    \"habsos_20240430.csv\",\n    parse_dates=[\"SAMPLE_DATE\"]\n)\n\nprint(\"Initial HABsOS shape:\", df_hab.shape)\n\n# --------------------------------------------------\n# Filter to Karenia brevis only\n# --------------------------------------------------\ndf_hab = df_hab[\n    (df_hab['GENUS'] == 'Karenia') \u0026\n    (df_hab['SPECIES'] == 'brevis')\n]\n\nprint(\"After filtering to Karenia brevis:\", df_hab.shape)\n\n# --------------------------------------------------\n# Filter to SWFL + Tampa Bay spatial domain\n# --------------------------------------------------\ndf_hab_swfl = df_hab[\n    (df_hab['LATITUDE'].between(24.5, 28.5)) \u0026    # SWFL → Tampa Bay\n    (df_hab['LONGITUDE'].between(-84.5, -80.0)) \u0026\n    (df_hab['SAMPLE_DATE'] \u003e= '1992-01-01')\n]\n\nprint(\"After spatial/temporal filtering:\", df_hab_swfl.shape)\n\n# --------------------------------------------------\n# Create bloom intensity subsets for plotting\n# --------------------------------------------------\nhigh = df_hab_swfl[df_hab_swfl['CELLCOUNT'] \u003e= 1e6]\n\nmedium = df_hab_swfl[\n    (df_hab_swfl['CELLCOUNT'] \u003e= 1e5) \u0026\n    (df_hab_swfl['CELLCOUNT'] \u003c 1e6)\n]\n\nlow = df_hab_swfl[\n    (df_hab_swfl['CELLCOUNT'] \u003e= 1e4) \u0026\n    (df_hab_swfl['CELLCOUNT'] \u003c 1e5)\n]\n\n# --------------------------------------------------\n# Sanity checks\n# --------------------------------------------------\nprint(\"\\nBloom category counts:\")\nprint(f\"  High (≥1e6): {len(high)}\")\nprint(f\"  Medium (1e5–1e6): {len(medium)}\")\nprint(f\"  Low (1e4–1e5): {len(low)}\")\n\nprint(\"\\nCELLCOUNT summary:\")\nprint(df_hab_swfl['CELLCOUNT'].describe())","key":"iXiGzGCChp"},{"type":"outputs","id":"bJjZy-P9bEeA984OP_8hU","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\AppData\\Local\\Temp\\ipykernel_112204\\1022535847.py:6: DtypeWarning: Columns (21,24) have mixed types. Specify dtype option on import or set low_memory=False.\n  df_hab = pd.read_csv(\n"},"children":[],"key":"Z883oYkES0"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Initial HABsOS shape: (211834, 28)\nAfter filtering to Karenia brevis: (211834, 28)\nAfter spatial/temporal filtering: (143120, 28)\n\nBloom category counts:\n  High (≥1e6): 2665\n  Medium (1e5–1e6): 7882\n  Low (1e4–1e5): 8879\n\nCELLCOUNT summary:\ncount    1.431200e+05\nmean     1.359387e+05\nstd      2.403858e+06\nmin      0.000000e+00\n25%      0.000000e+00\n50%      0.000000e+00\n75%      0.000000e+00\nmax      3.884000e+08\nName: CELLCOUNT, dtype: float64\n"},"children":[],"key":"w31IGoB4rN"}],"key":"dFzJGIDOi7"}],"key":"AxclXdZ6J3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Recreate KB (Karenia brevis) cellcount map up to Tampa Bay (Cartopy)\n# Assumes you already have df_hab loaded (HABsOS) with at least:\n# ['LATITUDE','LONGITUDE','SAMPLE_DATE','CELLCOUNT','GENUS','SPECIES'].\n# If df_hab is not in memory yet, load it first like we did earlier.\n\nimport os\nfrom pathlib import Path\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nfrom matplotlib.patches import Rectangle\n\n# -----------------------\n# 0) Output folder\n# -----------------------\noutput_dir = Path(r\"C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Tampa_Data_Graphics\")\noutput_dir.mkdir(parents=True, exist_ok=True)\n\n# -----------------------\n# 1) Map extent + focus box (SWFL-\u003eTampa)\n# -----------------------\n# Big Gulf view (similar feel to advisor figure)\nextent = [-98, -79, 22, 30]  # [Lon_W, Lon_E, Lat_S, Lat_N]\n\n# Focus box you can tweak (covers Naples -\u003e Tampa Bay)\nbox_lon_w, box_lon_e = -83.6, -81.1\nbox_lat_s, box_lat_n = 25.3, 28.4\n\n# -----------------------\n# 2) Filter HABsOS to K. brevis + time + focus region (for plotting points)\n# -----------------------\ndf_plot = df_hab.copy()\n\n# Ensure datetime\ndf_plot[\"SAMPLE_DATE\"] = pd.to_datetime(df_plot[\"SAMPLE_DATE\"], errors=\"coerce\")\n\n# Keep Karenia brevis only (robust to case/spacing)\ndf_plot = df_plot[\n    df_plot[\"GENUS\"].astype(str).str.strip().str.lower().eq(\"karenia\") \u0026\n    df_plot[\"SPECIES\"].astype(str).str.strip().str.lower().eq(\"brevis\")\n].copy()\n\n# Time filter (matches your earlier workflow)\ndf_plot = df_plot[df_plot[\"SAMPLE_DATE\"] \u003e= pd.to_datetime(\"1992-01-01\")].copy()\n\n# Keep only points inside the focus box (so we don’t paint the whole Gulf with dots)\ndf_plot = df_plot[\n    (df_plot[\"LONGITUDE\"].between(box_lon_w, box_lon_e)) \u0026\n    (df_plot[\"LATITUDE\"].between(box_lat_s, box_lat_n))\n].copy()\n\n# Make sure CELLCOUNT is numeric\ndf_plot[\"CELLCOUNT\"] = pd.to_numeric(df_plot[\"CELLCOUNT\"], errors=\"coerce\").fillna(0)\n\n# Categories\nhigh = df_plot[df_plot[\"CELLCOUNT\"] \u003e= 1e6]\nmedium = df_plot[(df_plot[\"CELLCOUNT\"] \u003e= 1e5) \u0026 (df_plot[\"CELLCOUNT\"] \u003c 1e6)]\nlow = df_plot[(df_plot[\"CELLCOUNT\"] \u003e= 1e4) \u0026 (df_plot[\"CELLCOUNT\"] \u003c 1e5)]\n\n# -----------------------\n# 3) Build map\n# -----------------------\nproj = ccrs.PlateCarree()\nfig = plt.figure(figsize=(11, 8.5))\nax = plt.subplot(1, 1, 1, projection=proj)\nax.set_extent(extent, crs=proj)\n\n# Background / features\nax.set_facecolor(cfeature.COLORS[\"water\"])\nax.add_feature(cfeature.LAKES.with_scale(\"10m\"), color=\"aqua\", zorder=2)\nax.add_feature(cfeature.COASTLINE.with_scale(\"10m\"), color=\"gray\", zorder=3)\nax.add_feature(cfeature.BORDERS, edgecolor=\"red\", facecolor=\"none\", linewidth=1.5, zorder=3)\nax.stock_img()\n\nax.add_feature(\n    cfeature.NaturalEarthFeature(\n        \"physical\", \"rivers_lake_centerlines\", scale=\"10m\", edgecolor=\"blue\", facecolor=\"none\"\n    ),\n    zorder=3,\n)\nax.add_feature(\n    cfeature.NaturalEarthFeature(\n        \"physical\", \"rivers_north_america\", scale=\"10m\", edgecolor=\"blue\", facecolor=\"none\", alpha=0.4\n    ),\n    zorder=3,\n)\n\n# Gridlines\ngl = ax.gridlines(\n    draw_labels=True,\n    xlocs=np.arange(extent[0], extent[1] + 1, 5),\n    ylocs=np.arange(extent[2], extent[3] + 1, 5),\n    linewidth=1,\n    color=\"gray\",\n    alpha=0.5,\n    linestyle=\"--\",\n    zorder=10,\n)\ngl.right_labels = False\ngl.top_labels = False\ngl.xlabel_style = {\"size\": 10}\ngl.ylabel_style = {\"size\": 10}\n\n# Bathymetry “bands” (Natural Earth)\nbathymetry_names = [\n    \"bathymetry_L_0\",\n    \"bathymetry_K_200\",\n    \"bathymetry_J_1000\",\n    \"bathymetry_I_2000\",\n    \"bathymetry_H_3000\",\n    \"bathymetry_G_4000\",\n]\n# Very light -\u003e darker blue\nbath_colors = [\n    (0.90, 0.95, 1.00),\n    (0.75, 0.88, 1.00),\n    (0.60, 0.80, 1.00),\n    (0.45, 0.72, 1.00),\n    (0.25, 0.62, 1.00),\n    (0.05, 0.52, 1.00),\n]\nfor name, col in zip(bathymetry_names, bath_colors):\n    ax.add_feature(\n        cfeature.NaturalEarthFeature(\n            category=\"physical\",\n            name=name,\n            scale=\"10m\",\n            edgecolor=\"none\",\n            facecolor=col,\n        ),\n        zorder=1,\n    )\n\n# Focus box rectangle\nrect = Rectangle(\n    (box_lon_w, box_lat_s),\n    box_lon_e - box_lon_w,\n    box_lat_n - box_lat_s,\n    fill=False,\n    linewidth=1.5,\n    edgecolor=\"black\",\n    transform=proj,\n    zorder=20,\n)\nax.add_patch(rect)\n\n# Cities + buoy\nlocations = {\n    \"Tampa\": (27.9506, -82.4572),\n    \"Naples\": (26.1420, -81.7948),\n}\nfor name, (lat, lon) in locations.items():\n    ax.plot(lon, lat, marker=\"o\", color=\"black\", markersize=3, transform=proj, zorder=30)\n    ax.text(lon + 0.15, lat + 0.10, name, transform=proj, fontsize=9, color=\"black\", zorder=30)\n\nbuoys = {\"Buoy 42003\": (25.9253, -85.6161)}\nfor name, (lat, lon) in buoys.items():\n    ax.plot(lon, lat, marker=\"o\", color=\"black\", markersize=3, transform=proj, zorder=30)\n    ax.text(lon - 2.0, lat + 0.10, name, transform=proj, fontsize=9, color=\"black\", zorder=30)\n\n# -----------------------\n# 4) Plot KB points (cellcount bins)\n# -----------------------\nsc_high = ax.scatter(\n    high[\"LONGITUDE\"], high[\"LATITUDE\"],\n    s=10, color=\"red\", edgecolor=\"none\",\n    transform=proj, zorder=40\n)\nsc_med = ax.scatter(\n    medium[\"LONGITUDE\"], medium[\"LATITUDE\"],\n    s=10, color=\"orange\", edgecolor=\"none\",\n    transform=proj, zorder=39\n)\nsc_low = ax.scatter(\n    low[\"LONGITUDE\"], low[\"LATITUDE\"],\n    s=10, color=\"yellow\", edgecolor=\"none\",\n    transform=proj, zorder=38\n)\n\nlegend = ax.legend(\n    handles=[sc_high, sc_med, sc_low],\n    labels=[\"Cellcount ≥ 1e6\", \"1e5 ≤ Cellcount \u003c 1e6\", \"1e4 ≤ Cellcount \u003c 1e5\"],\n    loc=\"upper left\",\n    fontsize=9,\n    frameon=True,\n)\nlegend.set_zorder(50)\n\n# -----------------------\n# 5) Save + show\n# -----------------------\nfname = f\"KB_cellcount_SWFL_Tampa_{pd.Timestamp.now():%Y-%m-%d_%H-%M-%S}.png\"\noutpath = output_dir / fname\nplt.savefig(outpath, dpi=300, bbox_inches=\"tight\")\nprint(f\"Figure saved to: {outpath}\")\n\nplt.show()","key":"Xf20d7sDZM"},{"type":"outputs","id":"MdexFj86yqjmpVKu95fMd","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"C:\\Users\\mkduu\\miniconda3\\Lib\\site-packages\\cartopy\\mpl\\feature_artist.py:144: UserWarning: facecolor will have no effect as it has been defined as \"never\".\n  warnings.warn('facecolor will have no effect as it has been '\n"},"children":[],"key":"Wc7Kr5fe8h"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Figure saved to: C:\\Users\\mkduu\\OneDrive\\Documents\\FGCU docs\\Summer 25 Red Tide Project\\Graphics\\Tampa_Data_Graphics\\KB_cellcount_SWFL_Tampa_2025-12-29_15-58-53.png\n"},"children":[],"key":"DXELtFwhSI"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d58140171c0b2c16f04b898b36a2c84f","path":"/red-tide-book//build/d58140171c0b2c16f04b898b36a2c84f.png"},"text/plain":{"content":"\u003cFigure size 1100x850 with 1 Axes\u003e","content_type":"text/plain"}}},"children":[],"key":"YJrODiani1"}],"key":"y8B1HSgmrs"}],"key":"gUIOnQ3aws"}],"key":"ze6Wu5d0fq"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Red Tide Data and Modeling Book","url":"/","group":"Red Tide Data and Modeling Book"},"next":{"title":"Watershed Study Area","url":"/watershed-graphics","group":"Red Tide Data and Modeling Book"}}},"domain":"http://localhost:3000"},"project":{"title":"Red Tide Data and Modeling Book","authors":[{"id":"Matthew Duus","name":"Matthew Duus"}],"toc":[{"file":"intro.md"},{"file":"Data_SWFL_Combined.ipynb"},{"file":"Watershed_Graphics.ipynb"},{"file":"ML_Model_SWFL_With_Tampa.ipynb"}],"exports":[],"bibliography":[],"index":"index","pages":[{"slug":"data-swfl-combined","title":"Data Integration for Southwest Florida","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"watershed-graphics","title":"Watershed Study Area","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"ml-model-swfl-with-tampa","title":"Machine Learning Model for Combined Peace River and Caloosahatchee River","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/red-tide-book//build/manifest-86A905A4.js";
import * as route0 from "/red-tide-book//build/root-CXYA7X5D.js";
import * as route1 from "/red-tide-book//build/routes/$-JRBPULBO.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/red-tide-book//build/entry.client-PCJPW7TK.js");</script></body></html>